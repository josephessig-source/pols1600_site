<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-234273d1456647dabc34a594ac50e507.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.32">

  <title>POLS 1600</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #24292e;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #24292e; } /* Normal */
    code span.al { color: #ff5555; font-weight: bold; } /* Alert */
    code span.an { color: #6a737d; } /* Annotation */
    code span.at { color: #d73a49; } /* Attribute */
    code span.bn { color: #005cc5; } /* BaseN */
    code span.bu { color: #d73a49; } /* BuiltIn */
    code span.cf { color: #d73a49; } /* ControlFlow */
    code span.ch { color: #032f62; } /* Char */
    code span.cn { color: #005cc5; } /* Constant */
    code span.co { color: #6a737d; } /* Comment */
    code span.cv { color: #6a737d; } /* CommentVar */
    code span.do { color: #6a737d; } /* Documentation */
    code span.dt { color: #d73a49; } /* DataType */
    code span.dv { color: #005cc5; } /* DecVal */
    code span.er { color: #ff5555; text-decoration: underline; } /* Error */
    code span.ex { color: #d73a49; font-weight: bold; } /* Extension */
    code span.fl { color: #005cc5; } /* Float */
    code span.fu { color: #6f42c1; } /* Function */
    code span.im { color: #032f62; } /* Import */
    code span.in { color: #6a737d; } /* Information */
    code span.kw { color: #d73a49; } /* Keyword */
    code span.op { color: #24292e; } /* Operator */
    code span.ot { color: #6f42c1; } /* Other */
    code span.pp { color: #d73a49; } /* Preprocessor */
    code span.re { color: #6a737d; } /* RegionMarker */
    code span.sc { color: #005cc5; } /* SpecialChar */
    code span.ss { color: #032f62; } /* SpecialString */
    code span.st { color: #032f62; } /* String */
    code span.va { color: #e36209; } /* Variable */
    code span.vs { color: #032f62; } /* VerbatimString */
    code span.wa { color: #ff5555; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto-8979bb8451ddc1038f930ac611262c50.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <link href="../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

  <script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

  <link href="../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">

  <script src="../site_libs/datatables-binding-0.33/datatables.js"></script>

  <script src="../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

  <link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">

  <link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">

  <script src="../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>

  <link href="../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

  <script src="../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

  <script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>

  <link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" align="left" data-background-image="images/pols1600_hex.png" data-background-position="90% 50%" data-background-size="40%" class="quarto-title-block center">
  <h1 class="title">POLS 1600</h1>
  <p class="subtitle">Casual Inference in<br>Observational Designs &amp; <br> Simple Linear Regression</p>

<div class="quarto-title-authors">
</div>

  <p class="date">Updated Nov 6, 2025</p>
</section>
<section>
<section id="overview" class="title-slide slide level1 inverse center">
<h1><i class="fa-solid fa-map-location" aria-label="map-location"></i> Overview</h1>

</section>
<section id="overview-1" class="slide level2">
<h2>Overview</h2>
<ul>
<li class="fragment">Announcements</li>
<li class="fragment">Setup</li>
<li class="fragment">Feedback</li>
<li class="fragment">Review</li>
<li class="fragment">Class plan</li>
</ul>
</section>
<section id="learing-goals" class="slide level2 smaller">
<h2>Learing goals</h2>
<ul>
<li class="fragment"><p>Review the concept of <span class="blue">Directed Acyclic Graphs</span> to describe causal relationships and illustrate potential bias from <span class="blue">confounders</span> and <span class="blue">colliders</span></p></li>
<li class="fragment"><p>Discuss three approaches to <span class="blue">covariate adjustment</span></p>
<ul>
<li class="fragment">Subclassification</li>
<li class="fragment">Matching</li>
<li class="fragment"><span class="blue">Linear Regression</span></li>
</ul></li>
<li class="fragment"><p>Begin discussing three research designs to make causal claims with observational data</p>
<ul>
<li class="fragment"><span class="blue">Differences-in-Differences</span></li>
<li class="fragment">Regression Discontinuity Designs</li>
<li class="fragment">Instrumental Variables</li>
</ul></li>
</ul>
</section>
<section id="annoucements" class="slide level2">
<h2>Annoucements</h2>
<ul>
<li class="fragment"><p>Correct link to the lab this week <a href="https://pols1600.paultesta.org/labs/05-lab.qmd" target="_blank">here</a></p></li>
<li class="fragment"><p><a href="https://pols1600.paultesta.org/assignments/a1" target="_blank">Assignment 1</a> do this Sunday</p></li>
</ul>
</section>
<section id="assignment-1" class="slide level2 smaller">
<h2>Assignment 1</h2>
<p>Come up with three research questions topics that interest your group. For each:</p>
<ul>
<li class="fragment">Why do we care:
<ul>
<li class="fragment">How would you explain this question to your parents?</li>
</ul></li>
<li class="fragment">The ideal <span class="blue">experiment</span>:
<ul>
<li class="fragment">What would you have to be able to randomly assign?</li>
</ul></li>
<li class="fragment">The <span class="blue">observational</span> study:
<ul>
<li class="fragment">What kinds of data would you need? How would you measure outcome(s) and key predictors?</li>
</ul></li>
<li class="fragment">A <span class="blue">published</span> study:
<ul>
<li class="fragment">How have others studied this question?</li>
</ul></li>
<li class="fragment">Feasibility: (X/10)
<ul>
<li class="fragment">Are data available?</li>
</ul></li>
</ul>
</section>
<section id="group-assignments" class="slide level2 smaller">
<h2>Group Assignments</h2>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-c61c39d3cbd1350d81cb" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c61c39d3cbd1350d81cb">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7"],["Group 1","Group 2","Group 3","Group 4","Group 5","Group 6","Group 7"],["Gurpartap Singh","Sylvie Watts","Joshua Okwaning","Jacqueline Zhang","Talib Reddick","Tess\tNaquet-Radiguet","Ben Buka"],["Niyah Whitten","Amani Diallo","Eiffel Sunga","Charlie Jeffers","Zoe Kaufman","Anisha Kumar","Ianthe Ince"],["Marisa Coghlin","Sinclair Harris","Jenna Hercher","Meleah Neely","Jenna Lowry","Nash Riebe","Riya Srinivasan"],["Aidan Choi","Peter Zucker","Ella Hendelman","Nene Mokonchu","Harry Laferriere","Sophia Wotman","Kaelah Kimura"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Group<\/th>\n      <th>1<\/th>\n      <th>2<\/th>\n      <th>3<\/th>\n      <th>4<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Group","targets":1},{"name":"1","targets":2},{"name":"2","targets":3},{"name":"3","targets":4},{"name":"4","targets":5}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section></section>
<section>
<section id="feedback" class="title-slide slide level1 center" data-top="50%" data-background-image="https://jplilley.com/images/easyblog_articles/145/holding-ears-300x196.jpg">
<h1><i class="fa-solid fa-bullhorn" aria-label="bullhorn"></i> Feedback</h1>

</section>
<section id="what-did-we-like" class="slide level2 smaller">
<h2>What did we like</h2>
<div class="cell">
<div class="cell-output-display">
<div id="htmlwidget-5665b05199357f3e00d6" style="width:100%;height:90%;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-5665b05199357f3e00d6">{"x":{"filter":"none","vertical":false,"fillContainer":false,"data":[["1","2","3","4","5","6","7","8","9","10"],["I learned a lot about Chinese poetry. That was interesting","I thought it was interesting to replicate a real survey.","I liked pasting/replacing parts of the code to produce different tables. It was useful in understanding what the functions do and how they can be used for different pieces of data.","I liked allowing us to take instructions and replace the code. It helped me understand what exactly we are doing.","I liked the directions for this lab and how we started to modify existing code in order to get the desired results.","It was fun to be able to truly code ourselves during this week's labs. At the same time, the fact that we did certain parts together made the lab itself less daunting. So it was a good mixture of being able to figure things out ourselves, while also talking about it as a group and knowing our results were correct.","i liked meeting my group members","I think I'm starting to get the hang of things. The lab was much easier to follow this week. I also really enjoyed the subject of the study and seeing how the data can reflect something like changing minds.","I enjoyed the lab","I liked that we did the labs in our own individual groups but still talked through it as a class"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Likes<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Likes","targets":1}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="what-did-we-dislike" class="slide level2 smaller">
<h2>What did we dislike</h2>
<div class="cell">
<div class="cell-output-display">
<div id="htmlwidget-ed370304da050d2605fb" style="width:100%;height:90%;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-ed370304da050d2605fb">{"x":{"filter":"none","vertical":false,"fillContainer":false,"data":[["1","2","3","4","5","6","7","8","9","10"],["R","I kept getting error when I copied the code verbatum and I couldn't move on which was really frustrating","For some questions it was unclear how to determine the answer using the code and the data produced from the code. Group work can also be frustrating if certain members aren't on the same page.","There were a few points during the lab when you moved a little fast and it became frustrating for me to catch up. I also still find knowing exactly what to do a little challenging. Eg. when you say to get an HLO, I am not sure which exact commands to go to.","There wasn't much communication between group members, but I think it's because we do not know each other","","i thought the lab moved at a pace that wasn't super helpful for my learning. i would rather do a bit less in the labs but have time to really explore it on my own -- i would even be okay with having to do some pre-lab work if it meant really immersing myself in the coding experience.","I was the only one in my group who seemed to have read the study, so it felt a little like I was carrying the group through a lot of it.","","I find it confusing sometimes to explain verbally what the code is doing"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Dislikes<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Dislikes","targets":1}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="grinding-an-iron-pestle-into-a-needle" class="slide level2 smaller" data-background-image="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w5OqZwz1hmoCY5v_31xQ9A@2x.jpeg" data-background-opacity=".5">
<h2>Grinding an Iron Pestle into a Needle</h2>
<div class="columns">
<div class="column fragment" style="width:45%;">
<h3 id="me">Me</h3>
<ul>
<li class="fragment">Less is more</li>
<li class="fragment">Go slow</li>
<li class="fragment">Provide labs/code earlier</li>
<li class="fragment">Adapt assignments/policies</li>
</ul>
</div><div class="column fragment" style="width:45%;">
<h3 id="you">You</h3>
<ul>
<li class="fragment">Active reading</li>
<li class="fragment">Do tutorials</li>
<li class="fragment">Review labs before class</li>
<li class="fragment">Review comments after class</li>
<li class="fragment">Ask for help</li>
<li class="fragment">Don’t give up!</li>
</ul>
</div></div>
</section></section>
<section>
<section id="review" class="title-slide slide level1 inverse center">
<h1><i class="fa-solid fa-magnifying-glass" aria-label="magnifying-glass"></i> Review</h1>

</section>
<section id="review-1" class="slide level2">
<h2>Review</h2>
<ul>
<li class="fragment"><p>Data wrangling</p></li>
<li class="fragment"><p>Descriptive Statistics</p></li>
<li class="fragment"><p>Levels of understanding</p></li>
<li class="fragment"><p>Data visualization</p></li>
</ul>
</section></section>
<section>
<section id="data-wrangling" class="title-slide slide level1 inverse center">
<h1><i class="fa-solid fa-magnifying-glass" aria-label="magnifying-glass"></i> Data Wrangling</h1>

</section>
<section id="data-wrangling-1" class="slide level2 smaller">
<h2>Data wrangling</h2>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top" data-quarto-postprocess="true">
<caption>You're learning how to map conceptual tasks to commands in R</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Skill</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Common Commands</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Setup R</td>
<td style="text-align: left;">library(), ipak()</td>
</tr>
<tr class="even">
<td style="text-align: left;">Load data</td>
<td style="text-align: left;">read_csv(), load()</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Get HLO of data</td>
<td style="text-align: left;">df$x, glimpse(), table(), summary()</td>
</tr>
<tr class="even">
<td style="text-align: left;">Transform data</td>
<td style="text-align: left;">&lt;-, mutate(), ifelse(), case_when()</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Reshape data</td>
<td style="text-align: left;">pivot_longer(), left_join()</td>
</tr>
<tr class="even">
<td style="text-align: left;">Summarize data numerically</td>
<td style="text-align: left;">mean(), median(), summarise(), group_by()</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Summarize data graphically</td>
<td style="text-align: left;">ggplot(), aes(), geom_</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="mapping-concepts-to-code" class="slide level2">
<h2>Mapping Concepts to Code</h2>
<ul>
<li class="fragment"><p>Takes time and practice</p></li>
<li class="fragment"><p>Don’t be afraid to <span class="blue">FAAFO</span></p></li>
<li class="fragment"><p>Don’t worry about memorizing everything.</p></li>
<li class="fragment"><p>Statistical programming is necessary to actually <span class="blue">do</span> empirical research</p></li>
<li class="fragment"><p><span class="blue">Learning to code</span> will help us <span class="blue">understand statistical concepts</span>.</p></li>
<li class="fragment"><p>Learning to <span class="blue">think programmatically</span> and algorithmically will help us <span class="blue">tackle complex problems</span></p></li>
</ul>
</section></section>
<section>
<section id="descriptive-statiscs" class="title-slide slide level1 inverse center">
<h1><i class="fa-solid fa-magnifying-glass" aria-label="magnifying-glass"></i> Descriptive Statiscs</h1>

</section>
<section id="descriptive-statistics" class="slide level2 smaller">
<h2>Descriptive statistics</h2>
<ul>
<li class="fragment"><p>Descriptive statistics help us describe what’s typical of our data</p></li>
<li class="fragment"><p><span class="blue">What’s a typical value in our data</span></p>
<ul>
<li class="fragment"><a href="https://pols1600.paultesta.org/labs/01-lab-comments.html#mean" target="_blank">Mean</a></li>
<li class="fragment"><a href="https://pols1600.paultesta.org/labs/01-lab-comments.html#median" target="_blank">Median</a></li>
<li class="fragment"><a href="https://pols1600.paultesta.org/labs/01-lab-comments.html#modes" target="_blank">Mode</a></li>
</ul></li>
<li class="fragment"><p><span class="blue">How much do our data vary?</span></p>
<ul>
<li class="fragment"><a href="https://pols1600.paultesta.org/labs/01-lab-comments.html#variance" target="_blank">Variance</a></li>
<li class="fragment"><a href="https://pols1600.paultesta.org/labs/01-lab-comments.html#standard-deviations" target="_blank">Standard deviation</a></li>
</ul></li>
<li class="fragment"><p>As one variable changes <span class="blue">how does another change</span>?</p>
<ul>
<li class="fragment"><a href="https://pols1600.paultesta.org/labs/01-lab-comments.html#covariance" target="_blank">Covariance</a></li>
<li class="fragment"><a href="https://pols1600.paultesta.org/labs/01-lab-comments.html#correlation" target="_blank">Correlation</a></li>
</ul></li>
<li class="fragment"><p>Descriptive statistics are:</p>
<ul>
<li class="fragment">Diagnostic</li>
<li class="fragment">Generative</li>
</ul></li>
</ul>
</section></section>
<section>
<section id="levels-of-understanding" class="title-slide slide level1 inverse center">
<h1><i class="fa-solid fa-magnifying-glass" aria-label="magnifying-glass"></i> Levels of understanding</h1>

</section>
<section id="levels-of-understanding-in-pols-1600" class="slide level2">
<h2>Levels of understanding in POLS 1600</h2>
<ul>
<li class="fragment"><p>Conceptual</p></li>
<li class="fragment"><p>Practical</p></li>
<li class="fragment"><p>Definitional</p></li>
<li class="fragment"><p>Theoretical</p></li>
</ul>
<div class="fragment">
<p>Let’s illustrate these different levels of understanding about our old friend the <span class="blue">mean</span></p>
</div>
</section>
<section id="mean-conceptual-understanding" class="slide level2 smaller">
<h2>Mean: Conceptual Understanding</h2>
<p>A mean is:</p>
<ul>
<li class="fragment"><p>A common and important <span class="blue">measure of central tendency</span> (what’s typical)</p></li>
<li class="fragment"><p>It’s the <span class="blue">arithmetic average</span> you learned in school</p></li>
<li class="fragment"><p>We can think of it as the <span class="blue">balancing point</span> of a distribution</p></li>
<li class="fragment"><p>A <span class="blue">conditional mean</span> is the average of one variable <span class="math inline">\(X\)</span>, when some other variable, <span class="math inline">\(Z\)</span> takes a value <span class="math inline">\(z\)</span></p>
<ul>
<li class="fragment">Think about the average height in our class (<span class="blue">unconditional mean</span>) vs the average height among men and women ([conditional means].{blue})</li>
</ul></li>
</ul>
</section>
<section id="mean-as-a-balancing-point" class="slide level2 smaller">
<h2>Mean as a balancing point</h2>

<img data-src="https://mathbitsnotebook.com/Algebra1/StatisticsData/balancepoint1.jpg" class="r-stretch"><p><a href="https://mathbitsnotebook.com/Algebra1/StatisticsData/STCenter.html" target="_blank">Source</a></p>
</section>
<section id="mean-practical" class="slide level2 smaller">
<h2>Mean: Practical</h2>
<p>There are lots of ways to calculate means in <code>R</code></p>
<ul>
<li class="fragment"><p>The simplest is to use the <code>mean()</code> function</p>
<ul>
<li class="fragment">If our data have missing values, we need to to tell <code>R</code> to remove them</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a><span class="fu">mean</span>(df<span class="sc">$</span>x, <span class="at">na.rm=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="conditional-means-practical" class="slide level2 smaller">
<h2>Conditional Means: Practical</h2>
<ul>
<li class="fragment">To calculate a conditional mean we could us a logical index <code>[df$z == 1]</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a></a><span class="fu">mean</span>(df<span class="sc">$</span>x[df<span class="sc">$</span>z <span class="sc">==</span> <span class="dv">1</span>], <span class="at">na.rm=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li class="fragment">If we wanted to a calculate a lot of conditional means we could use the <code>mean()</code> in combination with <code>group_by()</code> and <code>summarise()</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a></a>  <span class="fu">group_by</span>(z)<span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a></a>  <span class="fu">summarise</span>(</span>
<span id="cb3-4"><a></a>    <span class="at">x =</span> <span class="fu">mean</span>(x, <span class="at">na.rm=</span>T)</span>
<span id="cb3-5"><a></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mean-definitional" class="slide level2 smaller">
<h2>Mean: Definitional</h2>
<p>Formally, we define the arithmetic mean of <span class="math inline">\(x\)</span> as <span class="math inline">\(\bar{x}\)</span>:</p>
<p><span class="math display">\[
\bar{x} = \frac{1}{n}\left (\sum_{i=1}^n{x_i}\right ) = \frac{x_1+x_2+\cdots +x_n}{n}
\]</span></p>
<p>In words, this formula says, to calculate the average of x, we sum up all the values of <span class="math inline">\(x_i\)</span> from observation <span class="math inline">\(i=1\)</span> to <span class="math inline">\(i=n\)</span> and then divide by the total number of observations <span class="math inline">\(n\)</span></p>
</section>
<section id="mean-definitional-1" class="slide level2 smaller">
<h2>Mean: Definitional</h2>
<ul>
<li class="fragment"><p>In this class, I don’t put a lot of weight on memorizing definitions (that’s what Google’s for).</p></li>
<li class="fragment"><p>But being comfortable with “the math” is important and useful</p></li>
<li class="fragment"><p>Definitional knowledge is a prerequisite for understanding more theoretical claims.</p></li>
</ul>
</section>
<section id="mean-theoretical" class="slide level2 smaller">
<h2>Mean: Theoretical</h2>
<p>Suppose I asked you to show that the sum of deviations from a mean equals 0?</p>
<p><span class="math display">\[
\text{Claim:} \sum_{i=1}^n (x_i -\bar{x}) = 0
\]</span></p>
</section>
<section id="mean-theoretical-1" class="slide level2 smaller">
<h2>Mean: Theoretical</h2>
<p>Knowing the definition of an arithmetic mean, we could write:</p>
<p><span class="math display">\[
\begin{aligned}
\sum_{i=1}^n (x_i -\bar{x}) &amp;= \sum_{i=1}^n x_i - \sum_{i=1}^n\bar{x} &amp; \text{Distribute Summation}\\
              &amp;= \sum_{i=1}^n x_i - n\bar{x} &amp; \text{Summing a constant, } \bar{x}\\
              &amp;= \sum_{i=1}^n x_i - n\times \left ( \frac{1}{n} \sum_{i=1}^n{x_i}\right ) &amp; \text{Definition of } \bar{x}\\
              &amp;= \sum_{i=1}^n x_i - \sum_{i=1}^n{x_i} &amp; n \times \frac{1}{n}=1\\
              &amp;= 0             
\end{aligned}
\]</span></p>
</section>
<section id="mean-theoretical-2" class="slide level2 smaller">
<h2>Mean: Theoretical</h2>
<p>Why do we care?</p>
<ul>
<li class="fragment"><p>Showing the deviations sum to 0 is another way of saying the mean is a <span class="blue">balancing point</span>.</p></li>
<li class="fragment"><p>This turns out to be a useful property of means that will reappear throughout the course</p></li>
<li class="fragment"><p>If I asked you to make a prediction, <span class="math inline">\(\hat{x}\)</span> of a random person’s height in this class, the mean would have the lowest <span class="blue">mean squared error</span> (MSE <span class="math inline">\(=\frac{1}{n}\sum (x_i - \hat{x_i})^2)\)</span></p></li>
</ul>
</section>
<section id="mean-theoretical-3" class="slide level2">
<h2>Mean: Theoretical</h2>
<p>Occasionally, you’ll read or here me say say things like:</p>
<blockquote>
<p>The sample mean is an unbiased estimator of the population mean</p>
</blockquote>
<p>In a statistics class, we would take time to prove this.</p>
</section>
<section id="the-sample-mean-is-an-unbiased-estimator-of-the-population-mean" class="slide level2 smaller">
<h2>The sample mean is an unbiased estimator of the population mean</h2>
<p>Claim:</p>
<p>Let <span class="math inline">\(x_1, x_2, \dots x_n\)</span> from a random sample from a population with mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span></p>
<p>Then:</p>
<p><span class="math display">\[
\bar{x} = \frac{1}{n}\left (\sum_{i=1}^n x_i\right )
\]</span></p>
<p>is an unbiased estimator of <span class="math inline">\(\mu\)</span></p>
<p><span class="math display">\[
E[\bar{x}] = \mu
\]</span></p>
</section>
<section id="the-sample-mean-is-an-unbiased-estimator-of-the-population-mean-1" class="slide level2 smaller">
<h2>The sample mean is an unbiased estimator of the population mean</h2>
<p>Proof:</p>
<p><span class="math display">\[
\begin{aligned}
E\left [\bar{x} \right] &amp;= E\left [\frac{1}{n}\left (\sum_{i=1}^n x_i \right) \right] &amp; \text{Definition of } \bar{x} \\
&amp;= \frac{1}{n} \sum_{i=1}^nE\left [ x_i \right]  &amp; \text{Linearity of Expectations} \\
&amp;= \frac{1}{n} \sum_{i=1}^n \mu  &amp; E[x_i] = \mu \\
&amp;= \frac{n}{n}  \mu  &amp; \sum_{i=1}^n \mu = n\mu \\
&amp;= \mu  &amp; \blacksquare \\
\end{aligned}
\]</span></p>
</section>
<section id="levels-of-understanding-1" class="slide level2 smaller">
<h2>Levels of understanding</h2>
<p>In this course, we tend to emphasize the</p>
<ul>
<li><p><strong>Conceptual</strong></p></li>
<li><p><strong>Practical</strong></p></li>
</ul>
<p>Over</p>
<ul>
<li><p>Definitional</p></li>
<li><p>Theoretical</p></li>
</ul>
<p>In an intro statistics class, the ordering might be reversed.</p>
<p>Trade offs:</p>
<ul>
<li class="fragment">Pro: We actually get to <em>work with data</em> and <em>do empirical research</em> much sooner</li>
<li class="fragment">Cons: We substitute intuitive understandings for more rigorous proofs</li>
</ul>
</section></section>
<section>
<section id="data-visualization" class="title-slide slide level1 inverse center">
<h1><i class="fa-solid fa-magnifying-glass" aria-label="magnifying-glass"></i> Data Visualization</h1>

</section>
<section id="data-visualization-1" class="slide level2 smaller">
<h2>Data Visualization</h2>
<ul>
<li class="fragment"><p>The grammar of graphics</p></li>
<li class="fragment"><p>At minimum you need:</p>
<ul>
<li class="fragment"><code>data</code></li>
<li class="fragment"><code>aesthetic</code> mappings</li>
<li class="fragment"><code>geometries</code></li>
</ul></li>
<li class="fragment"><p>Take a sad plot and make it better by:</p>
<ul>
<li class="fragment"><code>labels</code></li>
<li class="fragment"><code>themes</code></li>
<li class="fragment"><code>statistics</code></li>
<li class="fragment"><code>cooridnates</code></li>
<li class="fragment"><code>facets</code></li>
<li class="fragment">transforming your data before plotting</li>
</ul></li>
</ul>
</section>
<section id="you-are-about-to-be-reincarnated-hlo" class="slide level2">
<h2>You are about to be reincarnated: HLO</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a></a>df<span class="sc">$</span>reincarnation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;labelled&lt;double&gt;[10]&gt;: You're about to be re-incarnated. Do you want to come back as a:
 [1] 1 1 1 7 6 1 6 6 7 1

Labels:
 value                  label
     1    Animal/land dweller
     6       Bird/air dweller
     7     Fish/water dweller
     2                 Insect
     9                  Plant
    10 Single-celled organism</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a></a><span class="fu">table</span>(df<span class="sc">$</span>reincarnation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
1 6 7 
5 3 2 </code></pre>
</div>
</div>
</section>
<section id="basic-plot" class="slide level2">
<h2>Basic Plot</h2>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1">Code</a></li><li><a href="#tabset-1-2">Figure</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a></a>df <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> reincarnation, </span>
<span id="cb8-3"><a></a>             <span class="at">fill =</span> reincarnation))<span class="sc">+</span></span>
<span id="cb8-4"><a></a>  <span class="fu">geom_bar</span>(</span>
<span id="cb8-5"><a></a>    <span class="at">stat =</span> <span class="st">"count"</span></span>
<span id="cb8-6"><a></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-2">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05-slides_files/figure-revealjs/plot0-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="use-a-factor-to-label-and-order-responses" class="slide level2">
<h2>Use a factor to label and order responses</h2>
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-2-1">Recode</a></li><li><a href="#tabset-2-2">Check recoding</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a></a>df <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-3"><a></a>    <span class="co"># Turn numeric values into factor labels </span></span>
<span id="cb9-4"><a></a>    <span class="at">Reincarnation =</span> forcats<span class="sc">::</span><span class="fu">as_factor</span>(reincarnation),</span>
<span id="cb9-5"><a></a>    <span class="co"># Order factor in decreasing frequency of levels</span></span>
<span id="cb9-6"><a></a>    <span class="at">Reincarnation =</span> forcats<span class="sc">::</span><span class="fu">fct_infreq</span>(Reincarnation),</span>
<span id="cb9-7"><a></a>    <span class="co"># Reverse order so levels are increasing in frequency</span></span>
<span id="cb9-8"><a></a>    <span class="at">Reincarnation =</span> forcats<span class="sc">::</span><span class="fu">fct_rev</span>(Reincarnation),</span>
<span id="cb9-9"><a></a>    <span class="co"># Rename explanations</span></span>
<span id="cb9-10"><a></a>    <span class="at">Why =</span> reincarnation_why</span>
<span id="cb9-11"><a></a>  ) <span class="ot">-&gt;</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a></a><span class="fu">table</span>(<span class="at">recode=</span> df<span class="sc">$</span>Reincarnation, <span class="at">original =</span> df<span class="sc">$</span>reincarnation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        original
recode                   1 6 7
  Single-celled organism 0 0 0
  Plant                  0 0 0
  Insect                 0 0 0
  Fish/water dweller     0 0 2
  Bird/air dweller       0 3 0
  Animal/land dweller    5 0 0</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="revised-figure" class="slide level2">
<h2>Revised figure</h2>
<div class="panel-tabset">
<ul id="tabset-3" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-3-1">Code</a></li><li><a href="#tabset-3-2">Revised Figure</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a></a>df <span class="sc">%&gt;%</span> <span class="co"># Data</span></span>
<span id="cb12-2"><a></a>  <span class="co"># Aesthetics</span></span>
<span id="cb12-3"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Reincarnation, </span>
<span id="cb12-4"><a></a>             <span class="at">fill =</span> Reincarnation))<span class="sc">+</span></span>
<span id="cb12-5"><a></a>  <span class="co"># Geometry</span></span>
<span id="cb12-6"><a></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"count"</span>)<span class="sc">+</span> <span class="co"># Statistic</span></span>
<span id="cb12-7"><a></a>  <span class="do">## Include levels of Reincarnation w/ no values</span></span>
<span id="cb12-8"><a></a>  <span class="fu">scale_x_discrete</span>(<span class="at">drop=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb12-9"><a></a>  <span class="co"># Don't include a legend</span></span>
<span id="cb12-10"><a></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">drop=</span><span class="cn">FALSE</span>, <span class="at">guide=</span><span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb12-11"><a></a>  <span class="co"># Flip x and y</span></span>
<span id="cb12-12"><a></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb12-13"><a></a>  <span class="co"># Remove lines</span></span>
<span id="cb12-14"><a></a>  <span class="fu">theme_classic</span>() <span class="ot">-&gt;</span> fig1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-2">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05-slides_files/figure-revealjs/unnamed-chunk-11-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="section" class="slide level2 smaller">
<h2></h2>
<h4 id="what-creature-and-why">What creature and why?</h4>
<div class="cell">
<div class="cell-output-display">
<div id="htmlwidget-ba533a515d9057e3a18e" style="width:100%;height:90%;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-ba533a515d9057e3a18e">{"x":{"filter":"none","vertical":false,"fillContainer":false,"data":[["1","2","3","4","5","6","7","8","9","10"],["Animal/land dweller","Animal/land dweller","Animal/land dweller","Fish/water dweller","Bird/air dweller","Animal/land dweller","Bird/air dweller","Bird/air dweller","Fish/water dweller","Animal/land dweller"],["A sheep because they represent the perfect lifeform","I want to be a giraffe.","Giraffe because they're chill and I've always wanted to be tall.","Manatee. They have no natural predators, are peaceful, intelligent, and live decently long lives.","parrot because I am more likely to be a pet while also be able to speak with humans","I would want to be a cheetah or a panther. A) I want to be incredibly, jaw droppingly fast. I want my nickname among all the cheetahs or panthers to be Speedy Gonzalez. B) I would rather be a hunter than the hunted.","maybe a pigeon cuz theyre silly","A butterfly so I can always migrate to warm places and FLYYY","Probably an Orca. They appear to have a social structure and I would love to swim around the ocean.","I'd like to be a giraffe or a koala. As a koala, I think I'd have fun eating leaves and swinging from trees plus, they sleep a lot which sounds so lovely right about now"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Reincarnation<\/th>\n      <th>Why<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Reincarnation","targets":1},{"name":"Why","targets":2}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="adding-labelled-values" class="slide level2">
<h2>Adding labelled values</h2>
<div class="panel-tabset">
<ul id="tabset-4" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-4-1">Recodes</a></li><li><a href="#tabset-4-2">Recode Output</a></li><li><a href="#tabset-4-3">Aggregate Data</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a></a>df <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-3"><a></a>    <span class="co"># Create numeric id</span></span>
<span id="cb13-4"><a></a>    <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),</span>
<span id="cb13-5"><a></a>    <span class="co"># Create a label with 3 answers and NA elsewhere</span></span>
<span id="cb13-6"><a></a>    <span class="at">Label =</span> <span class="fu">case_when</span>(</span>
<span id="cb13-7"><a></a>      id <span class="sc">==</span> <span class="dv">10</span> <span class="sc">~</span> <span class="fu">str_wrap</span>(reincarnation_why[<span class="dv">10</span>],<span class="dv">30</span>),</span>
<span id="cb13-8"><a></a>      id <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="fu">str_wrap</span>(reincarnation_why[<span class="dv">4</span>],<span class="dv">30</span>),</span>
<span id="cb13-9"><a></a>      id <span class="sc">==</span> <span class="dv">7</span> <span class="sc">~</span> <span class="fu">str_wrap</span>(reincarnation_why[<span class="dv">7</span>],<span class="dv">30</span>),</span>
<span id="cb13-10"><a></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb13-11"><a></a></span>
<span id="cb13-12"><a></a>    )</span>
<span id="cb13-13"><a></a></span>
<span id="cb13-14"><a></a>  ) <span class="ot">-&gt;</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-2">
<div class="cell">
<div class="cell-output-display">
<div id="htmlwidget-6085640a476ed012ae9e" style="width:100%;height:90%;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-6085640a476ed012ae9e">{"x":{"filter":"none","vertical":false,"fillContainer":false,"data":[["1","2","3","4","5","6","7","8","9","10"],[null,null,null,"Manatee. They have no natural\npredators, are peaceful,\nintelligent, and live decently\nlong lives.",null,null,"maybe a pigeon cuz theyre\nsilly",null,null,"I'd like to be a giraffe or\na koala. As a koala, I think\nI'd have fun eating leaves and\nswinging from trees plus, they\nsleep a lot which sounds so\nlovely right about now"],["A sheep because they represent the perfect lifeform","I want to be a giraffe.","Giraffe because they're chill and I've always wanted to be tall.","Manatee. They have no natural predators, are peaceful, intelligent, and live decently long lives.","parrot because I am more likely to be a pet while also be able to speak with humans","I would want to be a cheetah or a panther. A) I want to be incredibly, jaw droppingly fast. I want my nickname among all the cheetahs or panthers to be Speedy Gonzalez. B) I would rather be a hunter than the hunted.","maybe a pigeon cuz theyre silly","A butterfly so I can always migrate to warm places and FLYYY","Probably an Orca. They appear to have a social structure and I would love to swim around the ocean.","I'd like to be a giraffe or a koala. As a koala, I think I'd have fun eating leaves and swinging from trees plus, they sleep a lot which sounds so lovely right about now"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Label<\/th>\n      <th>Why<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Label","targets":1},{"name":"Why","targets":2}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-4-3">
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a></a><span class="co"># Calculate totals before calling ggplot</span></span>
<span id="cb14-2"><a></a>plot_df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a></a>  <span class="fu">group_by</span>(Reincarnation)<span class="sc">%&gt;%</span> </span>
<span id="cb14-4"><a></a>  <span class="fu">summarise</span>( </span>
<span id="cb14-5"><a></a>    <span class="at">Count =</span> <span class="fu">n</span>(), </span>
<span id="cb14-6"><a></a>    <span class="at">Why =</span> <span class="fu">na.omit</span>(<span class="fu">unique</span>(Label)) </span>
<span id="cb14-7"><a></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="youre-about-to-be-reincarnated" class="slide level2 smaller">
<h2>You’re about to be reincarnated:</h2>
<div class="panel-tabset">
<ul id="tabset-5" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-5-1">Aggregate df</a></li><li><a href="#tabset-5-2">Revised Figure Code</a></li><li><a href="#tabset-5-3">Labelled Figure</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1">
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-e42ce0ada11d52b1806b" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e42ce0ada11d52b1806b">{"x":{"filter":"none","vertical":false,"data":[["1","2","3"],["Fish/water dweller","Bird/air dweller","Animal/land dweller"],[2,3,5],["Manatee. They have no natural\npredators, are peaceful,\nintelligent, and live decently\nlong lives.","maybe a pigeon cuz theyre\nsilly","I'd like to be a giraffe or\na koala. As a koala, I think\nI'd have fun eating leaves and\nswinging from trees plus, they\nsleep a lot which sounds so\nlovely right about now"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Reincarnation<\/th>\n      <th>Count<\/th>\n      <th>Why<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Reincarnation","targets":1},{"name":"Count","targets":2},{"name":"Why","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-5-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a></a>plot_df <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Reincarnation, </span>
<span id="cb15-3"><a></a>             <span class="at">y =</span> Count,</span>
<span id="cb15-4"><a></a>             <span class="at">fill =</span> Reincarnation, </span>
<span id="cb15-5"><a></a>             <span class="at">label=</span>Why))<span class="sc">+</span></span>
<span id="cb15-6"><a></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>)<span class="sc">+</span> <span class="co">#&lt;&lt;</span></span>
<span id="cb15-7"><a></a>  <span class="do">## Include levels of Reincarnation w/ no values</span></span>
<span id="cb15-8"><a></a>  <span class="fu">scale_x_discrete</span>(<span class="at">drop=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb15-9"><a></a>  <span class="co"># Don't include a legend</span></span>
<span id="cb15-10"><a></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">drop=</span><span class="cn">FALSE</span>, <span class="at">guide=</span><span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb15-11"><a></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb15-12"><a></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>,<span class="at">y=</span><span class="st">""</span>,<span class="at">title=</span><span class="st">"You're about to be reincarnated.</span><span class="sc">\n</span><span class="st">What do you want to come back as?"</span>)<span class="sc">+</span></span>
<span id="cb15-13"><a></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb15-14"><a></a>  ggrepel<span class="sc">::</span><span class="fu">geom_label_repel</span>(</span>
<span id="cb15-15"><a></a>    <span class="at">fill=</span><span class="st">"white"</span>,</span>
<span id="cb15-16"><a></a>    <span class="at">nudge_y =</span> <span class="dv">1</span>, </span>
<span id="cb15-17"><a></a>    <span class="at">hjust =</span> <span class="st">"left"</span>,</span>
<span id="cb15-18"><a></a>    <span class="at">size=</span><span class="dv">3</span>,</span>
<span id="cb15-19"><a></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.015</span>, <span class="st">"npc"</span>))</span>
<span id="cb15-20"><a></a>    )<span class="sc">+</span> </span>
<span id="cb15-21"><a></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb15-22"><a></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">12</span>),</span>
<span id="cb15-23"><a></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">6</span>))</span>
<span id="cb15-24"><a></a>    ) <span class="ot">-&gt;</span> fig1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-3">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05-slides_files/figure-revealjs/fig1labelled-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="data-visualization-is-an-iterative-process" class="slide level2">
<h2>Data visualization is an iterative process</h2>
<ul>
<li class="fragment"><p>Data visualization is an iterative process</p></li>
<li class="fragment"><p>Good data viz requires lots of data transformations</p></li>
<li class="fragment"><p>Start with a minimum working example and build from there</p></li>
<li class="fragment"><p>Don’t let the perfect be the enemy of the good enough.</p></li>
</ul>
</section></section>
<section>
<section id="setup" class="title-slide slide level1 center">
<h1><i class="fa-solid fa-code" aria-label="code"></i> Setup</h1>

</section>
<section id="new-packages" class="slide level2">
<h2>New packages</h2>
<p>This week’s lab we’ll be using the <code>dataverse</code> package to download data on presidential elections</p>
<p>Next week’s lab, we’ll be using the <code>tidycensus</code> package to download census data.</p>
<p>We’ll also need to <span class="blue">install a census API</span> to get the data.</p>
<p>Here’s a <a href="https://pols1600.paultesta.org/resources/04-packages" target="_blank">detailed guide</a> of what we’ll do in class right now.</p>
</section>
<section id="install-new-packages" class="slide level2">
<h2>Install new packages</h2>
<p>These packages are easier to install live:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a></a><span class="fu">install.packages</span>(<span class="st">"dataverse"</span>)</span>
<span id="cb16-2"><a></a><span class="fu">install.packages</span>(<span class="st">"tidycensus"</span>)</span>
<span id="cb16-3"><a></a><span class="fu">install.packages</span>(<span class="st">"easystats"</span>)</span>
<span id="cb16-4"><a></a><span class="fu">install.packages</span>(<span class="st">"DeclareDesign"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="census-api" class="slide level2 smaller scrollable">
<h2>Census API</h2>
<p>Please follow these steps so you can download data directly from the U.S. Census <a href="https://pols1600.paultesta.org/resources/04-packages.html#3_Install_a_Census_API_tidycensus_package" target="_blank">here</a>:</p>
<ol type="1">
<li class="fragment">Install the <code>tidycensus</code> package</li>
<li class="fragment">Load the installed package</li>
<li class="fragment">Request an API key from the Census</li>
<li class="fragment">Check your email</li>
<li class="fragment">Activate your key</li>
<li class="fragment">Install your API key in R</li>
<li class="fragment">Check that everything worked</li>
</ol>
</section>
<section id="packages-for-today" class="slide level2">
<h2>Packages for today</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a></a><span class="do">## Pacakges for today</span></span>
<span id="cb17-2"><a></a>the_packages <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb17-3"><a></a>  <span class="do">## R Markdown</span></span>
<span id="cb17-4"><a></a>  <span class="st">"kableExtra"</span>,<span class="st">"DT"</span>,<span class="st">"texreg"</span>,</span>
<span id="cb17-5"><a></a>  <span class="do">## Tidyverse</span></span>
<span id="cb17-6"><a></a>  <span class="st">"tidyverse"</span>, <span class="st">"lubridate"</span>, <span class="st">"forcats"</span>, <span class="st">"haven"</span>, <span class="st">"labelled"</span>,</span>
<span id="cb17-7"><a></a>  <span class="do">## Extensions for ggplot</span></span>
<span id="cb17-8"><a></a>  <span class="st">"ggmap"</span>,<span class="st">"ggrepel"</span>, <span class="st">"ggridges"</span>, <span class="st">"ggthemes"</span>, <span class="st">"ggpubr"</span>, </span>
<span id="cb17-9"><a></a>  <span class="st">"GGally"</span>, <span class="st">"scales"</span>, <span class="st">"dagitty"</span>, <span class="st">"ggdag"</span>, <span class="st">"ggforce"</span>,</span>
<span id="cb17-10"><a></a>  <span class="co"># Data </span></span>
<span id="cb17-11"><a></a>  <span class="st">"COVID19"</span>,<span class="st">"maps"</span>,<span class="st">"mapdata"</span>,<span class="st">"qss"</span>,<span class="st">"tidycensus"</span>, <span class="st">"dataverse"</span>, </span>
<span id="cb17-12"><a></a>  <span class="co"># Analysis</span></span>
<span id="cb17-13"><a></a>  <span class="st">"DeclareDesign"</span>, <span class="st">"easystats"</span>, <span class="st">"zoo"</span></span>
<span id="cb17-14"><a></a>)</span>
<span id="cb17-15"><a></a></span>
<span id="cb17-16"><a></a><span class="do">## Define a function to load (and if needed install) packages</span></span>
<span id="cb17-17"><a></a></span>
<span id="cb17-18"><a></a><span class="co">#| label = "ipak"</span></span>
<span id="cb17-19"><a></a>ipak <span class="ot">&lt;-</span> <span class="cf">function</span>(pkg){</span>
<span id="cb17-20"><a></a>    new.pkg <span class="ot">&lt;-</span> pkg[<span class="sc">!</span>(pkg <span class="sc">%in%</span> <span class="fu">installed.packages</span>()[, <span class="st">"Package"</span>])]</span>
<span id="cb17-21"><a></a>    <span class="cf">if</span> (<span class="fu">length</span>(new.pkg)) </span>
<span id="cb17-22"><a></a>        <span class="fu">install.packages</span>(new.pkg, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-23"><a></a>    <span class="fu">sapply</span>(pkg, require, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-24"><a></a>}</span>
<span id="cb17-25"><a></a></span>
<span id="cb17-26"><a></a><span class="do">## Install (if needed) and load libraries in the_packages</span></span>
<span id="cb17-27"><a></a><span class="fu">ipak</span>(the_packages)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   kableExtra            DT        texreg     tidyverse     lubridate 
         TRUE          TRUE          TRUE          TRUE          TRUE 
      forcats         haven      labelled         ggmap       ggrepel 
         TRUE          TRUE          TRUE          TRUE          TRUE 
     ggridges      ggthemes        ggpubr        GGally        scales 
         TRUE          TRUE          TRUE          TRUE          TRUE 
      dagitty         ggdag       ggforce       COVID19          maps 
         TRUE          TRUE          TRUE          TRUE          TRUE 
      mapdata           qss    tidycensus     dataverse DeclareDesign 
         TRUE          TRUE          TRUE          TRUE          TRUE 
    easystats           zoo 
         TRUE          TRUE </code></pre>
</div>
</div>
</section></section>
<section>
<section id="previewing-the-lab" class="title-slide slide level1 center">
<h1><i class="fa-solid fa-code" aria-label="code"></i>Previewing the Lab</h1>

</section>
<section id="red-covid" class="slide level2 smaller">
<h2>Red Covid</h2>
<div class="columns">
<div class="column" style="width:45%;">
<p><img data-src="images/05_redcovid_orig.png"></p>
<p><a href="https://www.nytimes.com/2021/09/27/briefing/covid-red-states-vaccinations.html" target="_blank">Red Covid</a> <em>New York Times</em>, 27 September, 2021</p>
</div><div class="column" style="width:45%;">
<p><img data-src="images/05_covid.png"> <a href="https://www.nytimes.com/2022/02/18/briefing/red-covid-partisan-deaths-vaccines.html" target="_blank">Red Covid, an Update</a> <em>New York Times</em>, 18 February, 2022</p>
</div></div>
</section>
<section id="preview-of-the-lab" class="slide level2 smaller">
<h2>Preview of the Lab</h2>
<p><span class="blue">Please download</span> Thursday’s lab <a href="https://pols1600.paultesta.org/labs/05-lab.qmd" target="_blank">here</a></p>
<ul>
<li class="fragment"><p>Conceptually, this lab is designed to help reinforce the relationship between linear models like <span class="math inline">\(y=\beta_0 + \beta_1x\)</span> and the conditional expectation function <span class="math inline">\(E[Y|X]\)</span>.</p></li>
<li class="fragment"><p>Substantively, we will explore whether David Leonhardt’s claims about <a href="https://www.nytimes.com/2021/09/27/briefing/covid-red-states-vaccinations.html" target="_blank">Red Covid</a> the political polarization of vaccines and its consequences</p></li>
</ul>
</section>
<section id="lab-questions-1-5-review" class="slide level2 smaller">
<h2>Lab: Questions 1-5: Review</h2>
<p>Questions 1-5 are designed to <span class="blue">reinforce</span> your <span class="blue">data wrangling</span> skills. In particular, you will get practice:</p>
<ul>
<li class="fragment">Creating and recoding variables using <code>mutate()</code></li>
<li class="fragment">Calculating a <a href="https://en.wikipedia.org/wiki/Moving_average" target="_blank">moving average</a> or rolling mean using the <code>rollmean()</code> function from the <code>zoo</code> package</li>
<li class="fragment">Transforming the data on presidential elections so that it can be merged with the data on Covid-19 using the <code>pivot_wider()</code> function.</li>
<li class="fragment"><a href="https://r4ds.had.co.nz/relational-data.html" target="_blank">Merging data</a> together using the <code>left_join()</code> function.</li>
</ul>
</section>
<section id="lab-questions-6-10-simple-linear-regression" class="slide level2 smaller">
<h2>Lab: Questions 6-10: Simple Linear Regression</h2>
<ul>
<li class="fragment"><p>In question 6, you will see how calculating conditional means provides a simple test of “Red Covid” claim.</p></li>
<li class="fragment"><p>In question 7, you will see how a linear model returns the same information as these conditional means (in a sligthly different format)</p></li>
<li class="fragment"><p>In question 8, you will get practice interpreting linear models with continuous predictors (i.e.&nbsp;predictors that take on a range of values)</p></li>
<li class="fragment"><p>In question 9, you will get practice visualizing these models and using the figures help interpret your results substantively.</p></li>
<li class="fragment"><p>Question 10 asks you to play the role of a skeptic and consider what other factors might explain the relationships we found in Questions 6-9. We will explore these factors in next week’s lab.</p></li>
</ul>
</section>
<section id="before-thursday" class="slide level2">
<h2>Before Thursday</h2>
<p>The following slides provide detailed explanations of all the code you’ll need for each question.</p>
<ul>
<li class="fragment"><p><span class="blue">Please run this code before class on Thursday</span></p></li>
<li class="fragment"><p>We will review this material together at the start of class, but you will spend most of our time on the Questions 6-10</p></li>
</ul>
</section>
<section id="q1-setup-your-workspace" class="slide level2">
<h2>Q1: Setup your workspace</h2>
<div class="panel-tabset">
<ul id="tabset-6" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-6-1">Task</a></li><li><a href="#tabset-6-2">Code for Q1</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1">
<p>Q1 asks you to setup your workspace</p>
<p>This means <span class="blue">loading</span> and, if needed, <span class="blue">installing</span> the packages you will use.</p>
</div>
<div id="tabset-6-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a></a><span class="do">## Pacakges for today</span></span>
<span id="cb19-2"><a></a>the_packages <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb19-3"><a></a>  <span class="do">## R Markdown</span></span>
<span id="cb19-4"><a></a>  <span class="st">"kableExtra"</span>,<span class="st">"DT"</span>,<span class="st">"texreg"</span>,</span>
<span id="cb19-5"><a></a>  <span class="do">## Tidyverse</span></span>
<span id="cb19-6"><a></a>  <span class="st">"tidyverse"</span>, <span class="st">"lubridate"</span>, <span class="st">"forcats"</span>, <span class="st">"haven"</span>, <span class="st">"labelled"</span>,</span>
<span id="cb19-7"><a></a>  <span class="do">## Extensions for ggplot</span></span>
<span id="cb19-8"><a></a>  <span class="st">"ggmap"</span>,<span class="st">"ggrepel"</span>, <span class="st">"ggridges"</span>, <span class="st">"ggthemes"</span>, <span class="st">"ggpubr"</span>, </span>
<span id="cb19-9"><a></a>  <span class="st">"GGally"</span>, <span class="st">"scales"</span>, <span class="st">"dagitty"</span>, <span class="st">"ggdag"</span>, <span class="st">"ggforce"</span>,</span>
<span id="cb19-10"><a></a>  <span class="co"># Data </span></span>
<span id="cb19-11"><a></a>  <span class="st">"COVID19"</span>,<span class="st">"maps"</span>,<span class="st">"mapdata"</span>,<span class="st">"qss"</span>,<span class="st">"tidycensus"</span>, <span class="st">"dataverse"</span>, </span>
<span id="cb19-12"><a></a>  <span class="co"># Analysis</span></span>
<span id="cb19-13"><a></a>  <span class="st">"DeclareDesign"</span>, <span class="st">"easystats"</span>, <span class="st">"zoo"</span></span>
<span id="cb19-14"><a></a>)</span>
<span id="cb19-15"><a></a></span>
<span id="cb19-16"><a></a><span class="do">## Define a function to load (and if needed install) packages</span></span>
<span id="cb19-17"><a></a></span>
<span id="cb19-18"><a></a><span class="co">#| label = "ipak"</span></span>
<span id="cb19-19"><a></a>ipak <span class="ot">&lt;-</span> <span class="cf">function</span>(pkg){</span>
<span id="cb19-20"><a></a>    new.pkg <span class="ot">&lt;-</span> pkg[<span class="sc">!</span>(pkg <span class="sc">%in%</span> <span class="fu">installed.packages</span>()[, <span class="st">"Package"</span>])]</span>
<span id="cb19-21"><a></a>    <span class="cf">if</span> (<span class="fu">length</span>(new.pkg)) </span>
<span id="cb19-22"><a></a>        <span class="fu">install.packages</span>(new.pkg, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-23"><a></a>    <span class="fu">sapply</span>(pkg, require, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-24"><a></a>}</span>
<span id="cb19-25"><a></a></span>
<span id="cb19-26"><a></a><span class="do">## Install (if needed) and load libraries in the_packages</span></span>
<span id="cb19-27"><a></a><span class="fu">ipak</span>(the_packages)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="q2-load-the-data" class="slide level2">
<h2>Q2 Load the data</h2>
<p>To explore Leonhardt’s claims about <em>Red Covid</em>, we’ll need data on:</p>
<ul>
<li class="fragment">Covid-19</li>
<li class="fragment">The 2020 Presidential Election</li>
</ul>
</section>
<section id="q2.1-load-the-covid-19-data" class="slide level2 smaller">
<h2>Q2.1 Load the Covid-19 Data</h2>
<p>To load data on Covid-19 just run this</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a></a><span class="fu">load</span>(<span class="fu">url</span>(<span class="st">"https://pols1600.paultesta.org/files/data/covid.rda"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="q2.2-load-election-data" class="slide level2 smaller">
<h2>Q2.2 Load Election Data</h2>
<div class="panel-tabset">
<ul id="tabset-7" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-7-1">Task</a></li><li><a href="#tabset-7-2">Code for Q2.2</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1">
<p>Q2.2. asks you to write code that will download data presidential elections from 1976 to 2020 from the MIT Election Lab’s dataverse</p>
<ul>
<li class="fragment">Once you’ve installed the <code>dataverse</code> package you should be able to do this:</li>
</ul>
</div>
<div id="tabset-7-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a></a><span class="co"># Try this code first</span></span>
<span id="cb21-2"><a></a><span class="fu">Sys.setenv</span>(<span class="st">"DATAVERSE_SERVER"</span> <span class="ot">=</span> <span class="st">"dataverse.harvard.edu"</span>)</span>
<span id="cb21-3"><a></a></span>
<span id="cb21-4"><a></a>pres_df <span class="ot">&lt;-</span> dataverse<span class="sc">::</span><span class="fu">get_dataframe_by_name</span>(</span>
<span id="cb21-5"><a></a>  <span class="st">"1976-2020-president.tab"</span>,</span>
<span id="cb21-6"><a></a>  <span class="st">"doi:10.7910/DVN/42MVDX"</span></span>
<span id="cb21-7"><a></a>)</span>
<span id="cb21-8"><a></a></span>
<span id="cb21-9"><a></a><span class="co"># If the code above fails, comment out and uncomment the code below:</span></span>
<span id="cb21-10"><a></a></span>
<span id="cb21-11"><a></a><span class="co"># load(url("https://pols1600.paultesta.org/files/data/pres_df.rda"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="q3-describe-the-structure-of-each-dataset" class="slide level2 smaller">
<h2>Q3 Describe the structure of each dataset</h2>
<p>Question 3 asks you to <span class="blue">describe the structure</span> of each dataset.</p>
<ul>
<li class="fragment">Specifically, it asks you to get a high level overview of <code>covid</code> and <code>pres_df</code> and describe the <span class="blue">unit of analysis</span> in each dataset:
<ul>
<li class="fragment">Describe substantively what specific, observation each <span class="blue">row</span> in the dataset corresponds to</li>
<li class="fragment">In covid <code>covid</code> dataset, the <span class="blue">unit of analysis</span> is a <span class="blue">state-date</span></li>
</ul></li>
</ul>
</section>
<section id="q3-describe-the-structure-of-each-dataset-1" class="slide level2 smaller">
<h2>Q3 Describe the structure of each dataset</h2>
<p>Here’s some possible code you could use to get a quick <span class="blue">HLO</span> of each dataset:</p>
<div class="panel-tabset">
<ul id="tabset-8" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-8-1">HLO <code>covid</code></a></li><li><a href="#tabset-8-2">HLO <code>pres_df</code></a></li></ul>
<div class="tab-content">
<div id="tabset-8-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a></a><span class="co"># check names in `covid`</span></span>
<span id="cb22-2"><a></a><span class="fu">names</span>(covid)</span>
<span id="cb22-3"><a></a></span>
<span id="cb22-4"><a></a><span class="co"># take a quick look values of each variable</span></span>
<span id="cb22-5"><a></a></span>
<span id="cb22-6"><a></a><span class="fu">glimpse</span>(covid)</span>
<span id="cb22-7"><a></a></span>
<span id="cb22-8"><a></a><span class="co"># Look at first few observations for:</span></span>
<span id="cb22-9"><a></a><span class="co"># date, administrative_area_level_2, </span></span>
<span id="cb22-10"><a></a></span>
<span id="cb22-11"><a></a>covid <span class="sc">%&gt;%</span> </span>
<span id="cb22-12"><a></a>  <span class="fu">select</span>(date, administrative_area_level_2) <span class="sc">%&gt;%</span></span>
<span id="cb22-13"><a></a>  <span class="fu">head</span>()</span>
<span id="cb22-14"><a></a></span>
<span id="cb22-15"><a></a><span class="co"># Summarize data to get a better sense of the unit of observastion</span></span>
<span id="cb22-16"><a></a></span>
<span id="cb22-17"><a></a>covid <span class="sc">%&gt;%</span> </span>
<span id="cb22-18"><a></a>  <span class="fu">group_by</span>(administrative_area_level_2) <span class="sc">%&gt;%</span></span>
<span id="cb22-19"><a></a>  <span class="fu">summarise</span>(</span>
<span id="cb22-20"><a></a>    <span class="at">n =</span> <span class="fu">n</span>(), <span class="co"># Number of observations for each state</span></span>
<span id="cb22-21"><a></a>    <span class="at">start_date =</span> <span class="fu">min</span>(date, <span class="at">na.rm =</span> T),</span>
<span id="cb22-22"><a></a>    <span class="at">end_date =</span> <span class="fu">max</span>(date, <span class="at">na.rm=</span>T)</span>
<span id="cb22-23"><a></a>  ) <span class="ot">-&gt;</span> hlo_covid_df</span>
<span id="cb22-24"><a></a></span>
<span id="cb22-25"><a></a>hlo_covid_df</span>
<span id="cb22-26"><a></a></span>
<span id="cb22-27"><a></a></span>
<span id="cb22-28"><a></a><span class="co"># How many unique values of date and state are their:</span></span>
<span id="cb22-29"><a></a></span>
<span id="cb22-30"><a></a>n_dates <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(covid<span class="sc">$</span>date))</span>
<span id="cb22-31"><a></a>n_states <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(covid<span class="sc">$</span>administrative_area_level_2))</span>
<span id="cb22-32"><a></a>n_dates</span>
<span id="cb22-33"><a></a>n_states</span>
<span id="cb22-34"><a></a></span>
<span id="cb22-35"><a></a><span class="co"># If we had observations for every state on every date then the number of rows </span></span>
<span id="cb22-36"><a></a><span class="co"># in the data </span></span>
<span id="cb22-37"><a></a><span class="fu">dim</span>(covid)[<span class="dv">1</span>]</span>
<span id="cb22-38"><a></a><span class="co"># Should equal</span></span>
<span id="cb22-39"><a></a><span class="fu">dim</span>(covid)[<span class="dv">1</span>] <span class="sc">==</span> n_dates <span class="sc">*</span> n_states</span>
<span id="cb22-40"><a></a></span>
<span id="cb22-41"><a></a><span class="co"># This is what economists would call an unbalanced panel</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-8-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a></a><span class="co"># check names in `pres_df`</span></span>
<span id="cb23-2"><a></a><span class="fu">names</span>(pres_df)</span>
<span id="cb23-3"><a></a></span>
<span id="cb23-4"><a></a><span class="co"># take a quick look values of each variable</span></span>
<span id="cb23-5"><a></a></span>
<span id="cb23-6"><a></a><span class="fu">glimpse</span>(pres_df)</span>
<span id="cb23-7"><a></a></span>
<span id="cb23-8"><a></a><span class="co"># Unit of analysis is a year-state-candidate</span></span>
<span id="cb23-9"><a></a>pres_df <span class="sc">%&gt;%</span> </span>
<span id="cb23-10"><a></a>  <span class="fu">select</span>(year, state_po, candidate) <span class="sc">%&gt;%</span></span>
<span id="cb23-11"><a></a>  <span class="fu">head</span>()</span>
<span id="cb23-12"><a></a></span>
<span id="cb23-13"><a></a><span class="co"># How many states?</span></span>
<span id="cb23-14"><a></a><span class="fu">length</span>(<span class="fu">unique</span>(pres_df<span class="sc">$</span>state_po))</span>
<span id="cb23-15"><a></a></span>
<span id="cb23-16"><a></a></span>
<span id="cb23-17"><a></a></span>
<span id="cb23-18"><a></a><span class="co"># How many candidates and parties on the ballot in a given election year</span></span>
<span id="cb23-19"><a></a>pres_df <span class="sc">%&gt;%</span> </span>
<span id="cb23-20"><a></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb23-21"><a></a>  <span class="fu">summarise</span>(</span>
<span id="cb23-22"><a></a>    <span class="at">n_candidates =</span> <span class="fu">length</span>(<span class="fu">unique</span>(candidate)),</span>
<span id="cb23-23"><a></a>    <span class="co"># Look at both party_detailed and party_simplified</span></span>
<span id="cb23-24"><a></a>    <span class="at">n_parties_detailed =</span> <span class="fu">length</span>(<span class="fu">unique</span>(party_detailed)),</span>
<span id="cb23-25"><a></a>    <span class="at">n_parties_simplified =</span> <span class="fu">length</span>(<span class="fu">unique</span>(party_simplified))</span>
<span id="cb23-26"><a></a>  ) <span class="ot">-&gt;</span> hlo_pres_df</span>
<span id="cb23-27"><a></a>hlo_pres_df</span>
<span id="cb23-28"><a></a></span>
<span id="cb23-29"><a></a><span class="co"># Look at 2020</span></span>
<span id="cb23-30"><a></a><span class="co"># pres_df$candidate[pres_df$year == "2020"]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="q4-recode-the-data-for-analysis" class="slide level2">
<h2>Q4 Recode the data for analysis</h2>
<p>Using our understanding of the structure of the data, Q4 asks you to:</p>
<ul>
<li class="fragment">Recode the Covid-19 data like we’ve done before <span class="blue">plus</span></li>
<li class="fragment">Calculate <span class="blue">rolling means</span>, 7 and 14 day averages</li>
<li class="fragment">Reshape, recode, and filter the presidential election data</li>
</ul>
</section>
<section id="q4.1-recode-the-covid-19" class="slide level2 smaller">
<h2>Q4.1 Recode the Covid-19</h2>
<div class="panel-tabset">
<ul id="tabset-9" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-9-1">Task</a></li><li><a href="#tabset-9-2">Code for Q4.1</a></li><li><a href="#tabset-9-3">Template Code for Q4.2</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1">
<p>This is the same code we’ve used before to create <code>covid_us</code> from <code>covid</code> with the addition of code to calculate a <span class="blue">rolling mean</span> or <span class="blue">moving average</span> of the number of new cases</p>
</div>
<div id="tabset-9-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a></a><span class="co"># Create a vector containing of US territories</span></span>
<span id="cb24-2"><a></a>territories <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb24-3"><a></a>  <span class="st">"American Samoa"</span>,</span>
<span id="cb24-4"><a></a>  <span class="st">"Guam"</span>,</span>
<span id="cb24-5"><a></a>  <span class="st">"Northern Mariana Islands"</span>,</span>
<span id="cb24-6"><a></a>  <span class="st">"Puerto Rico"</span>,</span>
<span id="cb24-7"><a></a>  <span class="st">"Virgin Islands"</span></span>
<span id="cb24-8"><a></a>  )</span>
<span id="cb24-9"><a></a></span>
<span id="cb24-10"><a></a><span class="co"># Filter out Territories and create state variable</span></span>
<span id="cb24-11"><a></a>covid_us <span class="ot">&lt;-</span> covid <span class="sc">%&gt;%</span></span>
<span id="cb24-12"><a></a>  <span class="fu">filter</span>(<span class="sc">!</span>administrative_area_level_2 <span class="sc">%in%</span> territories)<span class="sc">%&gt;%</span></span>
<span id="cb24-13"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb24-14"><a></a>    <span class="at">state =</span> administrative_area_level_2</span>
<span id="cb24-15"><a></a>  )</span>
<span id="cb24-16"><a></a></span>
<span id="cb24-17"><a></a><span class="co"># Calculate new cases, new cases per capita, and 7-day average</span></span>
<span id="cb24-18"><a></a></span>
<span id="cb24-19"><a></a>covid_us <span class="sc">%&gt;%</span></span>
<span id="cb24-20"><a></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(state) <span class="sc">%&gt;%</span></span>
<span id="cb24-21"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb24-22"><a></a>    <span class="at">new_cases =</span> confirmed <span class="sc">-</span> <span class="fu">lag</span>(confirmed),</span>
<span id="cb24-23"><a></a>    <span class="at">new_cases_pc =</span> new_cases <span class="sc">/</span> population <span class="sc">*</span><span class="dv">100000</span>,</span>
<span id="cb24-24"><a></a>    <span class="at">new_cases_pc_7da =</span> zoo<span class="sc">::</span><span class="fu">rollmean</span>(new_cases_pc, </span>
<span id="cb24-25"><a></a>                                     <span class="at">k =</span> <span class="dv">7</span>, </span>
<span id="cb24-26"><a></a>                                     <span class="at">align =</span> <span class="st">"right"</span>,</span>
<span id="cb24-27"><a></a>                                     <span class="at">fill=</span><span class="cn">NA</span> )</span>
<span id="cb24-28"><a></a>    ) <span class="ot">-&gt;</span> covid_us</span>
<span id="cb24-29"><a></a></span>
<span id="cb24-30"><a></a><span class="co"># Recode facemask policy</span></span>
<span id="cb24-31"><a></a></span>
<span id="cb24-32"><a></a>covid_us <span class="sc">%&gt;%</span></span>
<span id="cb24-33"><a></a><span class="fu">mutate</span>(</span>
<span id="cb24-34"><a></a>  <span class="co"># Recode facial_coverings to create face_masks</span></span>
<span id="cb24-35"><a></a>    <span class="at">face_masks =</span> <span class="fu">case_when</span>(</span>
<span id="cb24-36"><a></a>      facial_coverings <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"No policy"</span>,</span>
<span id="cb24-37"><a></a>      <span class="fu">abs</span>(facial_coverings) <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Recommended"</span>,</span>
<span id="cb24-38"><a></a>      <span class="fu">abs</span>(facial_coverings) <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Some requirements"</span>,</span>
<span id="cb24-39"><a></a>      <span class="fu">abs</span>(facial_coverings) <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"Required shared places"</span>,</span>
<span id="cb24-40"><a></a>      <span class="fu">abs</span>(facial_coverings) <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"Required all times"</span>,</span>
<span id="cb24-41"><a></a>    ),</span>
<span id="cb24-42"><a></a>    <span class="co"># Turn face_masks into a factor with ordered policy levels</span></span>
<span id="cb24-43"><a></a>    <span class="at">face_masks =</span> <span class="fu">factor</span>(face_masks,</span>
<span id="cb24-44"><a></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"No policy"</span>,<span class="st">"Recommended"</span>,</span>
<span id="cb24-45"><a></a>                 <span class="st">"Some requirements"</span>,</span>
<span id="cb24-46"><a></a>                 <span class="st">"Required shared places"</span>,</span>
<span id="cb24-47"><a></a>                 <span class="st">"Required all times"</span>)</span>
<span id="cb24-48"><a></a>    ) </span>
<span id="cb24-49"><a></a>    ) <span class="ot">-&gt;</span> covid_us</span>
<span id="cb24-50"><a></a></span>
<span id="cb24-51"><a></a><span class="co"># Create year-month and percent vaccinated variables</span></span>
<span id="cb24-52"><a></a></span>
<span id="cb24-53"><a></a>covid_us <span class="sc">%&gt;%</span></span>
<span id="cb24-54"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb24-55"><a></a>    <span class="at">year =</span> <span class="fu">year</span>(date),</span>
<span id="cb24-56"><a></a>    <span class="at">month =</span> <span class="fu">month</span>(date),</span>
<span id="cb24-57"><a></a>    <span class="at">year_month =</span> <span class="fu">paste</span>(year, </span>
<span id="cb24-58"><a></a>                       <span class="fu">str_pad</span>(month, <span class="at">width =</span> <span class="dv">2</span>, <span class="at">pad=</span><span class="dv">0</span>), </span>
<span id="cb24-59"><a></a>                       <span class="at">sep =</span> <span class="st">"-"</span>),</span>
<span id="cb24-60"><a></a>    <span class="at">percent_vaccinated =</span> people_fully_vaccinated<span class="sc">/</span>population<span class="sc">*</span><span class="dv">100</span>  </span>
<span id="cb24-61"><a></a>    ) <span class="ot">-&gt;</span> covid_us</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-9-3">
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a></a><span class="co"># Calculate new cases, new cases per capita, and 7-day average</span></span>
<span id="cb25-2"><a></a></span>
<span id="cb25-3"><a></a>covid_us <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(state) <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb25-6"><a></a>    <span class="at">new_cases =</span> confirmed <span class="sc">-</span> <span class="fu">lag</span>(confirmed),</span>
<span id="cb25-7"><a></a>    <span class="at">new_cases_pc =</span> new_cases <span class="sc">/</span> population <span class="sc">*</span><span class="dv">100000</span>,</span>
<span id="cb25-8"><a></a>    <span class="at">new_cases_pc_7day =</span> zoo<span class="sc">::</span><span class="fu">rollmean</span>(new_cases_pc, </span>
<span id="cb25-9"><a></a>                                     <span class="at">k =</span> <span class="dv">7</span>, </span>
<span id="cb25-10"><a></a>                                     <span class="at">align =</span> <span class="st">"right"</span>,</span>
<span id="cb25-11"><a></a>                                     <span class="at">fill=</span><span class="cn">NA</span> )</span>
<span id="cb25-12"><a></a>    ) <span class="ot">-&gt;</span> covid_us</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="q4.2-calculate-rolling-means-of-covid-deaths" class="slide level2 smaller">
<h2>Q4.2 Calculate Rolling Means of Covid Deaths</h2>
<div class="panel-tabset">
<ul id="tabset-10" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-10-1">Task</a></li><li><a href="#tabset-10-2">Code for Q4.2</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1">
<p>Q4.2 asks you to create new measures of the 7-day and 14-day averages of new deaths from Covid-19 per 100,000 residents</p>
<p>It encourages you to use the code <code>new_cases_pc_7da</code> as a template</p>
<p>To build your coding skills, try writing this yourself, then comparing it to the code in the next tab:</p>
</div>
<div id="tabset-10-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a></a>covid_us <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(state) <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb26-4"><a></a>    <span class="at">new_deaths =</span> deaths <span class="sc">-</span> <span class="fu">lag</span>(deaths),</span>
<span id="cb26-5"><a></a>    <span class="at">new_deaths_pc =</span> new_deaths <span class="sc">/</span> population <span class="sc">*</span><span class="dv">100000</span>,</span>
<span id="cb26-6"><a></a>    <span class="at">new_deaths_pc_7day =</span> zoo<span class="sc">::</span><span class="fu">rollmean</span>(new_deaths_pc, </span>
<span id="cb26-7"><a></a>                                     <span class="at">k =</span> <span class="dv">7</span>, </span>
<span id="cb26-8"><a></a>                                     <span class="at">align =</span> <span class="st">"right"</span>,</span>
<span id="cb26-9"><a></a>                                     <span class="at">fill=</span><span class="cn">NA</span> ),</span>
<span id="cb26-10"><a></a>    <span class="at">new_deaths_pc_14day =</span> zoo<span class="sc">::</span><span class="fu">rollmean</span>(new_deaths_pc, </span>
<span id="cb26-11"><a></a>                                     <span class="at">k =</span> <span class="dv">14</span>, </span>
<span id="cb26-12"><a></a>                                     <span class="at">align =</span> <span class="st">"right"</span>,</span>
<span id="cb26-13"><a></a>                                     <span class="at">fill=</span><span class="cn">NA</span> )</span>
<span id="cb26-14"><a></a>    ) <span class="ot">-&gt;</span> covid_us</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="rolling-averages" class="slide level2 smaller">
<h2>Rolling Averages</h2>
<p>The next slides <span class="blue">aren’t necessary for the lab</span> but are designed to illustrate:</p>
<ul>
<li class="fragment">the <span class="blue">concept of a rolling mean</span></li>
<li class="fragment"><span class="blue">what</span> the code does</li>
<li class="fragment"><span class="blue">why</span> might prefer rolling averages over daily values</li>
</ul>
</section>
<section id="look-at-the-output-of-zoorollmean" class="slide level2">
<h2>Look at the output of <code>zoo::rollmean()</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a></a>covid_us <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a></a>  <span class="fu">filter</span>(date <span class="sc">&gt;</span> <span class="st">"2020-03-05"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a></a>  <span class="fu">select</span>(date,new_cases_pc,new_cases_pc_7day)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 52,580 × 4
# Groups:   state [51]
   state     date       new_cases_pc new_cases_pc_7day
   &lt;chr&gt;     &lt;date&gt;            &lt;dbl&gt;             &lt;dbl&gt;
 1 Minnesota 2020-03-06      NA                NA     
 2 Minnesota 2020-03-07       0                NA     
 3 Minnesota 2020-03-08       0.0177           NA     
 4 Minnesota 2020-03-09       0                NA     
 5 Minnesota 2020-03-10       0.0177           NA     
 6 Minnesota 2020-03-11       0.0355           NA     
 7 Minnesota 2020-03-12       0.0709           NA     
 8 Minnesota 2020-03-13       0.0887            0.0329
 9 Minnesota 2020-03-14       0.124             0.0507
10 Minnesota 2020-03-15       0.248             0.0836
# ℹ 52,570 more rows</code></pre>
</div>
</div>
</section>
<section id="comparing-daily-cases-to-rolling-average" class="slide level2 smaller">
<h2>Comparing Daily Cases to Rolling Average</h2>
<p>The following code illustrates how a 7-day rolling mean smooths (<code>new_cases_pc_7da</code>) over the <span class="blue"><em>noisiness</em></span> of the daily measure</p>
<div class="panel-tabset">
<ul id="tabset-11" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-11-1">Code</a></li><li><a href="#tabset-11-2">Figure</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a></a>covid_us <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a></a>  <span class="fu">filter</span>(date <span class="sc">&gt;</span> <span class="st">"2020-03-05"</span>, </span>
<span id="cb29-3"><a></a>         state <span class="sc">==</span> <span class="st">"Minnesota"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a></a>  <span class="fu">select</span>(date,</span>
<span id="cb29-5"><a></a>         new_cases_pc,</span>
<span id="cb29-6"><a></a>         new_cases_pc_7day)<span class="sc">%&gt;%</span></span>
<span id="cb29-7"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(date,new_cases_pc ))<span class="sc">+</span></span>
<span id="cb29-8"><a></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">col=</span><span class="st">"Daily"</span>))<span class="sc">+</span></span>
<span id="cb29-9"><a></a>  <span class="co"># set y aesthetic for second line of rolling average</span></span>
<span id="cb29-10"><a></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> new_cases_pc_7day,</span>
<span id="cb29-11"><a></a>                <span class="at">col =</span> <span class="st">"7-day average"</span>)</span>
<span id="cb29-12"><a></a>            ) <span class="sc">+</span></span>
<span id="cb29-13"><a></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb29-14"><a></a>    <span class="fu">labs</span>( <span class="at">col =</span> <span class="st">"Measure"</span>,</span>
<span id="cb29-15"><a></a>    <span class="at">y =</span> <span class="st">"New Cases Per 100k"</span>, <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb29-16"><a></a>    <span class="at">title =</span> <span class="st">"Minnesota"</span></span>
<span id="cb29-17"><a></a>  ) <span class="ot">-&gt;</span> fig_covid_mn </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-11-2">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05-slides_files/figure-revealjs/plotmean2-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="q4.3-recode-presidential-data" class="slide level2 smaller">
<h2>Q4.3 Recode Presidential data</h2>
<div class="panel-tabset">
<ul id="tabset-12" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-12-1">Task</a></li><li><a href="#tabset-12-2">Code for Q4.3</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1">
<p>Q4.3 Gives you a long list of steps to recode, reshape, and filter <code>pres_df</code> to produce <code>pres_df2020</code></p>
<p>Most of this is review but it can seem like a lot.</p>
<p>Walk through the provided code and see if you can <span class="blue">map each conceptual step</span> in Q4.3 to its <span class="blue">implementation in the code</span></p>
</div>
<div id="tabset-12-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a></a>pres_df <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb30-3"><a></a>    <span class="at">year_election =</span> year,</span>
<span id="cb30-4"><a></a>    <span class="at">state =</span> <span class="fu">str_to_title</span>(state),</span>
<span id="cb30-5"><a></a>    <span class="co"># Fix DC</span></span>
<span id="cb30-6"><a></a>    <span class="at">state =</span> <span class="fu">ifelse</span>(state <span class="sc">==</span> <span class="st">"District Of Columbia"</span>, <span class="st">"District of Columbia"</span>, state)</span>
<span id="cb30-7"><a></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb30-8"><a></a>  <span class="fu">filter</span>(party_simplified <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"DEMOCRAT"</span>,<span class="st">"REPUBLICAN"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb30-9"><a></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-10"><a></a>  <span class="fu">select</span>(state, state_po, year_election, party_simplified, candidatevotes, totalvotes</span>
<span id="cb30-11"><a></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb30-12"><a></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> party_simplified,</span>
<span id="cb30-13"><a></a>              <span class="at">values_from =</span> candidatevotes) <span class="sc">%&gt;%</span></span>
<span id="cb30-14"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb30-15"><a></a>    <span class="at">dem_voteshare =</span> DEMOCRAT<span class="sc">/</span>totalvotes <span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb30-16"><a></a>    <span class="at">rep_voteshare =</span> REPUBLICAN<span class="sc">/</span>totalvotes<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb30-17"><a></a>    <span class="at">winner =</span> forcats<span class="sc">::</span><span class="fu">fct_rev</span>(<span class="fu">factor</span>(<span class="fu">ifelse</span>(rep_voteshare <span class="sc">&gt;</span> dem_voteshare,<span class="st">"Trump"</span>,<span class="st">"Biden"</span>)))</span>
<span id="cb30-18"><a></a>  ) <span class="ot">-&gt;</span> pres2020_df</span>
<span id="cb30-19"><a></a></span>
<span id="cb30-20"><a></a><span class="co"># Check Output:</span></span>
<span id="cb30-21"><a></a></span>
<span id="cb30-22"><a></a><span class="fu">glimpse</span>(pres2020_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 51
Columns: 9
$ state         &lt;chr&gt; "Alabama", "Alaska", "Arizona", "Arkansas", "California"…
$ state_po      &lt;chr&gt; "AL", "AK", "AZ", "AR", "CA", "CO", "CT", "DE", "DC", "F…
$ year_election &lt;dbl&gt; 2020, 2020, 2020, 2020, 2020, 2020, 2020, 2020, 2020, 20…
$ totalvotes    &lt;dbl&gt; 2323282, 359530, 3387326, 1219069, 17500881, 3279980, 18…
$ DEMOCRAT      &lt;dbl&gt; 849624, 153778, 1672143, 423932, 11110250, 1804352, 1080…
$ REPUBLICAN    &lt;dbl&gt; 1441170, 189951, 1661686, 760647, 6006429, 1364607, 7147…
$ dem_voteshare &lt;dbl&gt; 36.56999, 42.77195, 49.36469, 34.77506, 63.48395, 55.011…
$ rep_voteshare &lt;dbl&gt; 62.031643, 52.833143, 49.055981, 62.395730, 34.320724, 4…
$ winner        &lt;fct&gt; Trump, Trump, Biden, Trump, Biden, Biden, Biden, Biden, …</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="q5-merging-data" class="slide level2 smaller">
<h2>Q5 merging data</h2>
<div class="panel-tabset">
<ul id="tabset-13" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-13-1">Task</a></li><li><a href="#tabset-13-2">Merge election data into Covid data</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1">
<p>Q5 asks you to merge the 2020 election data from <code>pres2020_df</code> into <code>covid_us</code> using the common <code>state</code> variable in each dataset using the function <code>left_join()</code></p>
</div>
<div id="tabset-13-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a></a><span class="fu">dim</span>(covid_us)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 53678    61</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a></a><span class="fu">dim</span>(pres2020_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 51  9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a></a>covid_us <span class="ot">&lt;-</span> covid_us <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(</span>
<span id="cb36-2"><a></a>  pres2020_df,</span>
<span id="cb36-3"><a></a>  <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"state"</span> <span class="ot">=</span> <span class="st">"state"</span>)</span>
<span id="cb36-4"><a></a>)</span>
<span id="cb36-5"><a></a><span class="fu">dim</span>(covid_us) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 53678    69</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="advice-for-merging" class="slide level2 smaller">
<h2>Advice for merging</h2>
<div class="panel-tabset">
<ul id="tabset-14" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-14-1">Advice</a></li><li><a href="#tabset-14-2">Illustration</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1">
<p>When merging datasets:</p>
<ul>
<li class="fragment">Check the matches in your joining variables
<ul>
<li class="fragment">Make sure the values <code>state</code> are the same in each dataset</li>
<li class="fragment">Check for differences in spelling, punctuation, etc.</li>
</ul></li>
<li class="fragment">Check the <span class="blue">dimensions</span> of output of your <code>left_join()</code>
<ul>
<li class="fragment">If there is a 1-1 match the number of rows should be the same before after</li>
</ul></li>
</ul>
</div>
<div id="tabset-14-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a></a><span class="co"># Should be 51 states and DC in each</span></span>
<span id="cb38-2"><a></a><span class="fu">sum</span>(<span class="fu">unique</span>(pres_df<span class="sc">$</span>state) <span class="sc">%in%</span> covid_us<span class="sc">$</span>state)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a></a><span class="co"># Look at each state variable</span></span>
<span id="cb40-2"><a></a><span class="do">## With [] index</span></span>
<span id="cb40-3"><a></a>pres_df<span class="sc">$</span>state[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ALABAMA" "ALABAMA" "ALABAMA" "ALABAMA" "ALABAMA"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a></a>covid_us<span class="sc">$</span>state[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Minnesota" "Minnesota" "Minnesota" "Minnesota" "Minnesota"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a></a><span class="co"># Matching is case sensitive </span></span>
<span id="cb44-2"><a></a></span>
<span id="cb44-3"><a></a><span class="co"># make pres_df$state title case</span></span>
<span id="cb44-4"><a></a></span>
<span id="cb44-5"><a></a><span class="do">## Base R:</span></span>
<span id="cb44-6"><a></a>pres_df<span class="sc">$</span>state <span class="ot">&lt;-</span> <span class="fu">str_to_title</span>(pres_df<span class="sc">$</span>state )</span>
<span id="cb44-7"><a></a><span class="do">## Tidy R:</span></span>
<span id="cb44-8"><a></a>pres_df <span class="sc">%&gt;%</span> </span>
<span id="cb44-9"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb44-10"><a></a>    <span class="at">state =</span> <span class="fu">str_to_title</span>(state )</span>
<span id="cb44-11"><a></a>  ) <span class="ot">-&gt;</span> pres_df</span>
<span id="cb44-12"><a></a></span>
<span id="cb44-13"><a></a><span class="co"># Should be 51</span></span>
<span id="cb44-14"><a></a><span class="fu">sum</span>(<span class="fu">unique</span>(pres_df<span class="sc">$</span>state) <span class="sc">%in%</span> covid_us<span class="sc">$</span>state)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 50</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a></a><span class="co"># Find the mismatch:</span></span>
<span id="cb46-2"><a></a><span class="fu">unique</span>(pres_df<span class="sc">$</span>state[<span class="sc">!</span>pres_df<span class="sc">$</span>state <span class="sc">%in%</span> covid_us<span class="sc">$</span>state])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "District Of Columbia"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a></a><span class="co"># Two equivalent ways to fix this mismatch</span></span>
<span id="cb48-2"><a></a><span class="do">## Base R: Quick fix to change spelling of DC</span></span>
<span id="cb48-3"><a></a>pres_df<span class="sc">$</span>state[pres2020_df<span class="sc">$</span>state <span class="sc">==</span> <span class="st">"District Of Columbia"</span>] <span class="ot">&lt;-</span> <span class="st">"District of Columbia"</span></span>
<span id="cb48-4"><a></a></span>
<span id="cb48-5"><a></a><span class="do">## Tidy R: Quick fix to change spelling of DC</span></span>
<span id="cb48-6"><a></a></span>
<span id="cb48-7"><a></a>pres_df <span class="sc">%&gt;%</span> </span>
<span id="cb48-8"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-9"><a></a>    <span class="at">state =</span> <span class="fu">ifelse</span>(<span class="at">test =</span> state <span class="sc">==</span> <span class="st">"District Of Columbia"</span>,</span>
<span id="cb48-10"><a></a>                   <span class="at">yes =</span> <span class="st">"District of Columbia"</span>,</span>
<span id="cb48-11"><a></a>                   <span class="at">no =</span> state</span>
<span id="cb48-12"><a></a>                   )</span>
<span id="cb48-13"><a></a>  ) <span class="ot">-&gt;</span> pres_df</span>
<span id="cb48-14"><a></a></span>
<span id="cb48-15"><a></a></span>
<span id="cb48-16"><a></a><span class="co"># Problem Solved</span></span>
<span id="cb48-17"><a></a><span class="fu">sum</span>(<span class="fu">unique</span>(pres2020_df<span class="sc">$</span>state) <span class="sc">%in%</span> covid_us<span class="sc">$</span>state)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 51</code></pre>
</div>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="causal-inference" class="title-slide slide level1 inverse center">
<h1><i class="fa-solid fa-lightbulb" aria-label="lightbulb"></i> Causal Inference</h1>

</section>
<section id="causal-inference-is-about-counterfactual-comparisons" class="slide level2">
<h2>Causal inference is about counterfactual comparisons</h2>
<ul>
<li class="fragment"><p>Causal inference is about counterfactual comparisons</p>
<ul>
<li class="fragment">What would have happened if some aspect of the world either had or had not been present</li>
</ul></li>
</ul>
</section>
<section id="causal-identification" class="slide level2 smaller">
<h2>Causal Identification</h2>
<ul>
<li class="fragment"><p><span class="blue">Casual Identification</span> refers to “the assumptions needed for statistical estimates to be given a causal interpretation” <a href="http://lukekeele.com/wp-content/uploads/2016/03/causal.pdf" target="_blank">Keele (2015)</a>]</p>
<ul>
<li class="fragment">What do we need to assume to make our claims about cause and effect credible</li>
</ul></li>
<li class="fragment"><p><span class="blue">Experimental Designs</span> rely on <span class="blue">randomization</span> of treatment to justify their causal claims</p></li>
<li class="fragment"><p><span class="blue">Observational Designs</span> require <span class="blue">additional assumptions</span> and <span class="blue">knowledge</span> to make causal claims</p></li>
</ul>
</section>
<section id="experimental-designs" class="slide level2 smaller">
<h2>Experimental Designs</h2>
<ul>
<li class="fragment"><p><span class="blue">Experimental designs</span> are studies in which a causal variable of interest, the <em>treatement</em>, is <span class="blue">manipulated by the researcher</span> to examine its causal effects on some <em>outcome</em> of interest</p></li>
<li class="fragment"><p><span class="blue">Random assignment</span> is the key to causal identification in experiments because it creates <span class="blue">statistical independence</span> between <span class="blue">treatment</span> and <span class="blue">potential outcomes</span> any potential <span class="blue">confounding factors</span></p></li>
</ul>
<div class="fragment">
<p><span class="math display">\[
Y_i(1),Y_i(0),\mathbf{X_i},\mathbf{U_i} \unicode{x2AEB} D_i
\]</span><br>
</p>
</div>
</section>
<section id="randomization-creates-credible-counterfactual-comparisons" class="slide level2 smaller">
<h2>Randomization creates credible counterfactual comparisons</h2>
<p>If treatment has been randomly assigned, then:</p>
<ul>
<li class="fragment">The only thing that differs between treatment and control is that one group got the treatment, and another did not.</li>
<li class="fragment">We can estimate the Average Treatment Effect (ATE) using the difference of sample means</li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\begin{aligned}
E \left[ \frac{\sum_1^m Y_i}{m}-\frac{\sum_{m+1}^N Y_i}{N-m}\right]&amp;=\overbrace{E \left[ \frac{\sum_1^m Y_i}{m}\right]}^{\substack{\text{Average outcome}\\
\text{among treated}\\ \text{units}}}
-\overbrace{E \left[\frac{\sum_{m+1}^N Y_i}{N-m}\right]}^{\substack{\text{Average outcome}\\
\text{among control}\\ \text{units}}}\\
&amp;= E [Y_i(1)|D_i=1] -E[Y_i(0)|D_i=0]
\end{aligned}
\]</span></p>
</div>
</section>
<section id="observational-designs" class="slide level2 smaller">
<h2>Observational Designs</h2>
<ul>
<li class="fragment"><p><span class="blue">Observational designs</span> are studies in which a causal variable of interest is determined by someone/thing <span class="blue">other than the researcher</span> (nature, governments, people, etc.)</p></li>
<li class="fragment"><p>Since treatment has not been randomly assigned, observational studies typically require <span class="blue">stronger assumptions</span> to make causal claims.</p></li>
<li class="fragment"><p>Generally speaking, these assumptions amount to a claim about conditional independence</p></li>
</ul>
<div class="fragment">
<p><span class="math display">\[
Y_i(1),Y_i(0),\mathbf{X_i},\mathbf{U_i} \unicode{x2AEB} D_i | K_i
\]</span></p>
</div>
<ul>
<li class="fragment">Where after conditioning on <span class="math inline">\(K_i\)</span>, some <span class="blue">knowledge about the world</span> and how the <span class="blue">data were generated</span>, our <span class="blue">treatment</span> is as good as (as-if) randomly assigned (hence <span class="blue">conditionally independent</span>)
<ul>
<li class="fragment">Economists often call this assumption of <span class="blue">selection on observables</span></li>
</ul></li>
</ul>
</section>
<section id="causal-inference-in-observational-studies" class="slide level2 smaller">
<h2>Causal Inference in Observational Studies</h2>
<p>To understand how to make causal claims in observational studies we will:</p>
<ul>
<li class="fragment"><p>Introduce the concept of <span class="blue">Directed Acyclic Graphs</span> to describe causal relationships</p></li>
<li class="fragment"><p>Discuss three approaches to <span class="blue">covariate adjustment</span></p>
<ul>
<li class="fragment">Subclassification</li>
<li class="fragment">Matching</li>
<li class="fragment"><span class="blue">Linear Regression</span></li>
</ul></li>
<li class="fragment"><p>Three research designs for observational data</p>
<ul>
<li class="fragment"><span class="blue">Differences-in-Differences</span></li>
<li class="fragment">Regression Discontinuity Designs</li>
<li class="fragment">Instrumental Variables</li>
</ul></li>
</ul>
</section></section>
<section>
<section id="directed-acyclic-graphs" class="title-slide slide level1 inverse center">
<h1><i class="fa-solid fa-lightbulb" aria-label="lightbulb"></i> Directed Acyclic Graphs</h1>

</section>
<section id="two-ways-to-describe-causal-claims" class="slide level2">
<h2>Two Ways to Describe Causal Claims</h2>
<p>In this course, we will use two forms of notation to describe our causal claims.</p>
<ul>
<li class="fragment"><p><em>Potential Outcomes Notation</em> (last lecture)</p>
<ul>
<li class="fragment">Illustrates the <span class="blue">fundamental problem of causal inference</span></li>
</ul></li>
<li class="fragment"><p><span class="blue"><strong>Directed Acyclic Graphs</strong> (DAGs)</span></p>
<ul>
<li class="fragment">Illustrates potential bias from <span class="blue">confounders</span> and <span class="blue">colliders</span></li>
</ul></li>
</ul>
</section>
<section id="directed-acyclic-graphs-1" class="slide level2">
<h2>Directed Acyclic Graphs</h2>
<ul>
<li class="fragment"><p>Directed Acyclic Graphs provide a way of encoding assumptions about casual relationships</p>
<ul>
<li class="fragment"><p><strong>Directed</strong> Arrows <span class="math inline">\(\to\)</span> describe a direct causal effect</p></li>
<li class="fragment"><p>Arrow from <span class="math inline">\(D\to Y\)</span> means <span class="math inline">\(Y_i(d) \neq Y_i(d^\prime)\)</span> “The outcome ( <span class="math inline">\(Y\)</span>) for person <span class="math inline">\(i\)</span> when D happens ( <span class="math inline">\(Y_i(d)\)</span> ) is different than the the outcome when <span class="math inline">\(D\)</span> doesn’t happen ( <span class="math inline">\(Y_i(d^\prime)\)</span> )</p></li>
<li class="fragment"><p>No arrow = no effect ( <span class="math inline">\(Y_i(d) = Y_i(d^\prime)\)</span> )</p></li>
<li class="fragment"><p><strong>Acyclic:</strong> No cycles. A variable can’t cause itself</p></li>
</ul></li>
</ul>
</section>
<section id="types-of-variables-in-a-dag" class="slide level2 smaller">
<h2>Types of variables in a DAG</h2>
<div class="panel-tabset">
<ul id="tabset-15" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-15-1">DAG</a></li><li><a href="#tabset-15-2">Variables</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1">
<p><img data-src="https://book.declaredesign.org/figures/figure-6-2.svg"></p>
<p><span class="citation" data-cites="Blair2023-yg">Blair, Coppock, and Humphreys (<a href="#/references" role="doc-biblioref" onclick="">2023</a>)</span> <a href="https://book.declaredesign.org/declaration-diagnosis-redesign/specifying-model.html#types-of-variables-in-models" target="_blank">(Chap. 6.2)</a></p>
</div>
<div id="tabset-15-2">
<p>Causal Explanations Involve:</p>
<ul>
<li><code>Y</code> our outcome</li>
<li><code>D</code> A possible cause of Y</li>
<li><code>M</code> A <span class="blue">mediator</span> or mechanism through which <code>D</code> effects <code>Y</code></li>
<li><code>Z</code> An <span class="blue">instrument</span> that can help us isolate the effects of D on `Y</li>
<li><code>X2</code> a <span class="blue">covariate</span> that may <span class="blue">moderate</span> the effect of <code>D</code> on <code>Y</code></li>
</ul>
<p>Threats to causal claims/Sources of bias:</p>
<ul>
<li><code>X1</code> an <span class="blue">observed confounder</span> that is a common cause of both <code>D</code> &amp; <code>Y</code></li>
<li><code>U</code> an <span class="blue">unobserved confounder</span> a common cause of both <code>D</code> &amp; <code>Y</code></li>
<li><code>K</code> a <span class="blue">collider</span> that is a common consequence of both <code>D</code> &amp; <code>Y</code></li>
</ul>
</div>
</div>
</div>
</section>
<section id="dags-illustrate-two-sources-of-bias" class="slide level2 scrollable">
<h2>DAGs illustrate two sources of bias:</h2>
<ul>
<li><p><strong>Confounder bias:</strong> Failing to control for a common cause of <code>D</code> <strong>and</strong> <code>Y</code> (aka Omitted Variable Bias)</p></li>
<li><p><strong>Collider bias:</strong> Controlling for a common consequence (aka Selection Bias<sup>1</sup>)</p></li>
</ul>
<aside><ol class="aside-footnotes"><li id="fn1"><p>Note in practice there’s some slippage/debate/disagreement around this nomenclature</p></li></ol></aside></section>
<section id="section-1" class="slide level2 smaller">
<h2></h2>
<h4 id="confounding-bias-the-coffee-example">Confounding Bias: The Coffee Example</h4>
<div class="panel-tabset">
<ul id="tabset-16" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-16-1">Confounding Bias</a></li><li><a href="#tabset-16-2">Coffee and Cancer</a></li><li><a href="#tabset-16-3">Adjusting for Smoking</a></li></ul>
<div class="tab-content">
<div id="tabset-16-1">
<ul>
<li><p>Drinking coffee doesn’t cause lung cancer we might find correlation between them because they share a <span class="blue">common cause:</span> smoking.</p></li>
<li><p>Smoking is a [confounding] variable, that if <span class="blue">omitted</span> will <span class="blue">bias our results</span> producing a <span class="blue">spurious</span> relationsip</p></li>
<li><p>[Adjusting] for [confounders] removes this source of bias</p></li>
</ul>
</div>
<div id="tabset-16-2">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05-slides_files/figure-revealjs/confounded_fig1-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-16-3">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05-slides_files/figure-revealjs/confounded_fig2-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="section-2" class="slide level2 smaller">
<h2></h2>
<h4 id="collider-bias-the-dating-example">Collider Bias: The Dating Example</h4>
<div class="panel-tabset">
<ul id="tabset-17" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-17-1">Collider bias</a></li><li><a href="#tabset-17-2">Selection bias</a></li><li><a href="#tabset-17-3">No relationship in population</a></li></ul>
<div class="tab-content">
<div id="tabset-17-1">
<ul>
<li><p>Why are attractive people such jerks?</p></li>
<li><p>Suppose <span class="blue">dating</span> is a function of <span class="blue">looks</span> and <span class="blue">personality</span></p></li>
<li><p>Dating is a <span class="blue">common consequences</span> of <span class="blue">looks</span> and <span class="blue">personality</span></p></li>
<li><p>Basing our claim off of who we date is an example of <span class="blue">selection bias</span> created by <span class="blue">controlling for collider</span></p></li>
</ul>
</div>
<div id="tabset-17-2">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05-slides_files/figure-revealjs/unnamed-chunk-37-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-17-3">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05-slides_files/figure-revealjs/unnamed-chunk-38-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="when-to-control-for-a-variable" class="slide level2">
<h2>When to control for a variable:</h2>

<img data-src="https://book.declaredesign.org/figures/figure-16-3.svg" class="r-stretch"><p><span class="citation" data-cites="Blair2023-yg">(<a href="#/references" role="doc-biblioref" onclick="">Blair, Coppock, and Humphreys 2023</a>)</span> <a href="https://book.declaredesign.org/declaration-diagnosis-redesign/specifying-model.html#types-of-variables-in-models" target="_blank">(Chap. 6.2)</a></p>
</section></section>
<section>
<section id="covariate-adjustment" class="title-slide slide level1 inverse center">
<h1><i class="fa-solid fa-lightbulb" aria-label="lightbulb"></i> Covariate Adjustment</h1>

</section>
<section id="covariate-adjustment-1" class="slide level2">
<h2>Covariate Adjustment</h2>
<p>Covariate adjustment refers a broad class of procedures that try to make a comparison more credible or meaningful by adjusting for some other potentially confounding factor.</p>
</section>
<section id="covariate-adjustment-2" class="slide level2">
<h2>Covariate Adjustment</h2>
<p>When you hear people talk about</p>
<ul>
<li class="fragment">Controlling for age</li>
<li class="fragment">Conditional on income</li>
<li class="fragment">Holding age and income constant</li>
<li class="fragment">Ceteris paribus (All else equal)</li>
</ul>
<p>They are typically talking about some sort of covariate adjustment.</p>
</section>
<section id="three-approaches-to-covariate-adjustment" class="slide level2 smallero">
<h2>Three approaches to covariate adjustment</h2>
<ul>
<li class="fragment"><span class="blue">Subclassification</span>
<ul>
<li class="fragment">👍: Easy to implement and interpret</li>
<li class="fragment">👎: Curse of dimensionality, Selection on observables</li>
</ul></li>
<li class="fragment"><span class="blue">Matching</span>
<ul>
<li class="fragment">👍: Balance on multiple covariates, Mirrors logic of experimental design</li>
<li class="fragment">👎: Selection on observables, Only provides balance on observed variables, Lot’s of technical details…</li>
</ul></li>
<li class="fragment"><span class="blue">Regression</span>
<ul>
<li class="fragment">👍: Easy to implement, control for many factors (good and bad)</li>
<li class="fragment">👎: Selection on observables, easy to fit “bad” models</li>
</ul></li>
</ul>
</section></section>
<section>
<section id="simple-linear-regression" class="title-slide slide level1 inverse center">
<h1><i class="fa-solid fa-lightbulb" aria-label="lightbulb"></i> Simple Linear Regression</h1>

</section>
<section id="understanding-linear-regression" class="slide level2 smaller">
<h2>Understanding Linear Regression</h2>
<ul>
<li><strong>Conceptual</strong>
<ul>
<li>Simple linear regression estimates “a line of best fit” that summarizes relationships between two variables</li>
</ul></li>
</ul>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1x_i + \epsilon_i
\]</span></p>
<ul>
<li><strong>Practical</strong>
<ul>
<li>We estimate linear models in R using the <code>lm()</code> function</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a></a><span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="understanding-linear-regression-1" class="slide level2 smaller">
<h2>Understanding Linear Regression</h2>
<ul>
<li><em>Technical/Definitional</em>
<ul>
<li>Linear regression chooses <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> to minimize the Sum of Squared Residuals (SSR):</li>
</ul></li>
</ul>
<p><span class="math display">\[\textrm{Find }\hat{\beta_0},\,\hat{\beta_1} \text{ arg min}_{\beta_0, \beta_1} \sum (y_i-(\beta_0+\beta_1x_i))^2\]</span></p>
<ul>
<li><em>Theoretical</em>
<ul>
<li>Linear regression provides a <strong>linear</strong> estimate of the conditional expectation function (CEF): <span class="math inline">\(E[Y|X]\)</span></li>
</ul></li>
</ul>
</section></section>
<section>
<section id="conceptual-linear-regression" class="title-slide slide level1 inverse center">
<h1><i class="fa-solid fa-lightbulb" aria-label="lightbulb"></i> Conceptual: Linear Regression</h1>

</section>
<section id="conceptual-linear-regression-1" class="slide level2">
<h2>Conceptual: Linear Regression</h2>
<ul>
<li class="fragment"><p>Regression is a tool for describing relationships.</p>
<ul>
<li class="fragment"><p>How does some outcome we’re interested in tend to change as some predictor of that outcome changes?</p></li>
<li class="fragment"><p>How does economic development vary with democracy?</p>
<ul>
<li class="fragment">Or how does democracy vary with economic development…</li>
</ul></li>
<li class="fragment"><p>How does economic development vary with democracy, adjusting for natural resources like oil and gas</p></li>
</ul></li>
</ul>
</section>
<section id="conceptual-linear-regression-2" class="slide level2 smaller">
<h2>Conceptual: Linear Regression</h2>
<p>More formally:</p>
<p><span class="math display">\[
y_i = f(x_i) + \epsilon
\]</span></p>
<ul>
<li><p>Y is a function of X plus some error, <span class="math inline">\(\epsilon\)</span></p></li>
<li><p>Linear regression assumes that relationship between an outcome and a predictor can be described by a <a href="https://en.wikipedia.org/wiki/Linearity" target="_blank">linear</a> function</p></li>
</ul>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1 x_i + \epsilon
\]</span></p>
</section>
<section id="linear-regression-and-the-line-of-best-fit" class="slide level2 smaller">
<h2>Linear Regression and the Line of Best Fit</h2>
<ul>
<li>The goal of linear regression is to choose coefficients <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> to summarizes the relationship between <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span></li>
</ul>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1 x_i + \epsilon
\]</span></p>
<ul>
<li><p>To accomplish this we need some sort of criteria.</p></li>
<li><p>For linear regression, that criteria is minimizing the error between what our model predicts <span class="math inline">\(\hat{y_i} = \beta_0 + \beta_1 x_i\)</span> and what we actually observed <span class="math inline">\((y_i)\)</span></p></li>
<li><p>More on this to come. But first…</p></li>
</ul>
</section>
<section id="regression-notation" class="slide level2 smaller">
<h2>Regression Notation</h2>
<ul>
<li class="fragment"><p><span class="math inline">\(y_i\)</span> an <strong>outcome variable</strong> or thing we’re trying to explain</p>
<ul>
<li class="fragment">AKA: The dependent variable, The response variable, The left hand side of the model</li>
</ul></li>
<li class="fragment"><p><span class="math inline">\(x_i\)</span> a <strong>predictor variables</strong> or things we think explain variation in our outcome</p>
<ul>
<li class="fragment"><p>AKA: The independent variable, covariates, the right hand side of the model.</p></li>
<li class="fragment"><p>Cap or No Cap: I’ll use <span class="math inline">\(X\)</span> (should be <span class="math inline">\(\mathbf{X}\)</span>) to denote a set (matrix) of predictor variables. <span class="math inline">\(y\)</span> vs <span class="math inline">\(Y\)</span> can also have technical distinctions (Sample vs Population, observed value vs Random Variable, …)</p></li>
</ul></li>
<li class="fragment"><p><span class="math inline">\(\beta\)</span> a set of <strong>unknown parameters</strong> that describe the relationship between our outcome <span class="math inline">\(y_i\)</span> and our predictors <span class="math inline">\(x_i\)</span></p></li>
<li class="fragment"><p><span class="math inline">\(\epsilon_i\)</span> the <strong>error term</strong> representing variation in <span class="math inline">\(y_i\)</span> not explained by our model.</p></li>
<li class="fragment"><p><span class="math inline">\(\hat{\epsilon_i}\)</span> is a residual, or an estimate of the error, given a model.</p></li>
</ul>
</section>
<section id="linear-regression" class="slide level2 smaller">
<h2>Linear Regression</h2>
<ul>
<li>We call this a bivariate regression, because there are only two variables</li>
</ul>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1 x_i + \epsilon_i
\]</span></p>
<ul>
<li><p>We call this a linear regression, because <span class="math inline">\(y_i = \beta_0 + \beta_1 x_i\)</span> is the equation for a line, where:</p>
<ul>
<li><p><span class="math inline">\(\beta_0\)</span> corresponds to the <span class="math inline">\(y\)</span> intercept, or the model’s prediction when <span class="math inline">\(x = 0\)</span>.</p></li>
<li><p><span class="math inline">\(\beta_1\)</span> corresponds to the slope, or how <span class="math inline">\(y\)</span> is predicted to change as <span class="math inline">\(x\)</span> changes.</p></li>
</ul></li>
</ul>
</section>
<section id="linear-regression-1" class="slide level2 smaller">
<h2>Linear Regression</h2>
<ul>
<li>If you find this notation confusing, try plugging in substantive concepts for what <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span> represent</li>
<li>Say we wanted to know how attitudes to transgender people varied with age in the baseline survey from Lab 03.</li>
</ul>
<p>The generic linear model</p>
<p><span class="math display">\[y_i = \beta_0 + \beta_1 x_i + \epsilon_i\]</span></p>
<p>Reflects:</p>
<p><span class="math display">\[\text{Transgender Feeling Thermometer}_i = \beta_0 + \beta_1\text{Age}_i + \epsilon_i\]</span></p>
</section></section>
<section>
<section id="practical-estimating-a-linear-regression" class="title-slide slide level1 inverse center">
<h1><i class="fa-solid fa-lightbulb" aria-label="lightbulb"></i> Practical: Estimating a Linear Regression</h1>

</section>
<section id="practical-estimating-a-linear-regression-1" class="slide level2 smaller">
<h2>Practical: Estimating a Linear Regression</h2>
<ul>
<li>We estimate linear regressions in <code>R</code> using the <code>lm()</code> function.</li>
<li><code>lm()</code> requires two arguments:
<ul>
<li>a <code>formula</code> argument of the general form <code>y ~ x</code> read as “Y modeled by X” or below “Transgender Feeling Thermometer (<code>y</code>) modeled by (<code>~</code>) Age (<code>x</code>)</li>
<li>a <code>data</code> argument telling R where to find the variables in the formula</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a></a><span class="fu">load</span>(<span class="fu">url</span>(<span class="st">"https://pols1600.paultesta.org/files/data/03_lab.rda"</span>))</span>
<span id="cb51-2"><a></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(therm_trans_t0 <span class="sc">~</span> vf_age, <span class="at">data =</span> df)</span>
<span id="cb51-3"><a></a>m1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = therm_trans_t0 ~ vf_age, data = df)

Coefficients:
(Intercept)       vf_age  
    62.8196      -0.2031  </code></pre>
</div>
</div>
</section>
<section id="the-lm-function" class="slide level2 smaller">
<h2>The <code>lm()</code> function</h2>
<p>The coefficients from <code>lm()</code> are saved in object called <code>m1</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a></a>m1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = therm_trans_t0 ~ vf_age, data = df)

Coefficients:
(Intercept)       vf_age  
    62.8196      -0.2031  </code></pre>
</div>
</div>
<p><code>m1</code> actually contains a lot of information</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a></a><span class="fu">names</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "coefficients"  "residuals"     "effects"       "rank"         
 [5] "fitted.values" "assign"        "qr"            "df.residual"  
 [9] "na.action"     "xlevels"       "call"          "terms"        
[13] "model"        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a></a>m1<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)      vf_age 
 62.8195994  -0.2030711 </code></pre>
</div>
</div>
</section>
<section id="practical-interpreting-a-linear-regression" class="slide level2 smaller">
<h2>Practical: Interpreting a Linear Regression</h2>
<p>We can extract the intercept and slope from this simple bivariate model, using the <code>coef()</code> function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a></a><span class="co"># All the coefficients</span></span>
<span id="cb59-2"><a></a><span class="fu">coef</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)      vf_age 
 62.8195994  -0.2030711 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a></a><span class="co"># Just the intercept</span></span>
<span id="cb61-2"><a></a><span class="fu">coef</span>(m1)[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept) 
    62.8196 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a></a><span class="co"># Just the slope</span></span>
<span id="cb63-2"><a></a><span class="fu">coef</span>(m1)[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    vf_age 
-0.2030711 </code></pre>
</div>
</div>
</section>
<section id="practical-interpreting-a-linear-regression-1" class="slide level2 smaller">
<h2>Practical: Interpreting a Linear Regression</h2>
<p>The two coefficients from <code>m1</code> define a line of best fit, summarizing how feelings toward transgender individuals change with age</p>
<p><span class="math display">\[y_i = \beta_0 + \beta_1 x_i + \epsilon_i\]</span></p>
<p><span class="math display">\[\text{Transgender Feeling Thermometer}_i = \beta_0 + \beta_1\text{Age}_i + \epsilon_i\]</span></p>
<p><span class="math display">\[\text{Transgender Feeling Thermometer}_i = 62.82 + -0.2 \text{Age}_i + \epsilon_i\]</span></p>
</section>
<section id="practical-predicted-values-from-a-linear-regression" class="slide level2 smaller">
<h2>Practical: Predicted values from a Linear Regression</h2>
<ul>
<li><p>Often it’s useful for interpretation to obtain <span class="blue">predicted values</span> from a regression.</p></li>
<li><p>To obtain predicted vales <span class="math inline">\((\hat{y})\)</span>, we simply plug in a value for <span class="math inline">\(x\)</span> (In this case, <span class="math inline">\(Age\)</span>) and evaluate our equation.</p></li>
<li><p>For example, might we expect attitudes to differ among an 18-year-old college student and their 68-year-old grandparent?</p></li>
</ul>
<p><span class="math display">\[\hat{FT}_{x=18} = 62.82 + -0.2 \times 18  = 59.16\]</span> <span class="math display">\[\hat{FT}_{x=65} = 62.82 + -0.2 \times 68  = 49.01\]</span></p>
</section>
<section id="practical-predicted-values-from-a-linear-regression-1" class="slide level2">
<h2>Practical: Predicted values from a Linear Regression</h2>
<p>We could do this by hand</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a></a><span class="fu">coef</span>(m1)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">coef</span>(m1)[<span class="dv">2</span>] <span class="sc">*</span> <span class="dv">18</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept) 
   59.16432 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a></a><span class="fu">coef</span>(m1)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">coef</span>(m1)[<span class="dv">2</span>] <span class="sc">*</span> <span class="dv">68</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept) 
   49.01076 </code></pre>
</div>
</div>
</section>
<section id="practical-predicted-values-from-a-linear-regression-2" class="slide level2 smaller">
<h2>Practical: Predicted values from a Linear Regression</h2>
<p>More often we will:</p>
<ul>
<li class="fragment">Make a <span class="blue">prediction data frame</span> (called <code>pred_df</code> below) with the values of interests</li>
<li class="fragment">Use the <code>predict()</code> function with our linear model (<code>m1</code>) and <code>pred_df</code></li>
<li class="fragment">Save the predicted values to our new column in our prediction data frame</li>
</ul>
</section>
<section id="practical-predicted-values-from-a-linear-regression-3" class="slide level2">
<h2>Practical: Predicted values from a Linear Regression</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a></a><span class="co"># Make prediction data frame</span></span>
<span id="cb69-2"><a></a>pred_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb69-3"><a></a>  <span class="at">vf_age =</span> <span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">68</span>)</span>
<span id="cb69-4"><a></a>)</span>
<span id="cb69-5"><a></a><span class="co"># Predict FT for 18 and 68 year-olds</span></span>
<span id="cb69-6"><a></a><span class="fu">predict</span>(m1, <span class="at">newdata =</span> pred_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2 
59.16432 49.01076 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a></a><span class="co"># Save predictions to data frame</span></span>
<span id="cb71-2"><a></a>pred_df<span class="sc">$</span>ft_trans_hat <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1, <span class="at">newdata =</span> pred_df)</span>
<span id="cb71-3"><a></a>pred_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  vf_age ft_trans_hat
1     18     59.16432
2     68     49.01076</code></pre>
</div>
</div>
</section>
<section id="section-3" class="slide level2">
<h2></h2>
<h4 id="practical-visualizing-linear-regression">Practical: Visualizing Linear Regression</h4>
<div class="panel-tabset">
<ul id="tabset-18" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-18-1">Concept</a></li><li><a href="#tabset-18-2">Code</a></li><li><a href="#tabset-18-3">Intercept</a></li><li><a href="#tabset-18-4">Slope</a></li><li><a href="#tabset-18-5">Errors</a></li></ul>
<div class="tab-content">
<div id="tabset-18-1">
<p>We can visualize simple regression by:</p>
<ul>
<li class="fragment"><p>plotting a scatter plot of the outcome (y-axis) and predictors (x-axis)</p></li>
<li class="fragment"><p>overlaying the line defined by <code>lm()</code></p></li>
</ul>
</div>
<div id="tabset-18-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a></a>fig_lm <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb73-2"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(vf_age,therm_trans_t0))<span class="sc">+</span></span>
<span id="cb73-3"><a></a>  <span class="fu">geom_point</span>(<span class="at">size=</span>.<span class="dv">5</span>, <span class="at">alpha=</span>.<span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb73-4"><a></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">coef</span>(m1)[<span class="dv">1</span>],</span>
<span id="cb73-5"><a></a>              <span class="at">slope =</span> <span class="fu">coef</span>(m1)[<span class="dv">2</span>],</span>
<span id="cb73-6"><a></a>              <span class="at">col =</span> <span class="st">"blue"</span></span>
<span id="cb73-7"><a></a>              )<span class="sc">+</span></span>
<span id="cb73-8"><a></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>,<span class="at">linetype =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb73-9"><a></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">100</span>)<span class="sc">+</span></span>
<span id="cb73-10"><a></a>  <span class="fu">annotate</span>(<span class="st">"point"</span>,</span>
<span id="cb73-11"><a></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="fu">coef</span>(m1)[<span class="dv">1</span>],</span>
<span id="cb73-12"><a></a>           <span class="at">col=</span> <span class="st">"red"</span>,</span>
<span id="cb73-13"><a></a>           )<span class="sc">+</span></span>
<span id="cb73-14"><a></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb73-15"><a></a>           <span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(beta[<span class="dv">0</span>],<span class="st">"= 62.81"</span> )),</span>
<span id="cb73-16"><a></a>           <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="fu">coef</span>(m1)[<span class="dv">1</span>]<span class="sc">+</span><span class="dv">5</span>,</span>
<span id="cb73-17"><a></a>           <span class="at">hjust =</span> <span class="st">"left"</span>,</span>
<span id="cb73-18"><a></a>           )<span class="sc">+</span></span>
<span id="cb73-19"><a></a>  <span class="fu">labs</span>(</span>
<span id="cb73-20"><a></a>    <span class="at">x =</span> <span class="st">"Age"</span>,</span>
<span id="cb73-21"><a></a>    <span class="at">y =</span> <span class="st">"Feeling Thermometer toward</span><span class="sc">\n</span><span class="st">Transgender People"</span></span>
<span id="cb73-22"><a></a>  )<span class="sc">+</span></span>
<span id="cb73-23"><a></a>  <span class="fu">theme_classic</span>() <span class="ot">-&gt;</span> fig_lm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-18-3">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05-slides_files/figure-revealjs/fig_lm_plot-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-18-4">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05-slides_files/figure-revealjs/figlm1-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-18-5">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05-slides_files/figure-revealjs/figlm1code-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="technichal-mechanics-of-linear-regression" class="title-slide slide level1 center" data-background-color="lightgrey">
<h1><i class="fa-solid fa-lightbulb" aria-label="lightbulb"></i> Technichal: Mechanics of Linear Regression</h1>

</section>
<section id="how-did-lm-choose-beta_0-and-beta_1" class="slide level2 smaller">
<h2>How did <code>lm()</code> choose <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span></h2>
<ul>
<li><p>P: By minimizing the sum of squared errors, in procedure called Ordinary Least Squares (OLS) regression</p></li>
<li><p>Q: Ok, that’s not really that helpful…</p>
<ul>
<li>What’s an error?</li>
<li>Why would we square and sum them</li>
<li>How do we minimize them.</li>
</ul></li>
</ul>
<p>P: Good questions!</p>
</section>
<section id="whats-an-error-whats-a-residual" class="slide level2 smaller">
<h2>What’s an error? What’s a residual</h2>
<p>Recall an error, <span class="math inline">\(\epsilon_i\)</span>, is the deviation of from an unknown true model</p>
<p><span class="math display">\[
y_i = f(x_i) + \epsilon_i
\]</span></p>
<p>A residual, <span class="math inline">\(\hat{\epsilon_i}\)</span> is an estimate of the error obtained by taking the difference between the observed value of <span class="math inline">\(y_i\)</span> and what our model would predict, <span class="math inline">\(\hat{y_i}\)</span> given some value of <span class="math inline">\(x_i\)</span>. So for a model:</p>
<p><span class="math display">\[y_i=\beta_0+\beta_1 x_{i} + \epsilon_i\]</span></p>
<p>We simply subtract our model’s prediction <span class="math inline">\(\beta_0+\beta_1 x_{i}\)</span> from the observed value, <span class="math inline">\(y_i\)</span></p>
<p><span class="math display">\[\hat{\epsilon_i}=y_i-\hat{y_i}=(Y_i-(\beta_0+\beta_1 x_{i}))\]</span></p>
</section>
<section id="why-are-we-squaring-and-summing-epsilon" class="slide level2 smaller">
<h2>Why are we squaring and summing <span class="math inline">\(\epsilon\)</span></h2>
<p>There are more mathy reasons for this, but at intuitive level, the Sum of Squared Residuals (SSR)</p>
<ul>
<li><p>Squaring <span class="math inline">\(\epsilon\)</span> treats positive and negative residuals equally.</p></li>
<li><p>Summing produces single value summarizing our models overall performance.</p></li>
</ul>
<p>There are other criteria we could use (e.g.&nbsp;minimizing the sum of absolute errors), but SSR has some nice properties</p>
</section>
<section id="how-do-we-minimize-sum-epsilon2" class="slide level2 smaller">
<h2>How do we minimize <span class="math inline">\(\sum \epsilon^2\)</span></h2>
<p>OLS chooses <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> to minimize <span class="math inline">\(\sum \epsilon^2\)</span>, the Sum of Squared Residuals (SSR)</p>
<p><span class="math display">\[\textrm{Find }\hat{\beta_0},\,\hat{\beta_1} \text{ arg min}_{\beta_0, \beta_1} \sum (y_i-(\beta_0+\beta_1x_i))^2\]</span></p>
</section>
<section id="how-did-lm-choose-beta_0-and-beta_1-1" class="slide level2 smaller">
<h2>How did <code>lm()</code> choose <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span></h2>
<p>In an intro stats course, we would walk through the process of finding</p>
<p><span class="math display">\[\textrm{Find }\hat{\beta_0},\,\hat{\beta_1} \text{ arg min}_{\beta_0, \beta_1} \sum (y_i-(\beta_0+\beta_1x_i))^2\]</span> Which involves a little bit of calculus. The big payoff is that</p>
<p><span class="math display">\[\beta_0 = \bar{y} - \beta_1 \bar{x}\]</span> And</p>
<p><span class="math display">\[ \beta_1 = \frac{Cov(x,y)}{Var(x)}\]</span> Which is never quite the epiphany, I think we think it is…</p>
<p>The following slides walk you through the mechanics of this exercise. We’re gonna skip through them in class, but they’re there for your reference</p>
</section>
<section id="how-do-we-minimize-sum-epsilon2-1" class="slide level2 smaller">
<h2>How do we minimize <span class="math inline">\(\sum \epsilon^2\)</span></h2>
<p>To understand what’s going on under the hood, you need a broad understanding of some basic calculus.</p>
<p>The next few slides provide a brief review of derivatives and differential calculus.</p>
</section>
<section id="derivatives" class="slide level2 smaller scrollable">
<h2>Derivatives</h2>
<p>The derivative of <span class="math inline">\(f\)</span> at <span class="math inline">\(x\)</span> is its rate of change at <span class="math inline">\(x\)</span></p>
<ul>
<li>For a line: the slope</li>
<li>For a curve: the slope of a line tangent to the curve</li>
</ul>
<p>You’ll see two notations for derivatives:</p>
<ol type="1">
<li>Leibniz notation:</li>
</ol>
<p><span class="math display">\[
\frac{df}{dx}(x)=\lim_{h\to0}\frac{f(x+h)-f(x)}{(x+h)-x}
\]</span></p>
<ol start="2" type="1">
<li>Lagrange: <span class="math inline">\(f^{\prime}(x)\)</span></li>
</ol>
</section>
<section id="some-useful-facts-about-derivatives" class="slide level2 smaller">
<h2>Some useful facts about derivatives</h2>
<p>Derivative of a constant</p>
<p><span class="math display">\[
f^{\prime}(c)=0
\]</span></p>
<p>Derivative of a line f(x)=2x</p>
<p><span class="math display">\[
f^{\prime}(2x)=2
\]</span></p>
<p>Derivative of <span class="math inline">\(f(x)=x^2\)</span></p>
<p><span class="math display">\[
f^{\prime}(x^2)=2x
\]</span></p>
<p>Chain rule: y= f(g(x)). The derivative of y with respect to x is</p>
<p><span class="math display">\[
\frac{d}{dx}(f(g(x)))=f^{\prime}(g(x))g^{\prime}(x)
\]</span></p>
<p>The derivative of the “outside” times the derivative of the “inside,” remembering that the derivative of the outside function is evaluated at the value of the inside function.</p>
</section>
<section id="finding-a-local-minimum" class="slide level2 smaller">
<h2>Finding a local Minimum</h2>
<p>Local minimum:</p>
<p><span class="math display">\[
f^{\prime}(x)=0 \text{ and } f^{\prime\prime}(x)&gt;0
\]</span></p>

<img data-src="https://copingwithcalculus.com/SecondDeriv1.png" class="r-stretch"><p><a href="https://copingwithcalculus.com/SecondDerivativeTest.html" target="_blank">Source</a></p>
</section>
<section id="partial-derivatives" class="slide level2 smaller">
<h2>Partial derivatives</h2>
<p>Let <span class="math inline">\(f\)</span> be a function of the variables <span class="math inline">\((x, \dots, X_n)\)</span>. The partial derivative of <span class="math inline">\(f\)</span> with respect to <span class="math inline">\(X_i\)</span> is</p>
<p><span class="math display">\[\begin{align*}
\frac{\partial f(x, \dots, X_n)}{\partial X_i}=\lim_{h\to0}\frac{f(x, \dots X_i+h \dots, X_n)-f(x, \dots X_i \dots, X_n)}{h}
\end{align*}\]</span></p>

<img data-src="https://miro.medium.com/max/766/1*dToo8pNrhBmYfwmPLp6WrQ.png" class="r-stretch"><p><a href="https://towardsdatascience.com/linear-regression-detailed-view-ea73175f6e86" target="_blank">Source</a></p>
</section>
<section id="minimizing-the-sum-of-squared-errors" class="slide level2 smaller">
<h2>Minimizing the sum of squared errors</h2>
<p>Our model</p>
<p><span class="math display">\[y_i =\beta_0+\beta_1x_{i}+\epsilon_i\]</span></p>
<p>Finds coefficients <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> to to minimize the sum of squared residuals, <span class="math inline">\(\hat{\epsilon}_i\)</span>:</p>
<p><span class="math display">\[\begin{aligned}
\sum \hat{\epsilon_i}^2 &amp;= \sum (y_i-\beta_0-\beta_1 x_{i})^2
\end{aligned}\]</span></p>
</section>
<section id="minimizing-the-sum-of-squared-errors-1" class="slide level2 smaller">
<h2>Minimizing the sum of squared errors</h2>
<p>We solve for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, by taking the partial derivatives with respect to <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, and setting them equal to zero</p>
<p><span class="math display">\[\begin{aligned}
\frac{\partial \sum \hat{\epsilon_i}^2}{\partial \beta_0} &amp;= -2\sum (y_i-\beta_0-\beta_1 x_{i})=0 &amp; f'(-x^2) = -2x\\
\frac{\partial \sum \hat{\epsilon_i}^2}{\partial\beta_1} &amp;= -2\sum (y_i-\beta_0-\beta_1 x_{i})x_{i}=0 &amp; \text{chain rule}
\end{aligned}\]</span></p>
</section>
<section id="solving-for-beta_0" class="slide level2 smaller">
<h2>Solving for <span class="math inline">\(\beta_0\)</span></h2>
<p>First, we’ll solve for <span class="math inline">\(\beta_0\)</span>, by multiplying both sides by -1/2 and distributing the <span class="math inline">\(\sum\)</span>:</p>
<p><span class="math display">\[\begin{aligned}
0 &amp;= -2\sum (y_i-\beta_0-\beta_1 x_{i})\\
\sum \beta_0 &amp;= \sum y_i - \sum \beta_1 x_{i}\\
N \beta_0 &amp;= \sum y_i -\sum \beta_1 x_{i}\\
\beta_0 &amp;= \frac{\sum y_i}{N} - \frac{\beta_1 \sum x_{i}}{N}\\
\beta_0 &amp;= \bar{y} - \beta_1 \bar{x}
\end{aligned}\]</span></p>
</section>
<section id="solving-for-beta_1" class="slide level2 smaller">
<h2>Solving for <span class="math inline">\(\beta_1\)</span></h2>
<p>Now, we can solve for <span class="math inline">\(\beta_1\)</span> plugging in <span class="math inline">\(\beta_0\)</span>.</p>
<p><span class="math display">\[\begin{aligned}
0 &amp;= -2\sum [(y_i-\beta_0-\beta_1 x_{i})x_{i}]\\
0 &amp;= \sum [y_ix_i-(\bar{y} - \beta_1 \bar{x})x_{i}-\beta_1 x_{i}^2]\\
0 &amp;= \sum [y_ix_i-\bar{y}x_{i} + \beta_1 \bar{x}x_{i}-\beta_1 x_{i}^2]
\end{aligned}\]</span></p>
</section>
<section id="solving-for-beta_1-1" class="slide level2 smaller">
<h2>Solving for <span class="math inline">\(\beta_1\)</span></h2>
<p>Now we’ll rearrange some terms and pull out an <span class="math inline">\(x_{i}\)</span> to get</p>
<p><span class="math display">\[\begin{aligned}
0 &amp;= \sum [(y_i -\bar{y} + \beta_1 \bar{x}-\beta_1 x_{i})x_{i}]
\end{aligned}\]</span></p>
<p>Dividing both sides by <span class="math inline">\(x_{i}\)</span> and distributing the summation, we can isolate <span class="math inline">\(\beta_1\)</span></p>
<p><span class="math display">\[\begin{aligned}
\beta_1 \sum (x_{i}-\bar{x}) &amp;= \sum (y_i -\bar{y})
\end{aligned}\]</span></p>
<p>Dividing by <span class="math inline">\(\sum (x_{i}-\bar{x})\)</span> to get</p>
<p><span class="math display">\[\begin{aligned}
\beta_1  &amp;= \frac{\sum (y_i -\bar{y})}{\sum (x_{i}-\bar{x})}
\end{aligned}\]</span></p>
</section>
<section id="solving-for-beta_1-2" class="slide level2 smaller">
<h2>Solving for <span class="math inline">\(\beta_1\)</span></h2>
<p>Finally, by multiplying by <span class="math inline">\(\frac{(x_{i}-\bar{x})}{(x_{i}-\bar{x})}\)</span> we get</p>
<p><span class="math display">\[\begin{aligned}
\beta_1  &amp;= \frac{\sum (y_i -\bar{y})(x_{i}-\bar{x})}{\sum (\bar{x}-x_{i})^2}
\end{aligned}\]</span></p>
<p>Which has a nice interpretation:</p>
<p><span class="math display">\[\begin{aligned}
\beta_1 &amp;= \frac{Cov(x,y)}{Var(x)}
\end{aligned}\]</span></p>
<p>So the coefficient in a simple linear regression of <span class="math inline">\(Y\)</span> on <span class="math inline">\(X\)</span> is simply the ratio of the covariance between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> over the variance of <span class="math inline">\(X\)</span>. Neat!</p>
</section></section>
<section>
<section id="theoretical-ols-provides-a-linear-estimate-of-cef-eyx" class="title-slide slide level1 inverse center">
<h1><i class="fa-solid fa-lightbulb" aria-label="lightbulb"></i> Theoretical: OLS provides a linear estimate of CEF: E[Y|X]</h1>

</section>
<section id="linear-regression-is-a-many-splendored-thing" class="slide level2 smaller">
<h2>Linear Regression is a many splendored thing</h2>
<p><a href="https://www.timlrx.com/tags/ols" target="_blank">Timothy Lin</a> provides a great overview of the various interpretations/motivations for linear regression.</p>
<ul>
<li class="fragment"><p>A <a href="https://www.timlrx.com/blog/notes-on-regression-ols" target="_blank">least squares estimator</a></p></li>
<li class="fragment"><p>A <a href="https://www.timlrx.com/blog/notes-on-regression-geometry" target="_blank">linear projection</a> of <span class="math inline">\(y\)</span> on the subspace spanned by <span class="math inline">\(X\beta\)</span></p></li>
<li class="fragment"><p>A <a href="https://www.timlrx.com/blog/notes-on-regression-method-of-moments" target="_blank">method of moments estimator</a></p></li>
<li class="fragment"><p>A <a href="https://www.timlrx.com/blog/notes-on-regression-maximum-likelihood" target="_blank">maximum likelihood estimator</a></p></li>
<li class="fragment"><p>A <a href="https://www.timlrx.com/blog/notes-on-regression-singular-vector-decomposition" target="_blank">singular vector decomposition</a></p></li>
<li class="fragment"><p>A <a href="https://www.timlrx.com/blog/notes-on-regression-approximation-of-the-conditional-expectation-function#fn1" target="_blank">linear approximation of the conditional expectation function</a></p></li>
</ul>
</section>
<section id="linear-regression-is-a-many-splendored-thing-1" class="slide level2 smaller">
<h2>Linear Regression is a many splendored thing</h2>
<p><a href="https://www.timlrx.com/tags/ols" target="_blank">Timothy Lin</a> provides a great overview of various interpretations/motivations for linear regression.</p>
<ul>
<li><p>A <a href="https://www.timlrx.com/blog/notes-on-regression-ols" target="_blank">least squares estimator</a></p></li>
<li><p>A <a href="https://www.timlrx.com/blog/notes-on-regression-geometry" target="_blank">linear projection</a> of <span class="math inline">\(y\)</span> on the subspace spanned by <span class="math inline">\(X\beta\)</span></p></li>
<li><p>A <a href="https://www.timlrx.com/blog/notes-on-regression-method-of-moments" target="_blank">method of moments estimator</a></p></li>
<li><p>A <a href="https://www.timlrx.com/blog/notes-on-regression-maximum-likelihood" target="_blank">maximum likelihood estimator</a></p></li>
<li><p>A <a href="https://www.timlrx.com/blog/notes-on-regression-singular-vector-decomposition" target="_blank">singular vector decomposition</a></p></li>
<li><p>A <a href="https://www.timlrx.com/blog/notes-on-regression-approximation-of-the-conditional-expectation-function#fn1" target="_blank"><strong>linear approximation of the conditional expectation function</strong></a></p></li>
</ul>
</section>
<section id="the-conditional-expectation-function" class="slide level2 smaller">
<h2>The Conditional Expectation Function</h2>
<p>Of all the functions we could choose to describe the relationship between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span>,</p>
<p><span class="math display">\[
Y_i = f(X_i) + \epsilon_i
\]</span></p>
<p>the conditional expectation of <span class="math inline">\(Y\)</span> given <span class="math inline">\(X\)</span> <span class="math inline">\((E[Y|X])\)</span>, has some appealing properties</p>
<p><span class="math display">\[
Y_i = E[Y_i|X_i] + \epsilon
\]</span></p>
<p>The error, by definition, is uncorrelated with X and <span class="math inline">\(E[\epsilon|X]=0\)</span></p>
<p><span class="math display">\[
E[\epsilon|X] = E[Y - E[Y|X]|X]= E[Y|X] - E[Y|X] = 0
\]</span></p>
<p>Of all the possible functions <span class="math inline">\(g(X)\)</span>, we can show that <span class="math inline">\(E[Y_i|X_i]\)</span> is the best predictor in terms of minimizing <strong>mean squared error</strong></p>
<p><span class="math display">\[
E[ (Y - g(Y))^2] \geq E[(Y - E[Y|X])^2]
\]</span></p>
</section>
<section id="section-4" class="slide level2 smaller">
<h2></h2>
<h4 id="linear-approximations-to-the-conditional-expectation-function">Linear Approximations to the Conditional Expectation Function</h4>
<div class="panel-tabset">
<ul id="tabset-19" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-19-1">Concept</a></li><li><a href="#tabset-19-2">CEF</a></li><li><a href="#tabset-19-3">OLS</a></li></ul>
<div class="tab-content">
<div id="tabset-19-1">
<ul>
<li>We can then show (in a different class) that linear regression provides the best linear predictor of the CEF
<ul>
<li>Chapter 3, of <a href="https://bruknow.library.brown.edu/permalink/01BU_INST/9mvq88/alma991028523169706966" target="_blank">Mostly Harmless Econometrics</a></li>
<li>Chapter 4 of <a href="https://bruknow.library.brown.edu/permalink/01BU_INST/9mvq88/alma991000736119706966" target="_blank">Foundations of Agnostic Statistics</a></li>
</ul></li>
<li>Furthermore, when the CEF is linear, it’s equal exactly to OLS regression</li>
</ul>
</div>
<div id="tabset-19-2">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05-slides_files/figure-revealjs/cef1code-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-19-3">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05-slides_files/figure-revealjs/cef2code-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="what-you-need-to-know-about-regression" class="slide level2 smaller">
<h2>What you need to know about Regression</h2>
<ul>
<li><strong>Conceptual</strong>
<ul>
<li>Simple linear regression estimates a line of best fit that summarizes relationships between two variables</li>
</ul></li>
</ul>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1x_i + \epsilon_i
\]</span></p>
<ul>
<li><strong>Practical</strong>
<ul>
<li>We estimate linear models in R using the <code>lm()</code> function</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a></a><span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="what-you-need-to-know-about-regression-1" class="slide level2 smaller">
<h2>What you need to know about Regression</h2>
<ul>
<li><em>Technical/Definitional</em>
<ul>
<li>Linear regression chooses <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> to minimize the Sum of Squared Residuals (SSR):</li>
</ul></li>
</ul>
<p><span class="math display">\[\textrm{Find }\hat{\beta_0},\,\hat{\beta_1} \text{ arg min}_{\beta_0, \beta_1} \sum (y_i-(\beta_0+\beta_1x_i))^2\]</span></p>
<ul>
<li><em>Theoretical</em>
<ul>
<li>Linear regression provides a <strong>linear</strong> estimate of the conditional expectation function (CEF): <span class="math inline">\(E[Y|X]\)</span></li>
</ul></li>
</ul>
</section></section>
<section>
<section id="difference-in-differences" class="title-slide slide level1 inverse center">
<h1><i class="fa-solid fa-lightbulb" aria-label="lightbulb"></i> Difference-in-Differences</h1>

</section>
<section id="motivating-example-what-causes-cholera" class="slide level2 smaller" data-background-image="https://www.finebooksmagazine.com/sites/default/files/styles/gallery_item/public/media-images/2020-11/map-lead-4.jpg?h=2ded5a3f&amp;itok=Mn-K5rQc," data-background-opacity=".3">
<h2>Motivating Example: What causes Cholera?</h2>
<ul>
<li class="fragment"><p>In the 1800s, cholera was thought to be transmitted through the air.</p></li>
<li class="fragment"><p>John Snow (the physician, not the snack), to explore the origins eventunally concluding that cholera was transmitted through living organisms in water.</p></li>
<li class="fragment"><p>Leveraged a <strong>natural experiment</strong> in which one water company in London moved its pipes further upstream (reducing contamination for Lambeth), while other companies kept their pumps serving Southwark and Vauxhall in the same location.</p></li>
</ul>
</section>
<section id="notation" class="slide level2 smaller">
<h2>Notation</h2>
<p>Let’s adopt a little notation to help us think about the logic of Snow’s design:</p>
<ul>
<li class="fragment"><p><span class="math inline">\(D\)</span>: treatment indicator, 1 for treated neighborhoods (Lambeth), 0 for control neighborhoods (Southwark and Vauxhall)</p></li>
<li class="fragment"><p><span class="math inline">\(T\)</span>: period indicator, 1 if post treatment (1854), 0 if pre-treatment (1849).</p></li>
<li class="fragment"><p><span class="math inline">\(Y_{di}(t)\)</span> the potential outcome of unit <span class="math inline">\(i\)</span></p>
<ul>
<li class="fragment"><p><span class="math inline">\(Y_{1i}(t)\)</span> the potential outcome of unit <span class="math inline">\(i\)</span> when treated between the two periods</p></li>
<li class="fragment"><p><span class="math inline">\(Y_{0i}(t)\)</span> the potential outcome of unit <span class="math inline">\(i\)</span> when control between the two periods</p></li>
</ul></li>
</ul>
</section>
<section id="causal-effects" class="slide level2 smaller">
<h2>Causal Effects</h2>
<p>The individual causal effect for unit i at time t is:</p>
<p><span class="math display">\[\tau_{it} = Y_{1i}(t) − Y_{0i}(t)\]</span></p>
<p>What we observe is</p>
<p><span class="math display">\[Y_i(t) = Y_{0i}(t)\cdot(1 − D_i(t)) + Y_{1i}(t)\cdot D_i(t)\]</span></p>
<p><span class="math inline">\(D\)</span> only equals 1, when <span class="math inline">\(T\)</span> equals 1, so we never observe <span class="math inline">\(Y_0i(1)\)</span> for the treated units.</p>
<p>In words, we don’t know what Lambeth’s outcome would have been in the second period, had they not been treated.</p>
</section>
<section id="average-treatment-on-treated" class="slide level2 smaller">
<h2>Average Treatment on Treated</h2>
<p>Our goal is to estimate the average effect of treatment on treated (ATT):</p>
<p><span class="math display">\[\tau_{ATT} = E[Y_{1i}(1) -  Y_{0i}(1)|D=1]\]</span></p>
<p>That is, what would have happened in Lambeth, had their water company not moved their pipes</p>
</section>
<section id="average-treatment-on-treated-1" class="slide level2 smaller">
<h2>Average Treatment on Treated</h2>
<p>Our goal is to estimate the average effect of treatment on treated (ATT):</p>
<p>We we can observe is:</p>
<table class="caption-top">
<colgroup>
<col style="width: 25%">
<col style="width: 50%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>Pre-Period (T=0)</th>
<th>Post-Period (T=1)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Treated <span class="math inline">\(D_{i}=1\)</span></td>
<td><span class="math inline">\(E[Y_{0i}(0)\vert D_i = 1]\)</span></td>
<td><span class="math inline">\(E[Y_{1i}(1)\vert D_i = 1]\)</span></td>
</tr>
<tr class="even">
<td>Control <span class="math inline">\(D_i=0\)</span></td>
<td><span class="math inline">\(E[Y_{0i}(0)\vert D_i = 0]\)</span></td>
<td><span class="math inline">\(E[Y_{0i}(1)\vert D_i = 0]\)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="data" class="slide level2 smaller">
<h2>Data</h2>
<p>Because potential outcomes notation is abstract, let’s consider a modified description of the Snow’s cholera death data from <a href="https://mixtape.scunning.com/difference-in-differences.html" target="_blank">Scott Cunningham</a>:</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Company</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">1849 (T=0)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">1854 (T=1)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Lambeth (D=1)</td>
<td style="text-align: right;">85</td>
<td style="text-align: right;">19</td>
</tr>
<tr class="even">
<td style="text-align: left;">Southwark and Vauxhall (D=0)</td>
<td style="text-align: right;">135</td>
<td style="text-align: right;">147</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="how-can-we-estimate-the-effect-of-moving-pumps-upstream" class="slide level2 smaller">
<h2>How can we estimate the effect of moving pumps upstream?</h2>
<p>Recall, our goal is to estimate the effect of the the treatment on the treated:</p>
<p><span class="math display">\[\tau_{ATT} = E[Y_{1i}(1) -  Y_{0i}(1)|D=1]\]</span></p>
<p>Let’s conisder some strategies Snow could take to estimate this quantity:</p>
</section>
<section id="before-vs-after-comparisons" class="slide level2 smaller">
<h2>Before vs after comparisons:</h2>
<ul>
<li><p>Snow could have compared Labmeth in 1854 <span class="math inline">\((E[Y_i(1)|D_i = 1] = 19)\)</span> to Lambeth in 1849 <span class="math inline">\((E[Y_i(0)|D_i = 1]=85)\)</span>, and claimed that moving the pumps upstream led to <strong>66 fewer cholera deaths.</strong></p></li>
<li><p>Assumes Lambeth’s pre-treatment outcomes in 1849 are a good proxy for what its outcomes would have been in 1954 if the pumps hadn’t moved <span class="math inline">\((E[Y_{0i}(1)|D_i = 1])\)</span>.</p></li>
<li><p>A skeptic might argue that Lambeth in 1849 <span class="math inline">\(\neq\)</span> Lambeth in 1854</p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top" data-quarto-postprocess="true" style="margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Company</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">1849 (T=0)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">1854 (T=1)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold; color: blue !important;">Lambeth (D=1)</td>
<td style="text-align: right; font-weight: bold; color: blue !important;">85</td>
<td style="text-align: right; font-weight: bold; color: blue !important;">19</td>
</tr>
<tr class="even">
<td style="text-align: left;">Southwark and Vauxhall (D=0)</td>
<td style="text-align: right;">135</td>
<td style="text-align: right;">147</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="treatment-control-comparisons-in-the-post-period." class="slide level2 smaller">
<h2>Treatment-Control comparisons in the Post Period.</h2>
<ul>
<li><p>Snow could have compared outcomes between Lambeth and S&amp;V in 1954 (<span class="math inline">\(E[Yi(1)|Di = 1] − E[Yi(1)|Di = 0]\)</span>), concluding that the change in pump locations led to <strong>128 fewer deaths.</strong></p></li>
<li><p>Here the assumption is that the outcomes in S&amp;V and in 1854 provide a good proxy for what would have happened in Lambeth in 1954 had the pumps not been moved <span class="math inline">\((E[Y_{0i}(1)|D_i = 1])\)</span></p></li>
<li><p>Again, our skeptic could argue Lambeth <span class="math inline">\(\neq\)</span> S&amp;V</p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top" data-quarto-postprocess="true" style="margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Company</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">1849 (T=0)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">1854 (T=1)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Lambeth (D=1)</td>
<td style="text-align: right;">85</td>
<td style="text-align: right; font-weight: bold; color: red !important;">19</td>
</tr>
<tr class="even">
<td style="text-align: left;">Southwark and Vauxhall (D=0)</td>
<td style="text-align: right;">135</td>
<td style="text-align: right; font-weight: bold; color: red !important;">147</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="difference-in-differences-1" class="slide level2 smaller">
<h2>Difference in Differences</h2>
<p>To address these concerns, Snow employed what we now call a <span class="blue">difference-in-differences</span> design,</p>
<p>There are two, equivalent ways to view this design.</p>
<p><span class="math display">\[\underbrace{\{E[Y_{i}(1)|D_{i} = 1] − E[Y_{i}(1)|D_{i} = 0]\}}_{\text{1. Treat-Control |Post }}− \overbrace{\{E[Y_{i}(0)|D_{i} = 1] − E[Y_{i}(0)|D_{i}=0 ]}^{\text{Treated-Control|Pre}}\]</span></p>
<ul>
<li><p>Difference 1: Average change between Treated and Control in Post Period</p></li>
<li><p>Difference 2: Average change between Treated and Control in Pre Period</p></li>
</ul>
</section>
<section id="difference-in-differences-2" class="slide level2 smaller">
<h2>Difference in Differences</h2>
<p><span class="math display">\[\underbrace{\{E[Y_{i}(1)|D_{i} = 1] − E[Y_{i}(1)|D_{i} = 0]\}}_{\text{1. Treat-Control |Post }}− \overbrace{\{E[Y_{i}(0)|D_{i} = 1] − E[Y_{i}(0)|D_{i}=0 ]}^{\text{Treated-Control|Pre}}\]</span> Is equivalent to:</p>
<p><span class="math display">\[\underbrace{\{E[Y_{i}(1)|D_{i} = 1] − E[Y_{i}(0)|D_{i} = 1]\}}_{\text{Post - Pre |Treated }}− \overbrace{\{E[Y_{i}(1)|D_{i} = 0] − E[Y_{i}(0)|D_{i}=0 ]}^{\text{Post-Pre|Control}}\]</span></p>
<ul>
<li>Difference 1: Average change between Treated over time</li>
<li>Difference 2: Average change between Control over time</li>
</ul>
</section>
<section id="difference-in-differences-3" class="slide level2 smaller">
<h2>Difference in Differences</h2>
<p>You’ll see the DiD design represented both ways, but they produce the same result:</p>
<p><span class="math display">\[
\tau_{ATT} = (19-147) - (85-135) = -78
\]</span></p>
<p><span class="math display">\[
\tau_{ATT} = (19-85) - (147-135) = -78
\]</span></p>
</section>
<section id="identifying-assumption-of-a-difference-in-differences-design" class="slide level2 smaller">
<h2>Identifying Assumption of a Difference in Differences Design</h2>
<p>The key assumption in this design is what’s known as the parallel trends assumption: <span class="math inline">\(E[Y_{0i}(1) − Y_{0i}(0)|D_i = 1] = E[Y_{0i}(1) − Y_{0i}(0)|D_i = 0]\)</span></p>
<ul>
<li class="fragment">In words: If Lambeth hadn’t moved its pumps, it would have followed a similar path as S&amp;V</li>
</ul>
</section>
<section id="parralel-trends" class="slide level2">
<h2>Parralel Trends</h2>

<img data-src="05-slides_files/figure-revealjs/paralleltrends-1.png" width="960" class="r-stretch"></section>
<section id="using-linear-regression-to-estimate-a-difference-in-difference" class="slide level2 smaller">
<h2>Using linear regression to estimate a Difference in Difference</h2>
<div class="panel-tabset">
<ul id="tabset-20" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-20-1">Concept</a></li><li><a href="#tabset-20-2">Code</a></li><li><a href="#tabset-20-3">Data</a></li><li><a href="#tabset-20-4">DiD</a></li><li><a href="#tabset-20-5">Figure</a></li></ul>
<div class="tab-content">
<div id="tabset-20-1">
<ul>
<li class="fragment">Recall that linear regression provides a…
<ul>
<li class="fragment">linear estimate of the conditional expectation function</li>
</ul></li>
<li class="fragment">In the canonincal pre-post, treated and control DiD, <span class="math inline">\(\beta_3\)</span> from the following linear regression will give us the ATT:</li>
</ul>
<div class="fragment">
<p><span class="math display">\[
y = \beta_0 + \beta_1 Post + \beta_2 Treated + \underbrace{\beta_3Post\times Treated}_{\tau_{ATT}}
\]</span></p>
</div>
</div>
<div id="tabset-20-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a></a>cholera_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb75-2"><a></a>  <span class="at">Period =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"Pre"</span>,<span class="st">"Pre"</span>,<span class="st">"Post"</span>,<span class="st">"Post"</span>),</span>
<span id="cb75-3"><a></a>                  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Pre"</span>,<span class="st">"Post"</span>)),</span>
<span id="cb75-4"><a></a>  <span class="at">Year =</span> <span class="fu">c</span>(<span class="dv">1849</span>,<span class="dv">1849</span>, <span class="dv">1854</span>,<span class="dv">1854</span>),</span>
<span id="cb75-5"><a></a>  <span class="at">Treated =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"Control"</span>,<span class="st">"Treated"</span>,<span class="st">"Control"</span>,<span class="st">"Treated"</span>)),</span>
<span id="cb75-6"><a></a>  <span class="at">Company =</span> <span class="fu">c</span>(<span class="st">"S&amp;V"</span>,<span class="st">"Lambeth"</span>,<span class="st">"S&amp;V"</span>,<span class="st">"Lambeth"</span>),</span>
<span id="cb75-7"><a></a>  <span class="at">Deaths =</span> <span class="fu">c</span>(<span class="dv">135</span>,<span class="dv">85</span>,<span class="dv">147</span>,<span class="dv">19</span>)</span>
<span id="cb75-8"><a></a>)</span>
<span id="cb75-9"><a></a></span>
<span id="cb75-10"><a></a>m_did <span class="ot">&lt;-</span> <span class="fu">lm</span>(Deaths<span class="sc">~</span>Period <span class="sc">+</span> Treated <span class="sc">+</span> Period<span class="sc">:</span>Treated, cholera_df)</span>
<span id="cb75-11"><a></a></span>
<span id="cb75-12"><a></a>m_did</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Deaths ~ Period + Treated + Period:Treated, data = cholera_df)

Coefficients:
              (Intercept)                 PeriodPost  
                      135                         12  
           TreatedTreated  PeriodPost:TreatedTreated  
                      -50                        -78  </code></pre>
</div>
</div>
</div>
<div id="tabset-20-3">
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-dd4823e11579ab285b5c" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-dd4823e11579ab285b5c">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4"],["Pre","Pre","Post","Post"],[1849,1849,1854,1854],["Control","Treated","Control","Treated"],["S&amp;V","Lambeth","S&amp;V","Lambeth"],[135,85,147,19]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Period<\/th>\n      <th>Year<\/th>\n      <th>Treated<\/th>\n      <th>Company<\/th>\n      <th>Deaths<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Period","targets":1},{"name":"Year","targets":2},{"name":"Treated","targets":3},{"name":"Company","targets":4},{"name":"Deaths","targets":5}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-20-4">
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;">
<caption>
Statistical models
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
&nbsp;
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Model 1
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
(Intercept)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
135.00
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Post (1854)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
12.00
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Treated (Lambeth)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-50.00
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Post X Treated (DID)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-78.00
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
R<sup>2</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1.00
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Adj. R<sup>2</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
&nbsp;
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
4
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="2">
<sup>***</sup>p &lt; 0.001; <sup>**</sup>p &lt; 0.01; <sup>*</sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
</div>
<div id="tabset-20-5">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05-slides_files/figure-revealjs/didfig-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="summary" class="slide level2 smaller">
<h2>Summary</h2>
<ul>
<li class="fragment"><p>A Difference in Differences (DiD, or diff-in-diff) design combines a pre-post comparison, with a treated and control comparison</p>
<ul>
<li class="fragment"><p>Taking the pre-post difference removes any fixed differences between the units</p></li>
<li class="fragment"><p>Then taking the difference between treated and control differences removes any common differences over time</p></li>
</ul></li>
<li class="fragment"><p>The key identifying assumption of a DiD design is the “assumption of parallel trends”</p>
<ul>
<li class="fragment">Absent treatment, treated and control groups would see the same changes over time.</li>
<li class="fragment">Hard to prove, possible to test</li>
</ul></li>
</ul>
</section>
<section id="extensions-and-limitations" class="slide level2 smaller">
<h2>Extensions and limitations</h2>
<ul>
<li class="fragment">Diff-in-Diff easy to estimate with linear regression</li>
<li class="fragment">Generalizes to multiple periods and treatment interventions
<ul>
<li class="fragment">More pre-treatment periods allow you assess “parallel trends” assumption</li>
</ul></li>
<li class="fragment">Alternative methods
<ul>
<li class="fragment">Synthetic control</li>
<li class="fragment">Event Study Designs</li>
</ul></li>
<li class="fragment">What if you have multiple treatments or treatments that come and go?
<ul>
<li class="fragment">Panel Matching</li>
<li class="fragment">Generalized Synthetic control</li>
</ul></li>
</ul>
</section>
<section id="applications" class="slide level2 smaller">
<h2>Applications</h2>
<ul>
<li class="fragment"><p><a href="https://www.nber.org/papers/w4509" target="_blank">Card and Krueger (1994)</a> What effect did raising the minimum wage in NJ have on employment</p></li>
<li class="fragment"><p><a href="https://onlinelibrary.wiley.com/doi/full/10.1111/ajps.12116?casa_token=_ceCu4SwzTEAAAAA%3AP9aeaZpT_Zh1VdWKXx_tEmzaJTtMJ1n0eG7EaYlvJZYN000re33cfMAI2O8N8htFJjOsln2GyVeQql4" target="_blank">Abadie, Diamond, &amp; Hainmueller (2014)</a> What effect did German Unification have on economic development in West Germany</p></li>
<li class="fragment"><p><a href="https://www.cambridge.org/core/journals/american-political-science-review/article/impact-of-recentralization-on-public-services-a-differenceindifferences-analysis-of-the-abolition-of-elected-councils-in-vietnam/3477854BAAFE152DC93C594169D64F58" target="_blank">Malesky, Nguyen and Tran (2014)</a> How does decentralization influence public services?</p></li>
</ul>
</section>
<section id="references" class="slide level2 smaller scrollable">
<h2>References</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Blair2023-yg" class="csl-entry" role="listitem">
Blair, Graeme, Alexander Coppock, and Macartan Humphreys. 2023. <em><span class="nocase">Research Design in the Social Sciences: Declaration, Diagnosis, and Redesign</span></em>. Princeton University Press.
</div>
</div>
</section></section>

    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="images/pols1600_hex.png" class="slide-logo"></p>
<div class="footer footer-default">
<p>POLS 1600</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>