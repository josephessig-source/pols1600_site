<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Your Name Here">
<meta name="dcterms.date" content="2024-05-12">

<title>POLS 1600 Take Home Final – POLS 1600</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-1cfdd6bcdaa40fc01831c1af7ce94cf5.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">POLS 1600</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../class/index.html"> 
<span class="menu-text">Class</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../assignments/index.html"> 
<span class="menu-text">Assignments</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul class="collapse">
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#causal-inference-20-points" id="toc-causal-inference-20-points" class="nav-link" data-scroll-target="#causal-inference-20-points"><span class="header-section-number">1</span> Causal Inference (20 points)</a>
  <ul class="collapse">
  <li><a href="#what-is-the-fundamental-problem-of-causal-inference-3-points" id="toc-what-is-the-fundamental-problem-of-causal-inference-3-points" class="nav-link" data-scroll-target="#what-is-the-fundamental-problem-of-causal-inference-3-points"><span class="header-section-number">1.1</span> What is the fundamental problem of causal inference? (3 points)</a></li>
  <li><a href="#how-does-random-assignment-help-solve-this-fundamental-problem-3-points" id="toc-how-does-random-assignment-help-solve-this-fundamental-problem-3-points" class="nav-link" data-scroll-target="#how-does-random-assignment-help-solve-this-fundamental-problem-3-points"><span class="header-section-number">1.2</span> How does random assignment help solve this fundamental problem? (3 points)</a></li>
  <li><a href="#whats-the-difference-between-an-observational-and-experimental-design-4-points" id="toc-whats-the-difference-between-an-observational-and-experimental-design-4-points" class="nav-link" data-scroll-target="#whats-the-difference-between-an-observational-and-experimental-design-4-points"><span class="header-section-number">1.3</span> What’s the difference between an observational and experimental design? (4 points)</a></li>
  <li><a href="#explain-the-logic-of-a-difference-in-differences-design-10-points" id="toc-explain-the-logic-of-a-difference-in-differences-design-10-points" class="nav-link" data-scroll-target="#explain-the-logic-of-a-difference-in-differences-design-10-points"><span class="header-section-number">1.4</span> Explain the logic of a difference-in-differences design? (10 points)</a></li>
  </ul></li>
  <li><a href="#linear-models-20-points" id="toc-linear-models-20-points" class="nav-link" data-scroll-target="#linear-models-20-points"><span class="header-section-number">2</span> Linear Models (20 points)</a>
  <ul class="collapse">
  <li><a href="#what-is-a-linear-regression-and-why-is-it-useful-5-points" id="toc-what-is-a-linear-regression-and-why-is-it-useful-5-points" class="nav-link" data-scroll-target="#what-is-a-linear-regression-and-why-is-it-useful-5-points"><span class="header-section-number">2.1</span> What is a linear regression and why is it useful? (5 points)</a></li>
  <li><a href="#what-does-it-mean-to-control-for-a-variable-in-a-multiple-regression-5-points" id="toc-what-does-it-mean-to-control-for-a-variable-in-a-multiple-regression-5-points" class="nav-link" data-scroll-target="#what-does-it-mean-to-control-for-a-variable-in-a-multiple-regression-5-points"><span class="header-section-number">2.2</span> What does it mean to control for a variable in a multiple regression? (5 points)</a></li>
  <li><a href="#interpreting-regression-models-10-points" id="toc-interpreting-regression-models-10-points" class="nav-link" data-scroll-target="#interpreting-regression-models-10-points"><span class="header-section-number">2.3</span> Interpreting regression models (10 points)</a></li>
  </ul></li>
  <li><a href="#statistical-inference-20-points" id="toc-statistical-inference-20-points" class="nav-link" data-scroll-target="#statistical-inference-20-points"><span class="header-section-number">3</span> Statistical Inference (20 points)</a>
  <ul class="collapse">
  <li><a href="#what-is-a-confidence-interval-10-points" id="toc-what-is-a-confidence-interval-10-points" class="nav-link" data-scroll-target="#what-is-a-confidence-interval-10-points"><span class="header-section-number">3.1</span> What is a confidence interval? (10 points)</a></li>
  <li><a href="#what-is-a-hypothesis-test-10-points" id="toc-what-is-a-hypothesis-test-10-points" class="nav-link" data-scroll-target="#what-is-a-hypothesis-test-10-points"><span class="header-section-number">3.2</span> What is a hypothesis test? (10 points)</a></li>
  </ul></li>
  <li><a href="#applied-empirical-analysis-40-points" id="toc-applied-empirical-analysis-40-points" class="nav-link" data-scroll-target="#applied-empirical-analysis-40-points"><span class="header-section-number">4</span> Applied Empirical Analysis (40 points)</a>
  <ul class="collapse">
  <li><a href="#look-at-and-recode-the-data-10-points" id="toc-look-at-and-recode-the-data-10-points" class="nav-link" data-scroll-target="#look-at-and-recode-the-data-10-points"><span class="header-section-number">4.1</span> Look at and recode the data (10 points)</a></li>
  <li><a href="#produce-a-table-of-descriptive-statistics-10-points" id="toc-produce-a-table-of-descriptive-statistics-10-points" class="nav-link" data-scroll-target="#produce-a-table-of-descriptive-statistics-10-points"><span class="header-section-number">4.2</span> Produce a table of descriptive statistics (10 points)</a></li>
  <li><a href="#estimtate-three-models-5-points" id="toc-estimtate-three-models-5-points" class="nav-link" data-scroll-target="#estimtate-three-models-5-points"><span class="header-section-number">4.3</span> Estimtate three models (5 points)</a></li>
  <li><a href="#present-and-interperet-your-results-15-points" id="toc-present-and-interperet-your-results-15-points" class="nav-link" data-scroll-target="#present-and-interperet-your-results-15-points"><span class="header-section-number">4.4</span> Present and interperet your results (15 points)</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">POLS 1600 Take Home Final</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Your Name Here </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 12, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="overview" class="level1 unnumbered">
<h1 class="unnumbered">Overview</h1>
<p>This document provides your final exam for POLS 1600.</p>
<p>The exam consists of four parts corresponding to core concepts and skills from POLS 1600:</p>
<ul>
<li>Causal Inference (20 Points)</li>
<li>Interpreting Linear Models (20 points)</li>
<li>Quantifying Uncertainty through Statistical Inference (20 points)</li>
<li>Conducting applied empirical analysis (40 points)</li>
</ul>
<p>Each section contains a series of conceptual questions, and or coding tasks for your to accomplish.</p>
<p>You will write your answers to these questions and tasks in this Rmd file.</p>
<p>You will <strong>submit the html file</strong> produced by this .Rmd file on <strong><a href="https://canvas.brown.edu/courses/1094972/assignments/7981746">on Canvas by May 12, 11:59 pm.</a></strong></p>
<p>Exams submitted after May 12 will automatically lose 10 points for each late day.</p>
<p>If you submit the <code>qmd</code> file instead of the <code>html</code> file you will lose 5 points from your exam grade.</p>
<p>If you like, I will meet with you by Zoom or in person for 30 minutes to answer general questions about material from the course. I will not answer specific questions from the exam.</p>
<p>This exam is designed to test <strong>your knowledge and understanding</strong> of concepts and skills from the course. You can and should make use of material from lectures and labs, but if I find evidence of plagiarism (copying and pasting answers verbatim from Google or ChatGPT), I will initiate plagiarism procedures described in Brown’s <a href="https://college.brown.edu/sites/g/files/dprerj916/files/2022-04/Academic-Code.pdf">Academic Code</a></p>
</section>
<section id="causal-inference-20-points" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Causal Inference (20 points)</h1>
<section id="what-is-the-fundamental-problem-of-causal-inference-3-points" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="what-is-the-fundamental-problem-of-causal-inference-3-points"><span class="header-section-number">1.1</span> What is the fundamental problem of causal inference? (3 points)</h2>
<ul>
<li>Please frame your answer in terms of potential outcomes and counterfactual comparisons</li>
</ul>
</section>
<section id="how-does-random-assignment-help-solve-this-fundamental-problem-3-points" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="how-does-random-assignment-help-solve-this-fundamental-problem-3-points"><span class="header-section-number">1.2</span> How does random assignment help solve this fundamental problem? (3 points)</h2>
<ul>
<li>Please discuss the concepts of statistical independence and average treatment effects.</li>
</ul>
</section>
<section id="whats-the-difference-between-an-observational-and-experimental-design-4-points" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="whats-the-difference-between-an-observational-and-experimental-design-4-points"><span class="header-section-number">1.3</span> What’s the difference between an observational and experimental design? (4 points)</h2>
<ul>
<li><p>Who or what determines the presence of some causal factor</p></li>
<li><p>Which the strengths and weaknesses of each design</p></li>
</ul>
</section>
<section id="explain-the-logic-of-a-difference-in-differences-design-10-points" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="explain-the-logic-of-a-difference-in-differences-design-10-points"><span class="header-section-number">1.4</span> Explain the logic of a difference-in-differences design? (10 points)</h2>
<ul>
<li><p>Describe the basic logic of the design</p></li>
<li><p>Explain the key identifying assumptions of the design</p></li>
<li><p>Discuss some testable implications of these assumptions</p></li>
</ul>
</section>
</section>
<section id="linear-models-20-points" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Linear Models (20 points)</h1>
<section id="what-is-a-linear-regression-and-why-is-it-useful-5-points" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="what-is-a-linear-regression-and-why-is-it-useful-5-points"><span class="header-section-number">2.1</span> What is a linear regression and why is it useful? (5 points)</h2>
<p>In your answer, please discuss:</p>
<ul>
<li><p>The basic goals and intuitions that motivate linear regression</p></li>
<li><p>The mechanics of ordinary least squares regression</p></li>
<li><p>The relationship between linear regression and the Conditional Expectation Function</p></li>
</ul>
</section>
<section id="what-does-it-mean-to-control-for-a-variable-in-a-multiple-regression-5-points" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="what-does-it-mean-to-control-for-a-variable-in-a-multiple-regression-5-points"><span class="header-section-number">2.2</span> What does it mean to control for a variable in a multiple regression? (5 points)</h2>
<p>In your answer, please explain:</p>
<ul>
<li><p>Why would we want to control for covariates?</p></li>
<li><p>How linear regression accomplishes this</p></li>
<li><p>What covariates we want to control for</p></li>
<li><p>What covariates we shouldn’t control for</p></li>
</ul>
</section>
<section id="interpreting-regression-models-10-points" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="interpreting-regression-models-10-points"><span class="header-section-number">2.3</span> Interpreting regression models (10 points)</h2>
<p>Suppose we are interested in understanding partisan differences in vaccination rates.</p>
<p>Our outcome is a binary indicator which takes a value of 1 if someone was vaccinated, and 0 otherwise.</p>
<p>Our key predictor of interest people’s self-reported partisanship, measured with a 7-point scale where (1 = Strong Democrat, 2 = Democrat, 3 Independent who leans Democratic, 4 = Independent who leans Republican, 5 = Republican, and 7 = Strong Republican)</p>
<p>Please answer the following:</p>
<ol type="1">
<li>Suppose we expect Republicans are less likely to be vaccinated.</li>
</ol>
<ul>
<li>Specify a bivariate model predicting vaccination status with partisanship, measured by a 7-point scale to test this expectation (ie fill in the ??? in the equation below):</li>
</ul>
<p><span class="math display">\[\text{???} = \beta_0 + \beta_1 \times \text{???} + \epsilon\]</span></p>
<ul>
<li><p>If your expectations are correct, what is the expected sign and significance of the coefficient on <span class="math inline">\(\beta_1\)</span></p></li>
<li><p>How should we interpret <span class="math inline">\(\beta_0\)</span> in this model?</p></li>
</ul>
<ol start="2" type="1">
<li><p>Suppose we find the expected relationship in our bivariate model. Suppose a skeptic sees your results and says:</p>
<p>“You claim differences in vaccination rates are a function of partisanship, I think this is really just a matter of geography. Republicans are more likely to live in rural areas. Vaccines were less available in rural areas and the pandemic was less severe.”</p></li>
</ol>
<p>To address the skeptics concerns, you estimate a second model “controlling for geography” with a binary indicator of whether someone lives in a rural setting (rural = 1) or not (rural = 0)</p>
<ul>
<li>Specify a multiple regression model predicting vaccination status with partisanship and an indicator of whether someone lives in a rural setting.</li>
</ul>
<p><span class="math display">\[\text{???} = \beta_0 + \beta_1 \times \text{???} + \beta_2 \times \text{???} + \epsilon\]</span></p>
<ul>
<li><p>Assuming there is some truth behind the skeptic claims, what is the expected sign and significance of the coefficient on rural status in this model?</p></li>
<li><p>If the skeptic is right, and differences in vaccination rates are entirely a function of geography, what should happen to the sign and significance of the coefficient on partisanship in this model compared to the bivariate model?</p></li>
<li><p>If the skeptic is only partly right, and only part of the relationship between partisanship and vaccination is actually a function of geographic differences, what should happen to the sign and significance of the coefficient on partisanship in this model compared to the bivariate model?</p></li>
<li><p>If the skeptic is completely wrong, and geography has no relationship to vaccination rates, what should we expect in terms of the size and significance of the coefficient on rural status? How will the coefficient on partisanship in this model change?</p></li>
</ul>
</section>
</section>
<section id="statistical-inference-20-points" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Statistical Inference (20 points)</h1>
<section id="what-is-a-confidence-interval-10-points" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="what-is-a-confidence-interval-10-points"><span class="header-section-number">3.1</span> What is a confidence interval? (10 points)</h2>
<p>Please provide a one-two paragraph explanation of what a confidence interval is, how we construct confidence intervals, and how confidence intervals can be used to conduct statistical inference.</p>
<p>In your answer, please be sure to discuss and explain the following concepts:</p>
<ul>
<li>Populations and samples</li>
<li>Sampling distributions</li>
<li>Standard errors</li>
<li>Significance thresholds and critical values</li>
<li>For a 95% confidence interval, what are we 95% percent confident about?</li>
</ul>
</section>
<section id="what-is-a-hypothesis-test-10-points" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="what-is-a-hypothesis-test-10-points"><span class="header-section-number">3.2</span> What is a hypothesis test? (10 points)</h2>
<p>Please provide a one-two paragraph explanation of what a hypothesis test is, how we conduct hypothesis tests, and how hypothesis tests can be used to conduct statistical inference.</p>
<p>In your answer, please be sure to explain the following:</p>
<ul>
<li>What is a null hypothesis?</li>
<li>What is a test stastitic?</li>
<li>What is a distribution of a test statistic under the null?</li>
<li>What is a p-value?</li>
<li>What’s the difference between a Type I and Type II error?</li>
</ul>
</section>
</section>
<section id="applied-empirical-analysis-40-points" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Applied Empirical Analysis (40 points)</h1>
<p>Finally lets demonstrate some of the empirical skills you’ve learned in POLS 1600.</p>
<p>Run the code below to load a small subset of data from the 2020 National Elections Time Seriese.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">url</span>(<span class="st">"https://pols1600.paultesta.org/files/data/final_exam.rda"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The data frame <code>df</code> contains the following variables:</p>
<ul>
<li><code>V201627</code>
<ul>
<li>Question: How often do you stop yourself from saying something because you think someone might call you a racist, a sexist, or otherwise a bad person?</li>
<li>Response Values: 1= Never, 2 = Rarely; 3 = Occasionally; 4 = Fairly Often; 5 = Very Often; -9 = Refused; -5 = Interview Breakoff</li>
</ul></li>
<li><code>V201511x</code>
<ul>
<li>Question: Summary measure of PARTY ID</li>
<li>Values: 1 = Strong Democrat; 2 = Not very strong Democrat; 3 = Independent-Democrat; 4 = Independent; 5 = Independent-Republican; 6 = Not very strong Republican; 7 = Strong Republican; -9 = Refused; -8 = Don’t Know</li>
</ul></li>
<li><code>V202300</code>
<ul>
<li>Question: Now I’m going to read several more statements. After each one, I would like you to tell me how strongly you agree or disagree: ‘Irish, Italian, Jewish and many other minorities overcame prejudice and worked their way up. Blacks should do the same without any special favors.’ Do you agree strongly, agree somewhat, neither agree nor disagree, disagree somewhat, or disagree strongly with this statement?</li>
<li>Response Values: 1 = Agree strongly; 2 = Agree somewhat; 3 = Neither agree nor disagree; 4 = Disagree somewhat; 5 = Disagree strongly; -9 = Refused; -8 = Don’t know; -7 = No post-election data, deleted due to incomplete interview; -6 = No post-election interview; -5 = Interview breakoff (sufficient partial IW)</li>
</ul></li>
</ul>
<p>We will use these data to explore how self-reported rates of self-censorship vary by partisanship and racial attitudes.</p>
<p>In this section you will:</p>
<ul>
<li><p>Look at and recode the data (10 points)</p></li>
<li><p>Produce a table of descriptive statistics (10 points)</p></li>
<li><p>Estimate three models (5 points)</p></li>
<li><p>Present and interpret the substantive and statistical significance of these models using a regression table and plot of predicted values (15 points)</p></li>
</ul>
<section id="look-at-and-recode-the-data-10-points" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="look-at-and-recode-the-data-10-points"><span class="header-section-number">4.1</span> Look at and recode the data (10 points)</h2>
<p>First write some code to give yourself a high level overivew the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># High Level Overview of the Data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><strong>Code Advice</strong> I would use <code>head()</code>, <code>table()</code> and <code>summary()</code> to accomplish this</li>
</ul>
<p>Based on this overview of the data, recode the raw variables to create the following columns in the dataset:</p>
<ul>
<li><p><code>self_censor</code> from <code>V201627</code> with negative values in <code>V201627</code> recoded to be NA</p></li>
<li><p><code>pid</code> from <code>V201511x</code> with negative values in <code>V201511x</code> recoded to be NA</p></li>
<li><p><code>pid_3cat</code> from <code>pid</code>.</p>
<ul>
<li>When <code>pid</code> corresponds to a Democratic respondent, <code>pid_3cat</code> should take the value of “Democrat”.</li>
<li>When <code>pid</code> corresponds to a Republican respondent, <code>pid_3cat</code> should take the value of “Republican”.</li>
<li>When <code>pid</code> corresponds to an Independent respondent, <code>pid_3cat</code> should take the value of “Independent”.</li>
<li>When <code>pid</code> is <code>NA</code>, <code>pid_3cat</code> should be <code>NA</code></li>
</ul></li>
<li><p><code>racial_attitudes</code> from <code>V202300</code> with negative values recoded to be <code>NA</code> and higher values corresponding to greater levels of agreement with statement (e.g.&nbsp;where <code>V202300</code> equals 1 (Strongly Agree), <code>racial_attitudes</code> should equal 5, <code>V202300</code> equals 5 (Strongly Disagree Agree), <code>racial_attitudes</code> should equal 1 )</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recode data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><strong>Code Advice</strong> I would use <code>%&gt;%</code>, <code>mutate()</code>, <code>ifelse()</code> and <code>case_when()</code> to accomplish this.</li>
</ul>
<p>If your coding is correct, the following code should all return <code>TRUE</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # 7 total columns in the data</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># dim(df)[2] == 7</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># # Recodes of V201627</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># median(df$self_censor, na.rm=T) == 2</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># sum(is.na(df$self_censor)) == 135</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># # Recodes of V201511x</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># median(df$pid, na.rm=T) == 4</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># sum(is.na(df$pid)) ==35</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># table(df$pid_3cat) == c(3835,968,3442)</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co"># sum(is.na(df$pid_3cat)) ==35</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co"># # Recodes of V202300</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co"># median(df$racial_attitudes, na.rm=T) == 3</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co"># sum(is.na(df$racial_attitudes)) == 907</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="produce-a-table-of-descriptive-statistics-10-points" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="produce-a-table-of-descriptive-statistics-10-points"><span class="header-section-number">4.2</span> Produce a table of descriptive statistics (10 points)</h2>
<p>Please calculate the following descriptive statistics for <code>self_censor</code>, <code>pid</code>, and <code>racial_resentment</code> describing the:</p>
<ul>
<li>Minimum</li>
<li>25th percentile</li>
<li>Median</li>
<li>Mean</li>
<li>75th percentile</li>
<li>Maximum</li>
<li>Number of Missing Observations</li>
</ul>
<p>Ideally, present this information like we did in class as a table of descriptive statistics. Use this information to describe the distributions of your data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Summary Statistics</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><strong>Code Advice</strong> Look at the <a href="https://pols1600.paultesta.org/assignments/pols1600_paper_template">final paper template</a></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Table of Descriptive Statistics</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="estimtate-three-models-5-points" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="estimtate-three-models-5-points"><span class="header-section-number">4.3</span> Estimtate three models (5 points)</h2>
<p>Please estimate the following models:</p>
<ol type="1">
<li>A simple model testing whether Republicans and Independents report higher or lower rates of self censorship compared to Democrats (hint, use <code>pid_3cat</code> as your predictor)</li>
</ol>
<p><span class="math display">\[\text{Self Censoring} = \beta_0 + \beta_1 \text{Republican} + \beta_2 \text{Independent} + \epsilon\]</span></p>
<ol start="2" type="1">
<li>A model which explores how these partisan differences change when controlling for variation in respondents’ attitudes about race.</li>
</ol>
<p><span class="math display">\[\text{SC} = \beta_0 + \beta_1 \text{Rep} + \beta_2 \text{Ind} + \beta_3 \text{Racial Attitudes} +\epsilon\]</span></p>
<ol start="3" type="1">
<li>An interaction model which allows the relationship between racial attitudes and self-censorship to vary by partisanship.</li>
</ol>
<p>explores how these partisan differences change when controlling for variation in respondents’ attitudes about race.</p>
<p><span class="math display">\[\begin{align}\text{SC} &amp;= \beta_0 + \beta_1 \text{Rep} + \beta_2 \text{Ind} + \beta_3 \text{RA} + \\
&amp;\beta_4 \text{Rep} \times \text{RA} + \beta_5 \text{Ind} \times \text{RA} +  \epsilon\end{align}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate models</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="present-and-interperet-your-results-15-points" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="present-and-interperet-your-results-15-points"><span class="header-section-number">4.4</span> Present and interperet your results (15 points)</h2>
<p>Finally, present and interpret the substantive and statistical signficance of your results.</p>
<p>Please include:</p>
<ul>
<li><p>A regression table containing the coefficients, standard errors, p-values for each model</p></li>
<li><p>A plot of the predicted values from your third model (the one interacting the categorical measure of partisanship with the numeric measure of racial attitudes).</p></li>
<li><p>A interpretation of the substantive and statistical significance of your three models with clear references to your table and figure.</p></li>
</ul>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use htmlreg to present your models as a regression table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a prediction dataframe and produce predicted values </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># for you interaction model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the predicted values (ideally with confidence intervals)</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># using ggplot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here’s an example of the kind of final figure you could produce for the interaction model</p>
<p><img src="https://pols1600.paultesta.org/assignments/final_fig.png" class="img-fluid"></p>
<ul>
<li><strong>Code Advice</strong> Again the <a href="https://pols1600.paultesta.org/assignments/pols1600_paper_template">final paper template</a> has lots of code that should be useful for you.</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>