<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Your Name HERE">
<meta name="dcterms.date" content="2025-01-27">

<title>Lab 01 - Exploring data on COVID-19 in the U.S. – POLS 1600</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-1cfdd6bcdaa40fc01831c1af7ce94cf5.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">

<script src="../site_libs/datatables-binding-0.33/datatables.js"></script>

<script src="../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">

<link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">

<script src="../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>

<link href="../site_libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">

<script src="../site_libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>

<link href="../site_libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">

<script src="../site_libs/selectize-0.12.0/selectize.min.js"></script>

<link href="../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">POLS 1600</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../class/index.html"> 
<span class="menu-text">Class</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../assignments/index.html"> 
<span class="menu-text">Assignments</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul class="collapse">
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#getting-set-up" id="toc-getting-set-up" class="nav-link" data-scroll-target="#getting-set-up"><span class="header-section-number">1</span> Getting set up</a></li>
  <li><a href="#install-the-some-additiona-packages" id="toc-install-the-some-additiona-packages" class="nav-link" data-scroll-target="#install-the-some-additiona-packages"><span class="header-section-number">2</span> Install the some additiona packages</a></li>
  <li><a href="#load-the-packages-well-be-using-today" id="toc-load-the-packages-well-be-using-today" class="nav-link" data-scroll-target="#load-the-packages-well-be-using-today"><span class="header-section-number">3</span> Load the packages we’ll be using today</a></li>
  <li><a href="#download-the-covid19-data-for-u.s." id="toc-download-the-covid19-data-for-u.s." class="nav-link" data-scroll-target="#download-the-covid19-data-for-u.s."><span class="header-section-number">4</span> Download the COVID19 Data for U.S.</a></li>
  <li><a href="#replicate-the-data-cleaning-and-recoding-from-class" id="toc-replicate-the-data-cleaning-and-recoding-from-class" class="nav-link" data-scroll-target="#replicate-the-data-cleaning-and-recoding-from-class"><span class="header-section-number">5</span> Replicate the data cleaning and recoding from class</a>
  <ul class="collapse">
  <li><a href="#uncomment-and-run-the-following-code" id="toc-uncomment-and-run-the-following-code" class="nav-link" data-scroll-target="#uncomment-and-run-the-following-code"><span class="header-section-number">5.1</span> Uncomment and run the following code</a></li>
  </ul></li>
  <li><a href="#exploring-our-data" id="toc-exploring-our-data" class="nav-link" data-scroll-target="#exploring-our-data"><span class="header-section-number">6</span> Exploring our data</a>
  <ul class="collapse">
  <li><a href="#uncomment-and-run-the-code-below" id="toc-uncomment-and-run-the-code-below" class="nav-link" data-scroll-target="#uncomment-and-run-the-code-below"><span class="header-section-number">6.1</span> Uncomment and run the code below,</a></li>
  <li><a href="#please-explain-in-words-your-best-understanding-of-what-each-line-of-code-is-doing" id="toc-please-explain-in-words-your-best-understanding-of-what-each-line-of-code-is-doing" class="nav-link" data-scroll-target="#please-explain-in-words-your-best-understanding-of-what-each-line-of-code-is-doing"><span class="header-section-number">6.2</span> Please explain in words your best understanding of what each line of code is doing:</a></li>
  </ul></li>
  <li><a href="#look-at-the-source-data-for-face-mask-policies" id="toc-look-at-the-source-data-for-face-mask-policies" class="nav-link" data-scroll-target="#look-at-the-source-data-for-face-mask-policies"><span class="header-section-number">7</span> Look at the source data for face mask policies</a>
  <ul class="collapse">
  <li><a href="#please-run-the-following-code" id="toc-please-run-the-following-code" class="nav-link" data-scroll-target="#please-run-the-following-code"><span class="header-section-number">7.1</span> Please run the following code:</a></li>
  <li><a href="#again-explain-in-words-what-the-components-of-this-code-are-doing" id="toc-again-explain-in-words-what-the-components-of-this-code-are-doing" class="nav-link" data-scroll-target="#again-explain-in-words-what-the-components-of-this-code-are-doing"><span class="header-section-number">7.2</span> Again, explain in words, what the components of this code are doing:</a></li>
  <li><a href="#what-have-we-learned-about-our-variables-measuring-face_mask-policy" id="toc-what-have-we-learned-about-our-variables-measuring-face_mask-policy" class="nav-link" data-scroll-target="#what-have-we-learned-about-our-variables-measuring-face_mask-policy"><span class="header-section-number">7.3</span> What have we learned about our variables measuring <code>face_mask</code> policy</a></li>
  </ul></li>
  <li><a href="#explore-rs-functions-for-generating-summary-statistics" id="toc-explore-rs-functions-for-generating-summary-statistics" class="nav-link" data-scroll-target="#explore-rs-functions-for-generating-summary-statistics"><span class="header-section-number">8</span> Explore R’s functions for generating summary statistics</a>
  <ul class="collapse">
  <li><a href="#measures-of-central-tendency" id="toc-measures-of-central-tendency" class="nav-link" data-scroll-target="#measures-of-central-tendency"><span class="header-section-number">8.1</span> Measures of Central Tendency</a></li>
  <li><a href="#measures-of-dispersion" id="toc-measures-of-dispersion" class="nav-link" data-scroll-target="#measures-of-dispersion"><span class="header-section-number">8.2</span> Measures of Dispersion</a></li>
  <li><a href="#measures-of-association" id="toc-measures-of-association" class="nav-link" data-scroll-target="#measures-of-association"><span class="header-section-number">8.3</span> Measures of Association</a></li>
  </ul></li>
  <li><a href="#facemasks-and-new-cases-of-covid-19" id="toc-facemasks-and-new-cases-of-covid-19" class="nav-link" data-scroll-target="#facemasks-and-new-cases-of-covid-19"><span class="header-section-number">9</span> Facemasks and New Cases of Covid-19</a>
  <ul class="collapse">
  <li><a href="#what-do-these-averages-really-tell-us" id="toc-what-do-these-averages-really-tell-us" class="nav-link" data-scroll-target="#what-do-these-averages-really-tell-us"><span class="header-section-number">9.1</span> What do these averages really tell us?</a></li>
  <li><a href="#add-another-filter-to-the-code-above-to-caluclate-the-conditional-means-for-just-1-month-in-a-particular-year-in-the-data" id="toc-add-another-filter-to-the-code-above-to-caluclate-the-conditional-means-for-just-1-month-in-a-particular-year-in-the-data" class="nav-link" data-scroll-target="#add-another-filter-to-the-code-above-to-caluclate-the-conditional-means-for-just-1-month-in-a-particular-year-in-the-data"><span class="header-section-number">9.2</span> Add another filter to the code above to caluclate the conditional means for just 1 month in a particular year in the data</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">10</span> Summary</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lab 01 - Exploring data on COVID-19 in the U.S.</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Your Name HERE </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 27, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="overview" class="level1 unnumbered">
<h1 class="unnumbered">Overview</h1>
<p>Today, we’ll continuing exploring the COVID-19 data for the U.S.</p>
<p>We covered a lot of ground in our last lecture. Conceptually, talked about how to</p>
<ul>
<li>Write and code in R Markdown</li>
<li>Install and load packages</li>
<li>Download and inspect data</li>
<li>Clean and recode data</li>
<li>Calculate simple descriptive statistics with that data</li>
</ul>
<p>To do this, we copied and pasted a lot of code. Today, we’ll <strong>get practice writing our own code.</strong> Specifically we will</p>
<ul>
<li>Repeat some steps from lecture to get our workspace and data set up</li>
<li>Recode some additional variables</li>
<li>Investigate what negative values mean for face mask policy</li>
<li>Explore, in greater depth, tools for descriptive inference</li>
<li>Revisit the question of face masks and new cases, <em>conditioning</em> on time.</li>
</ul>
</section>
<section id="getting-set-up" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Getting set up</h1>
<ol type="1">
<li>Save this document in a folder for the class</li>
<li>Set your working director: Session &gt; Set Working Directory &gt; Source file location</li>
</ol>
<ul>
<li>It’s not vital today, but it’s a good habit to develop.</li>
</ul>
</section>
<section id="install-the-some-additiona-packages" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Install the some additiona packages</h1>
<ul>
<li>In the code chunk below, we’ll use the <code>install.packages()</code> function to install the <code>lubridate</code> and <code>DT</code> package packages</li>
<li>Uncomment the code by removing #</li>
<li>Run the code “Live” by sending the command to your console</li>
<li>Once <code>lubridate</code> is installed, comment the code out by placing a # at the start of the line</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(c("lubridate","DT"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>'lubridate</code> package is a collection of functions that makes working with dates and time more simple.</p>
<p>The <code>DT</code> package allows us to display data tables in a searchable format in our html output.</p>
</section>
<section id="load-the-packages-well-be-using-today" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Load the packages we’ll be using today</h1>
<ul>
<li>Create a code chunk</li>
<li>Label your code chunk “packages”</li>
<li>Use the <code>library()</code> to load the following packages
<ul>
<li><code>tidyverse</code></li>
<li><code>COVID19</code></li>
<li><code>lubridate</code></li>
<li><code>DT</code></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(COVID19)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="download-the-covid19-data-for-u.s." class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Download the COVID19 Data for U.S.</h1>
<p>Open up the <a href="https://pols1600.paultesta.org/slides/01-slides.html#81">slides</a> from last class and copy and paste the relevant code into the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Download the COVID-19 data</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # Code below produces:</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># covid &lt;- COVID19::covid19(</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   country = "US",</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   start = "2020-01-01",</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   end = "2022-12-31",</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   level = 2,</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   verbose = F</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co"># # Produces file saved here:</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">url</span>(<span class="st">"https://pols1600.paultesta.org/files/data/covid.rda"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="replicate-the-data-cleaning-and-recoding-from-class" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Replicate the data cleaning and recoding from class</h1>
<p>Specifically please do the following:</p>
<ol type="1">
<li>Create a object called <code>territories</code> that is a vector containing the names of U.S. territories</li>
</ol>
<ul>
<li>Use <code>&lt;-</code> and <code>c()</code> (<a href="https://pols1600.paultesta.org/slides/01-slides#107">slides</a>)</li>
</ul>
<ol start="2" type="1">
<li>Create a new dataframe, called <code>covid_us</code>, by filtering out observations from the U.S. territories <code>- Use</code>&lt;-<code>,</code>%&gt;%<code>,</code>filter()<code>,</code>!<code>and</code>%in%` (<a href="https://pols1600.paultesta.org/slides/01-slides#108">slides</a>)</li>
<li>Create a <code>state</code> variable that is a copy of the <code>administrative_area_level_2</code></li>
</ol>
<ul>
<li>Use <code>%&gt;%</code>, <code>mutate()</code> and <code>-&gt;</code></li>
</ul>
<ol start="4" type="1">
<li>Create a variable called <code>new_cases</code> from the <code>confirmed</code>. Create a variable called <code>new_cases_pc</code> that is the number of new Covid-19 cases per 100,000 citizens</li>
</ol>
<ul>
<li>Use <code>%&gt;%</code>,<code>group_by()</code>,<code>mutate()</code> and <code>lag()</code>, `<code>/</code> and <code>*</code> (<a href="https://pols1600.paultesta.org/slides/01-slides#110">slides</a>)</li>
</ul>
<ol start="5" type="1">
<li>Create a variable called <code>face_masks</code> from the <code>facial_coverings</code> variable. (<a href="https://pols1600.paultesta.org/slides/01-slides#111">slides</a>)</li>
</ol>
<ul>
<li>Treat negative and positive values the same.</li>
<li>Recode numeric values so that they have meaningful labels</li>
<li>Save as a factor variable so that the labels are ordered in terms of increasing levels of severity/restrictions</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- 1. Create territories object</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>territories <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"American Samoa"</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Guam"</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Northern Mariana Islands"</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Puerto Rico"</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Virgin Islands"</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- 2. Create covid_us data frame</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>covid_us <span class="ot">&lt;-</span> covid <span class="sc">%&gt;%</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>administrative_area_level_2 <span class="sc">%in%</span> territories)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- 3-5. Recode variables in covid_us</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>covid_us <span class="sc">%&gt;%</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> administrative_area_level_2,</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(state) <span class="sc">%&gt;%</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">new_cases =</span> confirmed <span class="sc">-</span> <span class="fu">lag</span>(confirmed),</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">new_cases_pc =</span> new_cases <span class="sc">/</span> population <span class="sc">*</span><span class="dv">100000</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">face_masks =</span> <span class="fu">case_when</span>(</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>      facial_coverings <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"No policy"</span>,</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">abs</span>(facial_coverings) <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Recommended"</span>,</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">abs</span>(facial_coverings) <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Some requirements"</span>,</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">abs</span>(facial_coverings) <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"Required shared places"</span>,</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">abs</span>(facial_coverings) <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"Required all times"</span>,</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> <span class="fu">factor</span>(.,</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"No policy"</span>,<span class="st">"Recommended"</span>,</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Some requirements"</span>,</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Required shared places"</span>,</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Required all times"</span>)</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>    ) <span class="ot">-&gt;</span> covid_us</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next let’s compare our new <code>face_mask</code> variable to the original <code>facial_coverings</code> variable using the table command.</p>
<p>Uncomment the following code and replace the generic terms <code>data</code>, <code>variable1</code>, and <code>variable2</code> with appropriate terms.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># table(data$variable1, data$variable2, useNA="ifany")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(covid_us<span class="sc">$</span>face_masks, covid_us<span class="sc">$</span>facial_coverings,<span class="at">useNA=</span><span class="st">"ifany"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        
                            -4    -3    -2    -1     0     1     2     3     4
  No policy                  0     0     0     0  3893     0     0     0     0
  Recommended                0     0     0   275     0  8604     0     0     0
  Some requirements          0     0  7362     0     0     0 17424     0     0
  Required shared places     0  5897     0     0     0     0     0  9191     0
  Required all times       410     0     0     0     0     0     0     0   622</code></pre>
</div>
</div>
<p>You’ve just created a “crosstab” a frequency table showing the joint distribution of two variables.</p>
<div class="blue">
<blockquote class="blockquote">
<p>Crosstabs are powerful tools for getting a sense of your data and for checking whether a recode did what you wanted it to do.</p>
</blockquote>
</div>
<p>Finally, let’s create a few more variables called <code>year_month</code> from the <code>date</code> variable and a variable describing the percent of a state’s population that is fully vaccinated (<code>percent_vaccinated</code>), which we’ll use later in the lab.</p>
<section id="uncomment-and-run-the-following-code" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="uncomment-and-run-the-following-code"><span class="header-section-number">5.1</span> Uncomment and run the following code</h2>
<p>Highlight the commented code below from <code># covid_us %&gt;%</code> to <code>#   ) -&gt; covid_us</code> and press <code>shift + cmd + C</code> on a mac or <code>shift + ctrl + C</code> on PC to uncomment the code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>covid_us <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> <span class="fu">year</span>(date),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">month =</span> <span class="fu">month</span>(date),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">year_month =</span> <span class="fu">paste</span>(year, <span class="fu">str_pad</span>(month, <span class="at">width =</span> <span class="dv">2</span>, <span class="at">pad=</span><span class="dv">0</span>), <span class="at">sep =</span> <span class="st">"-"</span>),</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">percent_vaccinated =</span> people_fully_vaccinated<span class="sc">/</span>population<span class="sc">*</span><span class="dv">100</span>  </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    ) <span class="ot">-&gt;</span> covid_us</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>The <code>year(date)</code> extracts the year from our <code>date</code> variable and saves it in new column called <code>year</code></li>
<li>Similarly, the <code>month(date)</code> extracts the month from our <code>date</code> variable and saves it in a new column called <code>month</code></li>
<li>Finally the <code>paste()</code> command pastes these two variables together, with the <code>str_pad()</code> adding a leading 0 to single digit months.</li>
<li>To calculate the percent of states population that is fully vaccinated on a given date we divide the total number of fully vaccinated by the state’s population and multiply by 100 to make it a percent.</li>
</ul>
</section>
</section>
<section id="exploring-our-data" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Exploring our data</h1>
<p>From the <a href="https://covid19datahub.io/articles/docs.html">documentation</a> of the COVID19 package, we see that the numeric values of the <code>facial_coverings</code> correspond to following substantive policy regimes:</p>
<ul>
<li>0 - No policy</li>
<li>1 - Recommended</li>
<li>2 - Required in some specified shared/public spaces outside the home with other people present, or some situations when social distancing not possible</li>
<li>3 - Required in all shared/public spaces outside the home with other people present or all situations when social distancing not possible</li>
<li>4 - Required outside the home at all times regardless of location or presence of other people</li>
</ul>
<p>These data come from the <a href="https://github.com/OxCGRT/covid-policy-tracker">Oxford Covid-19 Government Response Tracker</a>. Oxford distinguishes between policies that are in effect for the entire administrative unit (e.g.&nbsp;the State of New York) and policies that may be in effect in only parts of the administrative unit (e.g.&nbsp;New York city)</p>
<blockquote class="blockquote">
<p>In short: positive integers identify policies applied to the entire administrative area. Negative integers are used to identify policies that represent a best guess of the policy in force, but may not represent the real status of the given area. The negative sign is used solely to distinguish the two cases, it should not be treated as a real negative value.</p>
</blockquote>
<p>Let’s get some practice using the <code>filter()</code>, <code>select()</code> <code>group_by()</code> and <code>summarize()</code>, and <code>n()</code> commands from <code>dplyr</code> package to understand how common each these negative values are in our data.</p>
<section id="uncomment-and-run-the-code-below" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="uncomment-and-run-the-code-below"><span class="header-section-number">6.1</span> Uncomment and run the code below,</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>covid_us <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(facial_coverings <span class="sc">==</span> <span class="sc">-</span><span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, state) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state) <span class="sc">%&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">earliest_date =</span> <span class="fu">min</span>(date),</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">latest_date =</span> <span class="fu">max</span>(date),</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">%&gt;%</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(earliest_date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  state              n earliest_date latest_date
  &lt;chr&gt;          &lt;int&gt; &lt;date&gt;        &lt;date&gt;     
1 Illinois         156 2020-10-01    2021-05-15 
2 Massachusetts     35 2020-10-02    2020-11-05 
3 South Carolina    61 2020-10-13    2020-12-12 
4 Maryland         158 2020-11-06    2021-04-12 </code></pre>
</div>
</div>
</section>
<section id="please-explain-in-words-your-best-understanding-of-what-each-line-of-code-is-doing" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="please-explain-in-words-your-best-understanding-of-what-each-line-of-code-is-doing"><span class="header-section-number">6.2</span> Please explain in words your best understanding of what each line of code is doing:</h2>
<ul>
<li><code>covid_us %&gt;%</code> tells R that every line of code after will use <code>covid_us</code> dataframe</li>
<li><code>filter(facial_coverings == -4) %&gt;%</code> tells R to filter out only the rows where the facial coverings variable equals -4</li>
<li><code>select(date, state) %&gt;%</code> tells R to select the columns named <code>date</code> and <code>state</code></li>
<li><code>group_by(state) %&gt;%</code> tells R that subsequent commands should be done separately for each unique value of <code>state</code></li>
<li><code>summarize(</code> tells R we want to summarize the output of susequent commands</li>
<li><code>n = n(),</code> tells R to count the number of observations (state-dates) for each state that had a value of -4 on the <code>facial_coverings</code> variable</li>
<li><code>earliest_date = min(date),</code> tells R to report the earliest date that each state had a value of -4</li>
<li><code>latest_date = max(date),</code> tells R to report the last date that each state had a value of -4</li>
<li><code>)%&gt;%</code> tells R we’re finished with the <code>summarize()</code> function</li>
<li><code>arrange(earliest_date)</code> arranges the data in asscending order from earliest to latest start date</li>
</ul>
<p>You may find this <a href="https://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf">cheatsheet</a> useful and you can find a more detailed discussion <a href="https://r4ds.had.co.nz/transform.html">here</a></p>
<p>Substantively, what does the previous chunk of code tell us?</p>
<ul>
<li>So there are five states that had -4 on the facial covering variable: Illinois, Maryland, Massachusetts, Montana, and South Carolina. Illinois was the first state where this code appears, and it appears present in 156 observations while Montana was the last adopting a policy code -4 on March 25, 2021</li>
</ul>
<div class="blue">
<blockquote class="blockquote">
<p>Filtering data, selecting specific variables, and summarizing variables are important skills that let us “know our data”</p>
</blockquote>
</div>
</section>
</section>
<section id="look-at-the-source-data-for-face-mask-policies" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Look at the source data for face mask policies</h1>
<p>To make sure we understand what this policy variable <code>facial_coverings</code> is measuring, let’s download the source data from Oxford</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>oxford_us <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://github.com/OxCGRT/USA-covid-policy/raw/master/data/OxCGRT_US_latest.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 56992 Columns: 81
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (32): CountryName, CountryCode, RegionName, RegionCode, Jurisdiction, C1...
dbl (48): Date, C1_School closing, C1_Flag, C2_Workplace closing, C2_Flag, C...
lgl  (1): M1_Wildcard

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>Now let’s look at the policy on face masks for Illinois. From Oxford’s <a href="https://github.com/OxCGRT/covid-policy-tracker/blob/master/documentation/codebook.md">codebook</a>, we learn that variables describing face mask policies all begin with the prefix <code>H6_</code></p>
<div class="blue">
<blockquote class="blockquote">
<p>Using common prefixes for a variable is a good habit that will help you organize and work with your data</p>
</blockquote>
</div>
<section id="please-run-the-following-code" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="please-run-the-following-code"><span class="header-section-number">7.1</span> Please run the following code:</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>oxford_us <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">ymd</span>(Date)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">%&gt;%</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(RegionName <span class="sc">==</span> <span class="st">"Illinois"</span>, </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>         date <span class="sc">&gt;</span> <span class="st">"2020-08-01"</span>, </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>         date <span class="sc">&lt;</span> <span class="st">"2021-01-01"</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(H6_Notes)) <span class="sc">%&gt;%</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date,<span class="fu">starts_with</span>(<span class="st">"H6_"</span>)) <span class="ot">-&gt;</span> il_facemasks</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>il_facemasks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 4
  date       `H6_Facial Coverings` H6_Flag H6_Notes                             
  &lt;date&gt;                     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;                                
1 2020-08-21                     2       1 "In Executive Order 2020-52, Executi…
2 2020-08-26                     2       1 "Effective from 26 August 2020, the …
3 2020-09-18                     2       1 "On 18 September, in Executive Order…
4 2020-10-01                     4       0 "Originally coded a 3T, but looking …
5 2020-10-16                     4       0 "In Executive Order (EO) 2020-59, Go…
6 2020-11-13                     4       0 "Noting that Executive Order 2020-71…
7 2020-11-20                     4       0 "Executive Order 2020-73 requires pe…
8 2020-12-01                     3       1 "Chicago seems to have changed its g…</code></pre>
</div>
</div>
</section>
<section id="again-explain-in-words-what-the-components-of-this-code-are-doing" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="again-explain-in-words-what-the-components-of-this-code-are-doing"><span class="header-section-number">7.2</span> Again, explain in words, what the components of this code are doing:</h2>
<ul>
<li><code>oxford_us %&gt;%</code> Tells R to use the Oxford policy data</li>
<li><code>mutate(date = ymd(Date))%&gt;%</code> Creates a <code>date</code> variable of class <code>date</code> from the original <code>Date</code> variable (which was class <code>numeric</code>)</li>
<li><code>filter(RegionName == "Illinois",</code> subsets the data to just Illinois</li>
<li><code>date &gt; "2020-08-01",</code> filters out dates before August 1, 2020</li>
<li><code>date &lt; "2021-01-01",</code> filters out observations with dates after January 1,2021</li>
<li><code>!is.na(H6_Notes)) %&gt;%</code> filters out observations without notes (which appear in the data when policy changes)</li>
<li><code>select(date,starts_with("H6_")) -&gt; il_facemasks</code> Selects just the date and notes variables and saves them to an object called <code>il_facemasks</code></li>
<li><code>il_facemasks</code> prints the obejct in the console</li>
</ul>
<p>Let’s take a look at the <code>H6_Notes</code> variable for 2020-09-18</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>il_facemasks<span class="sc">$</span>H6_Notes[<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "On 18 September, in Executive Order 2020-55, the Governor reissued most executive orders, extending a majority of the provisions through 17 October 2020. This includes mask requirements.      https://web.archive.org/web/20200922144918/https://www2.illinois.gov/Pages/Executive-Orders/ExecutiveOrder2020-55.aspx"</code></pre>
</div>
</div>
<p>Now update the code to select <code>H6_Notes</code> variable for 2020-10-01</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>il_facemasks<span class="sc">$</span>H6_Notes[il_facemasks<span class="sc">$</span>date <span class="sc">==</span> <span class="st">"2020-10-01"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Originally coded a 3T, but looking at the below description, which includes even residential buildings, it is hard to conceive of a time outside the home when a Chicago resident would not be required to wear a mask. The Phase IV \"Gradually Resume\" guidelines seem not to provide any significant exemption (https://archive.fo/dOyY9). Hence code moves up to 4T.    Effective October 1, 2020, residents of Chicago are required to wear masks in all public places.     “Any individual who is over age two and able to medically tolerate a mask shall be required to wear a mask when in a public place, which for purposes of this Order includes any common or shared space in: (1) a residential multi-unit building or (2) any non-residential building, unless otherwise provided for in the Phase IV: Gradually Resume guidelines promulgated by the Office of the Mayor (\"Gradually Resume Guidelines\")”    Additionally, but separately, “Individuals must, at all times and as much as reasonably possible, maintain Social Distancing from any other person who does not live with them.”    https://web.archive.org/web/20201116163255/https://www.chicago.gov/content/dam/city/sites/covid/health-orders/CDPH%20Order%202020-9%20-%205th%20Amended%20FINAL%209.30.20_AAsigned.pdf"</code></pre>
</div>
</div>
</section>
<section id="what-have-we-learned-about-our-variables-measuring-face_mask-policy" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="what-have-we-learned-about-our-variables-measuring-face_mask-policy"><span class="header-section-number">7.3</span> What have we learned about our variables measuring <code>face_mask</code> policy</h2>
<p>In Illinois, the -4’s seem to correspond to more stringent mask policies implemented in Chicago relative to the rest of the state. So by collapsing negative and positive values of <code>facial_coverings</code> to construct our <code>face_mask</code> variable, we’re probably over stating the extent the extensiveness of policies in effect.</p>
<p>So we should be cautious in how we interpret our collapsed variable, <code>face_mask</code>. Perhaps we could construct another variable that distinguished state-level policies from more localized policies, or we could only look at cases where there was a uniform state policy.</p>
</section>
</section>
<section id="explore-rs-functions-for-generating-summary-statistics" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Explore R’s functions for generating summary statistics</h1>
<p>In class, we kind of rushed through our discussion of descriptive statistics. Let’s take a little time to review these concepts in more detail and see how to calculate them in R.</p>
<section id="measures-of-central-tendency" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="measures-of-central-tendency"><span class="header-section-number">8.1</span> Measures of Central Tendency</h2>
<p>Measures of central tendency describe what a typical value of some variable. In this course, we’ll use three measures of what’s typical:</p>
<ul>
<li>mean</li>
<li>median</li>
<li>mode</li>
</ul>
<section id="mean" class="level3" data-number="8.1.1">
<h3 data-number="8.1.1" class="anchored" data-anchor-id="mean"><span class="header-section-number">8.1.1</span> Mean</h3>
<p>One of the most frequent measures of central tendency we’ll use in this course is a mean or average.</p>
<p>Suppose we have <span class="math inline">\(n\)</span> observations of some variable <span class="math inline">\(x\)</span>. We can calculate the mean of <span class="math inline">\(\bar{x}\)</span> (“x bar), by adding up all the values of x</p>
<p>[ {x}=_{i=1}^n x_i ]</p>
<p>We’ll see later in the course that means are closely related to the concept of expected values in probability and that conditional means (which we’ll calculate below) are central to thinking about linear regression.</p>
<p>For now, please calculate the mean (average) number of new cases per 100,000 residents in our data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(covid_us<span class="sc">$</span>new_cases_pc, <span class="at">na.rm=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 29.40619</code></pre>
</div>
</div>
<p>Last class, when we calculated the the average number of new cases under each type of face mask policy, we were calculating a <strong>conditional mean</strong> the mean of some variable, conditional on some other variable taking a specific value.</p>
<p>Formally, you’ll often see this written in terms of <strong>Expected Values</strong>: Something like</p>
<p>[ E[Y|X=x] ]</p>
<p>Or to make it more concrete:</p>
<p>[ E[ | ] ]</p>
<p>In code, we could accomplish this manually, using the index operator:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(covid_us<span class="sc">$</span>new_cases_pc[covid_us<span class="sc">$</span>face_masks <span class="sc">==</span> <span class="st">"No policy"</span>], <span class="at">na.rm=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.26168</code></pre>
</div>
</div>
<section id="how-would-we-calculate-the-conditional-mean-of-new_cases_pc-when-face_masks-equals-recommend" class="level4" data-number="8.1.1.1">
<h4 data-number="8.1.1.1" class="anchored" data-anchor-id="how-would-we-calculate-the-conditional-mean-of-new_cases_pc-when-face_masks-equals-recommend"><span class="header-section-number">8.1.1.1</span> How would we calculate the conditional mean of <code>new_cases_pc</code> when <code>face_masks</code> equals “Recommend”</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(covid_us<span class="sc">$</span>new_cases_pc[covid_us<span class="sc">$</span>face_masks <span class="sc">==</span> <span class="st">"Recommended"</span>], <span class="at">na.rm=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 16.61408</code></pre>
</div>
</div>
<p>By using <code>group_by()</code> with <code>summarise()</code> we can accomplish this more quickly:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>covid_us<span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(face_masks)<span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">new_cases_pc =</span> <span class="fu">mean</span>(new_cases_pc, <span class="at">na.rm=</span>T)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  face_masks             new_cases_pc
  &lt;fct&gt;                         &lt;dbl&gt;
1 No policy                      10.3
2 Recommended                    16.6
3 Some requirements              36.2
4 Required shared places         29.4
5 Required all times             32.2</code></pre>
</div>
</div>
</section>
</section>
<section id="median" class="level3" data-number="8.1.2">
<h3 data-number="8.1.2" class="anchored" data-anchor-id="median"><span class="header-section-number">8.1.2</span> Median</h3>
<p>The median is another measure of what’s typical for variables that take numeric values</p>
<p>Imagine, we took our data new Covid-19 cases and arranged them in ascending order, from the smallest value to highest value</p>
<p>The median would be the value in the exact middle of that sequence, also known as the 50th percentile.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>Formally, we can define that median as:</p>
<p>[ M_x = X_i : ^{x_i} f_x(X)dx=^f_x(X)dx=1/2 ]</p>
<p>Which might look like Greek to you, which is fine. Just think of it as the middle value.</p>
<section id="please-calculate-the-median-number-of-new-covid-19-cases-per-100000-using-the-median-function.-how-does-it-compare-to-the-mean" class="level4" data-number="8.1.2.1">
<h4 data-number="8.1.2.1" class="anchored" data-anchor-id="please-calculate-the-median-number-of-new-covid-19-cases-per-100000-using-the-median-function.-how-does-it-compare-to-the-mean"><span class="header-section-number">8.1.2.1</span> Please calculate the median number of new Covid-19 cases per 100,000 using the <code>median()</code> function. How does it compare to the mean?</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(covid_us<span class="sc">$</span>new_cases_pc, <span class="at">na.rm=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.70289</code></pre>
</div>
</div>
<p>Interesting the median is much lower than the mean. If we were to look at a histogram of our data (more on that next week; think of it as a graphical representation of a frequency table), we see that the <code>new_cases_pc</code> has a “long tail” or is skewed to the right. Most of the values are close to 0, but there are few cases that are extreme outliers.</p>
<div class="blue">
<blockquote class="blockquote">
<p>Medians are less influenced by outliers than means</p>
</blockquote>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(covid_us<span class="sc">$</span>new_cases_pc, <span class="at">breaks =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01-lab-comments_files/figure-html/hist-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="modes" class="level3" data-number="8.1.3">
<h3 data-number="8.1.3" class="anchored" data-anchor-id="modes"><span class="header-section-number">8.1.3</span> Modes</h3>
<p>Conceptually, a mode describes the most frequent outcome.</p>
<p>Modes are useful for describing what’s typical of “nominal” or categorical data like our measure of face mask policy.</p>
<p>To calculate the mode of our <code>face_masks</code> variable, wrap the output of <code>table()</code> with the <code>sort()</code> function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">table</span>(covid_us<span class="sc">$</span>face_masks))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Required all times              No policy            Recommended 
                  1032                   3893                   8879 
Required shared places      Some requirements 
                 15088                  24786 </code></pre>
</div>
</div>
<p>For numeric data, modes correspond to the peak of a variable’s density function (more on this later in the class).</p>
<p>You can get a sense of the relationship between, means, median’s and modes from this helpful figure from <a href="https://en.wikipedia.org/wiki/Mode_(statistics)">Wikipedia</a>:</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/33/Visualisation_mode_median_mean.svg/240px-Visualisation_mode_median_mean.svg.png" class="img-fluid"></p>
</section>
</section>
<section id="measures-of-dispersion" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="measures-of-dispersion"><span class="header-section-number">8.2</span> Measures of Dispersion</h2>
<p>Measures of dispersion describe how much the data “vary.” Let’s discuss the following ways we can summarize how our data vary:</p>
<ul>
<li>range</li>
<li>percentile range</li>
<li>variance</li>
<li>standard deviation</li>
</ul>
<section id="range" class="level3" data-number="8.2.1">
<h3 data-number="8.2.1" class="anchored" data-anchor-id="range"><span class="header-section-number">8.2.1</span> Range</h3>
<p>The range of a variable is simply it’s minimum and maximum value</p>
<section id="please-calculate-the-range-of-our-new_cases_pc-using-the-range-function" class="level4" data-number="8.2.1.1">
<h4 data-number="8.2.1.1" class="anchored" data-anchor-id="please-calculate-the-range-of-our-new_cases_pc-using-the-range-function"><span class="header-section-number">8.2.1.1</span> Please calculate the range of our <code>new_cases_pc</code> using the <code>range()</code> function</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(covid_us<span class="sc">$</span>new_cases_pc,<span class="at">na.rm =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -275.6916 1531.8669</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(covid_us<span class="sc">$</span>new_cases_pc,<span class="at">na.rm =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -275.6916</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(covid_us<span class="sc">$</span>new_cases_pc,<span class="at">na.rm =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1531.867</code></pre>
</div>
</div>
</section>
<section id="what-states-on-what-dates-observed-these-minimum-and-maximum-values" class="level4" data-number="8.2.1.2">
<h4 data-number="8.2.1.2" class="anchored" data-anchor-id="what-states-on-what-dates-observed-these-minimum-and-maximum-values"><span class="header-section-number">8.2.1.2</span> What states on what dates observed these minimum and maximum values?</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>covid_us <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    new_cases_pc <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">188</span> <span class="sc">|</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    new_cases_pc <span class="sc">&gt;</span> <span class="dv">1500</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">%&gt;%</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(state, date,new_cases_pc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
# Groups:   state [4]
  state        date       new_cases_pc
  &lt;chr&gt;        &lt;date&gt;            &lt;dbl&gt;
1 Florida      2021-06-04        -189.
2 Rhode Island 2022-01-04        1532.
3 Nebraska     2022-10-28        -276.
4 Kentucky     2022-10-11        -198.</code></pre>
</div>
</div>
</section>
</section>
<section id="percentiles-ranges" class="level3" data-number="8.2.2">
<h3 data-number="8.2.2" class="anchored" data-anchor-id="percentiles-ranges"><span class="header-section-number">8.2.2</span> Percentiles Ranges</h3>
<p>The <span class="math inline">\(p\)</span>-th percentile is the value of the observation such that 100*p percent of the data are to the left and 100-100*p are two the right.</p>
<p>[ p_x = X_i : ^{x_i} f_x(X)dx= p; ^f_x(X)dx=1-p ]</p>
<p>The median is just the 50th percentile</p>
<p>In R we calculate the <span class="math inline">\(p\)</span>-th percentile using the <code>quantile()</code> setting the <code>probs</code> argument to the <span class="math inline">\(p/100\)</span> percentile that we we want.</p>
<section id="please-use-the-quantile-function-to-calculate-the-25th-and-75th-percentiles-of-the-new_cases_pc-variable." class="level4" data-number="8.2.2.1">
<h4 data-number="8.2.2.1" class="anchored" data-anchor-id="please-use-the-quantile-function-to-calculate-the-25th-and-75th-percentiles-of-the-new_cases_pc-variable."><span class="header-section-number">8.2.2.1</span> Please use the <code>quantile()</code> function to calculate the 25th and 75th percentiles of the <code>new_cases_pc</code> variable.</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(covid_us<span class="sc">$</span>new_cases_pc, <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">25</span>,.<span class="dv">75</span>), <span class="at">na.rm=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       25%        75% 
 0.9694437 33.5341961 </code></pre>
</div>
</div>
<p>The 25th and 75th percentile define the “Interquartile Range” where 50 percent of the observations lie within this range, and 50 percent lie outside the range.</p>
</section>
</section>
<section id="variance" class="level3" data-number="8.2.3">
<h3 data-number="8.2.3" class="anchored" data-anchor-id="variance"><span class="header-section-number">8.2.3</span> Variance</h3>
<p>Variance describes how much observations of a given measure vary around that measure’s mean.</p>
<p>The variance in a given sample is calculated by taking the average of the sum of squared deviations (i.e.&nbsp;differences) around a measure’s mean.</p>
<p>[ ^2_x=_{i=1}<sup>n(x_i-</sup>{x})2 ]</p>
<ul>
<li><span class="math inline">\(x_i-\bar{x}\)</span> is the deviation of each observation from the overall mean</li>
<li><span class="math inline">\((x_i-\bar{x})^2}\)</span> squaring this ensures that we treat positive and negative deviations the same when calculating the overall variance</li>
<li><span class="math inline">\(\sum_{i=1}\)</span> sums up all the differences</li>
<li><span class="math inline">\(\frac{1}{n-1}\)</span> is like taking the average of these differences (we divide by <span class="math inline">\(n-1\)</span> instead of <span class="math inline">\(n\)</span> for <a href="https://web.ma.utexas.edu/users/mks/M358KInstr/SampleSDPf.pdf">statistical reasons</a> that we’ll return two when we talk about estimation)</li>
</ul>
<p>Use the <code>var()</code> function to calculate the variance of the <code>new_cases_pc</code> variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(covid_us<span class="sc">$</span>new_cases_pc,<span class="at">na.rm=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3570.208</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate by hand</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  (covid_us<span class="sc">$</span>new_cases_pc <span class="sc">-</span> <span class="fu">mean</span>(covid_us<span class="sc">$</span>new_cases_pc,<span class="at">na.rm=</span>T))<span class="sc">^</span><span class="dv">2</span>, </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.rm=</span>T</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">/</span>(<span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(covid_us<span class="sc">$</span>new_cases_pc))<span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3570.208</code></pre>
</div>
</div>
<p>Variance will be important for thinking about uncertainty and inference (e.g.&nbsp;how might our estimate have been different)</p>
</section>
<section id="standard-deviations" class="level3" data-number="8.2.4">
<h3 data-number="8.2.4" class="anchored" data-anchor-id="standard-deviations"><span class="header-section-number">8.2.4</span> Standard Deviations</h3>
<p>A standard deviation is simply the square root of variable’s variance.</p>
<p>[ _x== ]</p>
<p>Standard deviations are easier to interpet because their units are the same as variable.</p>
<p>Think of them as a measure of the typical amount of variation for variable.</p>
<p>Again, let’s use the <code>sd()</code> function to calculate the standard deviation of the <code>new_cases_pc</code> variable</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(covid_us<span class="sc">$</span>new_cases_pc,<span class="at">na.rm=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 59.75122</code></pre>
</div>
</div>
</section>
</section>
<section id="measures-of-association" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="measures-of-association"><span class="header-section-number">8.3</span> Measures of Association</h2>
<p>Measures of association describe how variables relate to each other.</p>
<section id="covariance" class="level3" data-number="8.3.1">
<h3 data-number="8.3.1" class="anchored" data-anchor-id="covariance"><span class="header-section-number">8.3.1</span> Covariance</h3>
<p>Covariance describes how two variables “co-vary”.</p>
<p>When <span class="math inline">\(x\)</span> is above its mean, <span class="math inline">\(y\)</span> also tends to be above it’s mean, these variables have a positive covariance.</p>
<p>If when <span class="math inline">\(x\)</span> tends to be high, <span class="math inline">\(y\)</span> tends to be low, these variables have a negative variance</p>
<p>Formally, the sample<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> covariance of two variables can written as follows:</p>
<p>[ cov(x,y)=_{i=1}^n(x_i-{x})(y_i-{y}) ]</p>
<section id="please-calculate-the-covariance-between-the-percent-of-states-population-that-is-fully-vaccinated-percent_vaccinated-and-new_cases_pc-using-the-var-function" class="level4" data-number="8.3.1.1">
<h4 data-number="8.3.1.1" class="anchored" data-anchor-id="please-calculate-the-covariance-between-the-percent-of-states-population-that-is-fully-vaccinated-percent_vaccinated-and-new_cases_pc-using-the-var-function"><span class="header-section-number">8.3.1.1</span> Please calculate the covariance between the percent of state’s population that is fully vaccinated (<code>percent_vaccinated</code>) and <code>new_cases_pc</code> using the <code>var()</code> function</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(covid_us<span class="sc">$</span>new_cases_pc,covid_us<span class="sc">$</span>percent_vaccinated,<span class="at">na.rm =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13.77622</code></pre>
</div>
</div>
</section>
</section>
<section id="correlation" class="level3" data-number="8.3.2">
<h3 data-number="8.3.2" class="anchored" data-anchor-id="correlation"><span class="header-section-number">8.3.2</span> Correlation</h3>
<p>Like variances, covariances don’t really have intrinsic meaning, since x and y can be measured on very different scales.</p>
<p>The correlation between two variables takes their covariance and scales this by the standard deviation of each variable, creating a measure that can range from -1 (perfect negative correlation) to 1 perfect positive correlation.</p>
<p>Again, we can write this formally</p>
<p>[ _{x,y} = ]</p>
<p>But don’t sweat the formulas too much. I’m just contractually obligated to show you math.</p>
<section id="calculate-the-correlation-between-the-percent-of-states-population-that-is-fully-vaccinated-percent_vaccinated-and-new_cases_pc-using-the-cor-function." class="level4" data-number="8.3.2.1">
<h4 data-number="8.3.2.1" class="anchored" data-anchor-id="calculate-the-correlation-between-the-percent-of-states-population-that-is-fully-vaccinated-percent_vaccinated-and-new_cases_pc-using-the-cor-function."><span class="header-section-number">8.3.2.1</span> Calculate the correlation between the percent of state’s population that is fully vaccinated (<code>percent_vaccinated</code>) and <code>new_cases_pc</code> using the <code>cor()</code> function.</h4>
<p>You’ll need to set the argument <code>use="complete.obs</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(covid_us<span class="sc">$</span>percent_vaccinated, covid_us<span class="sc">$</span>new_cases_pc, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.008977781</code></pre>
</div>
</div>
<p>Hmm… That seems a little strange. What if we calculated the correlation between vaccination rates and new cases separately for each month in 2021</p>
</section>
<section id="uncomment-and-interpret-the-output-of-the-code-below" class="level4" data-number="8.3.2.2">
<h4 data-number="8.3.2.2" class="anchored" data-anchor-id="uncomment-and-interpret-the-output-of-the-code-below"><span class="header-section-number">8.3.2.2</span> Uncomment and interpret the output of the code below</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>covid_us <span class="sc">%&gt;%</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;</span> <span class="dv">2020</span>)<span class="sc">%&gt;%</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year,month)<span class="sc">%&gt;%</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mn_per_vax =</span> <span class="fu">mean</span>(percent_vaccinated, <span class="at">na.rm=</span>T),</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">cor =</span> <span class="fu">cor</span>(new_cases_pc, percent_vaccinated, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 24 × 4
# Groups:   year [2]
    year month mn_per_vax     cor
   &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;
 1  2021     1      0.988 -0.304 
 2  2021     2      6.01  -0.306 
 3  2021     3     14.8    0.0107
 4  2021     4     28.3    0.0503
 5  2021     5     40.9   -0.102 
 6  2021     6     47.4   -0.206 
 7  2021     7     50.3   -0.290 
 8  2021     8     52.4   -0.334 
 9  2021     9     55.4   -0.288 
10  2021    10     57.8   -0.146 
# ℹ 14 more rows</code></pre>
</div>
</div>
</section>
</section>
</section>
</section>
<section id="facemasks-and-new-cases-of-covid-19" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Facemasks and New Cases of Covid-19</h1>
<p>Let’s return to the question of the average number of new Covid-19 cases (per 100,000) for different types of face mask policies.</p>
<p>We ended our previous class with this result:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>covid_us <span class="sc">%&gt;%</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(face_masks))<span class="sc">%&gt;%</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(face_masks)<span class="sc">%&gt;%</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">new_cases_pc =</span> <span class="fu">round</span>(<span class="fu">mean</span>(new_cases_pc, <span class="at">na.rm=</span>T),<span class="dv">2</span>)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="ot">-&gt;</span> face_mask_summary</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>face_mask_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  face_masks             new_cases_pc
  &lt;fct&gt;                         &lt;dbl&gt;
1 No policy                      10.3
2 Recommended                    16.6
3 Some requirements              36.2
4 Required shared places         29.4
5 Required all times             32.2</code></pre>
</div>
</div>
<section id="what-do-these-averages-really-tell-us" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="what-do-these-averages-really-tell-us"><span class="header-section-number">9.1</span> What do these averages really tell us?</h2>
<p>Probably not that much. Different Face mask policies are implemented at different times in the pandemic. For example, by 2021, almost all states have some requirements. Comparing the average for new cases in states with no policy to states with full requirements, is comparing the state of world in early 2020 to the state of the world in late 2020 to mid 2021. But lots of things differ between these periods. Other policies are also going into effect, new variants are emerging.</p>
<p>In short, those simple conditional means across the full data don’t really provide an apples to apples comparison.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>covid_us<span class="sc">%&gt;%</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date,face_masks)<span class="sc">%&gt;%</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">%&gt;%</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(date <span class="sc">&gt;=</span> <span class="st">"2020-03-01"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(date,n,<span class="at">fill=</span>face_masks))<span class="sc">+</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'date'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01-lab-comments_files/figure-html/fmplots-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>covid_us<span class="sc">%&gt;%</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date,face_masks)<span class="sc">%&gt;%</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">new_cases =</span> <span class="fu">sum</span>(new_cases)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">%&gt;%</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(date <span class="sc">&gt;=</span> <span class="st">"2020-03-01"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(date,new_cases))<span class="sc">+</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'date'. You can override using the
`.groups` argument.
`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 17 rows containing non-finite outside the scale range
(`stat_smooth()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01-lab-comments_files/figure-html/fmplots-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="add-another-filter-to-the-code-above-to-caluclate-the-conditional-means-for-just-1-month-in-a-particular-year-in-the-data" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="add-another-filter-to-the-code-above-to-caluclate-the-conditional-means-for-just-1-month-in-a-particular-year-in-the-data"><span class="header-section-number">9.2</span> Add another filter to the code above to caluclate the conditional means for just 1 month in a particular year in the data</h2>
<p>If we limit our comparison to a more narrow time period, say one month in one year, we’re making a fairer comparison between states that are likely facing more similar conditions/challenges.</p>
<p>So when we compare states in September 2020, we see that rates of new cases tend to be much higher in states with only recommend face mask policies compared to states with at least some requirements.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>covid_us <span class="sc">%&gt;%</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(face_masks))<span class="sc">%&gt;%</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year_month <span class="sc">==</span> <span class="st">"2020-09"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(face_masks) <span class="sc">%&gt;%</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">new_cases_pc =</span> <span class="fu">mean</span>(new_cases_pc,<span class="at">na.rm=</span>T)</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  face_masks             new_cases_pc
  &lt;fct&gt;                         &lt;dbl&gt;
1 Recommended                    43.9
2 Some requirements              13.5
3 Required shared places         13.0
4 Required all times             10.1</code></pre>
</div>
</div>
<section id="add-another-arguement-to-the-group_by-command-from-the-original-code-to-calcutate-the-conditional-means-by-face-mask-policy-for-each-month-in-each-year-of-the-data" class="level3" data-number="9.2.1">
<h3 data-number="9.2.1" class="anchored" data-anchor-id="add-another-arguement-to-the-group_by-command-from-the-original-code-to-calcutate-the-conditional-means-by-face-mask-policy-for-each-month-in-each-year-of-the-data"><span class="header-section-number">9.2.1</span> Add another arguement to the group_by() command from the original code to calcutate the conditional means by face mask policy for each month in each year of the data</h3>
<ul>
<li>Save the output of summarize into an object called <code>cases_by_month_and_policy</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>covid_us <span class="sc">%&gt;%</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(face_masks))<span class="sc">%&gt;%</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year_month,face_masks) <span class="sc">%&gt;%</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">length</span>(<span class="fu">unique</span>(state)),</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">new_cases_pc =</span> <span class="fu">round</span>(<span class="fu">mean</span>(new_cases_pc,<span class="at">na.rm=</span>T)),</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_cases =</span> <span class="fu">round</span>(<span class="fu">mean</span>(confirmed,<span class="at">na.rm=</span>T))</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="ot">-&gt;</span> cases_by_month_and_policy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year_month'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
</section>
<section id="uncomment-the-code-below-to-display-cases_by_month_and_policy-in-a-searchable-table" class="level3" data-number="9.2.2">
<h3 data-number="9.2.2" class="anchored" data-anchor-id="uncomment-the-code-below-to-display-cases_by_month_and_policy-in-a-searchable-table"><span class="header-section-number">9.2.2</span> Uncomment the code below to display <code>cases_by_month_and_policy</code> in a searchable table</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(cases_by_month_and_policy,</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">filter =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-9416fd77d1e21bad5343" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-9416fd77d1e21bad5343">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;No policy&quot;,&quot;Recommended&quot;,&quot;Some requirements&quot;,&quot;Required shared places&quot;,&quot;Required all times&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"51\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"204\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"2801453\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102"],["2020-01","2020-02","2020-03","2020-03","2020-04","2020-04","2020-04","2020-04","2020-05","2020-05","2020-05","2020-06","2020-06","2020-06","2020-06","2020-07","2020-07","2020-07","2020-07","2020-08","2020-08","2020-08","2020-08","2020-09","2020-09","2020-09","2020-09","2020-10","2020-10","2020-10","2020-10","2020-11","2020-11","2020-11","2020-12","2020-12","2020-12","2021-01","2021-01","2021-01","2021-02","2021-02","2021-02","2021-03","2021-03","2021-03","2021-04","2021-04","2021-04","2021-05","2021-05","2021-05","2021-06","2021-06","2021-07","2021-07","2021-08","2021-08","2021-09","2021-09","2021-10","2021-10","2021-11","2021-11","2021-12","2021-12","2022-01","2022-01","2022-02","2022-02","2022-03","2022-03","2022-04","2022-04","2022-04","2022-04","2022-05","2022-05","2022-05","2022-06","2022-06","2022-06","2022-07","2022-07","2022-07","2022-08","2022-08","2022-08","2022-08","2022-09","2022-09","2022-09","2022-09","2022-10","2022-10","2022-10","2022-11","2022-11","2022-11","2022-12","2022-12","2022-12"],["No policy","No policy","No policy","Recommended","No policy","Recommended","Some requirements","Required shared places","Recommended","Some requirements","Required shared places","Recommended","Some requirements","Required shared places","Required all times","Recommended","Some requirements","Required shared places","Required all times","Recommended","Some requirements","Required shared places","Required all times","Recommended","Some requirements","Required shared places","Required all times","Recommended","Some requirements","Required shared places","Required all times","Some requirements","Required shared places","Required all times","Some requirements","Required shared places","Required all times","Some requirements","Required shared places","Required all times","Some requirements","Required shared places","Required all times","Some requirements","Required shared places","Required all times","Some requirements","Required shared places","Required all times","Some requirements","Required shared places","Required all times","Some requirements","Required shared places","Some requirements","Required shared places","Some requirements","Required shared places","Some requirements","Required shared places","Some requirements","Required shared places","Some requirements","Required shared places","Some requirements","Required shared places","Some requirements","Required shared places","Some requirements","Required shared places","Some requirements","Required shared places","No policy","Recommended","Some requirements","Required shared places","No policy","Recommended","Some requirements","No policy","Recommended","Some requirements","No policy","Recommended","Some requirements","No policy","Recommended","Some requirements","Required shared places","No policy","Recommended","Some requirements","Required shared places","No policy","Recommended","Some requirements","No policy","Recommended","Some requirements","No policy","Recommended","Some requirements"],[18,25,51,1,48,51,11,8,29,21,12,23,22,21,1,11,20,37,2,2,10,38,2,1,10,38,2,1,9,39,5,11,42,7,8,41,5,8,40,4,8,42,5,10,40,3,22,41,3,36,31,1,42,15,45,11,45,11,44,10,43,11,45,9,45,6,48,4,49,3,50,3,3,23,50,2,4,24,28,5,25,28,6,27,26,5,24,25,1,6,27,23,1,8,27,20,8,28,18,7,27,17],[0,0,2,1,7,7,17,13,6,7,10,7,5,11,14,15,7,19,12,25,10,13,10,44,13,13,10,74,29,24,19,77,53,44,65,60,57,47,53,62,21,24,26,15,18,19,17,19,25,9,9,16,4,5,12,12,40,37,46,53,30,38,32,37,57,71,194,204,50,30,11,11,20,12,12,11,20,21,31,38,29,32,36,32,31,36,30,26,36,19,18,18,12,9,9,14,11,13,14,15,17,17],[1,4,842,348,2942,8006,27091,58707,12505,30858,64638,19790,42717,73226,60672,41358,41813,85438,98688,73143,59039,115950,137021,16557,86019,142033,170405,26578,84649,170984,221737,155452,223116,281535,255962,349812,281652,332179,491782,377101,412753,557729,602798,423425,599913,739992,430008,664232,890493,541691,752083,1355923,659390,626556,693436,562391,784361,371074,854154,604613,906163,734194,928863,881384,988937,1009735,1283303,1227360,1523330,1313503,1547637,1555169,1269700,1650906,1544686,1961594,1606979,1716974,1523006,2490400,1542604,1670034,2053536,1511958,1888276,2103405,1476507,2012202,2735034,1998500,1666809,1973626,2801453,1640805,1940118,1886662,1655120,2119028,1665828,1804930,1885126,2048465]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>year_month<\/th>\n      <th>face_masks<\/th>\n      <th>n<\/th>\n      <th>new_cases_pc<\/th>\n      <th>total_cases<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"year_month","targets":1},{"name":"face_masks","targets":2},{"name":"n","targets":3},{"name":"new_cases_pc","targets":4},{"name":"total_cases","targets":5}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="uncomment-the-code-below-to-visualize-this-cases_by_month_and_policy" class="level3" data-number="9.2.3">
<h3 data-number="9.2.3" class="anchored" data-anchor-id="uncomment-the-code-below-to-visualize-this-cases_by_month_and_policy"><span class="header-section-number">9.2.3</span> Uncomment the code below to visualize this <code>cases_by_month_and_policy</code></h3>
<p>What does this figure tell us?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>cases_by_month_and_policy <span class="sc">%&gt;%</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span> year_month,</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> new_cases_pc,</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">col=</span>face_masks))<span class="sc">+</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01-lab-comments_files/figure-html/fmfig-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>So this figure graphically displays the data <code>cases_by_month_and_policy</code></p>
<p>From about August 2020 to October 2020 states with facemask requirements saw much lower rates of new cases than states that only recommended face masks.</p>
<p>After October 2020, every state has at least some requirement, and the differences between the stringency of requirements is a little harder to see.</p>
<p>Again this stuff is complicated. Lots of things are changing and these month comparisons are by no means perfect. Lot’s of things differ between states with different mask policies. What we’d really like to know is a sort of counterfactual comparison between the number new cases in a state with a given policy and what those new cases would have been had that state had a different policy.</p>
<p>The problem is, we don’t get to see that counterfactual outcome. So how can we make causal claims about the effects of facemasks, or any other policy that interests us? Finding creative ways to answer these questions is the key to making credible causal claims.</p>
<p>Next week, we’ll explore how to make this figure and many more from our data</p>
</section>
</section>
</section>
<section id="summary" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Summary</h1>
<p>Like lecture, we covered a lot in this first lab. Specifically we:</p>
<ul>
<li>Practiced installing packages and setting up our workspace</li>
<li>Downloaded multiple data sets</li>
<li>Saw how we could use functions to transform and explore data. Specifically we used:
<ul>
<li><code>%&gt;%</code>, the pipe command, to chain together multiple functions</li>
<li><code>filter()</code> to filter data based on logical comparisons</li>
<li><code>select()</code> to select specific variables from our data</li>
<li><code>group_by()</code> to apply functions by one or more grouping variables</li>
<li><code>mutate()</code> to create new columns in our data</li>
<li><code>summarise()</code> to summarize the output of functions, often by groups</li>
<li><code>arrange()</code> to sort data by a specific variable</li>
</ul></li>
<li>Explored different tools of descriptive inference using:
<ul>
<li><code>means</code>, <code>medians</code> and <code>modes</code> to describe typical values of data</li>
<li><code>ranges</code>, <code>percentile ranges</code>, <code>variances</code> and <code>standard deviations</code> to describe how our data vary</li>
<li><code>covariances</code> and <code>correlations</code> to describe relationships between variables in our data</li>
</ul></li>
<li>Explored how the relationships between face masks and Covid-19 changed when we <em>conditioned</em> on time and looked within months as opposed to accross the whole data set.</li>
</ul>
<p>Not all of this will make sense the first time through. That’s OK. The things we’ve done today, we will do again and again over the course of the semester. Overtime, concepts that seemed crazy or confusing, we’ll become second nature.</p>
<p>After class, on the course website and canvas, you’ll find my “commented” solutions today’s lab.</p>
<p>If there are particular parts of the lab where we went too fast, or things didn’t make sense. Take a moment to review these notes. Try re-running the code. Changing the code. Break the code and see if you can fix it.</p>
<p>When you encounter a problem you can solve, send me an email, or ask your friends, or doctor Google. I guarantee you, someone else has had a similar question or problem.</p>
<p>The only dumb question in this course is a question you don’t ask!</p>
<p>Please upload the html file produced by your .Rmd file to [Canvas]https://canvas.brown.edu/courses/1098409/assignments)</p>
<p>Finally, please take a moment to complete this weeks <a href="https://brown.co1.qualtrics.com/jfe/form/SV_bPGJjZUbZ55PR2K">class survey</a></p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>It’s a little more complicated as we need to decide how to handle situations where their are ties, or an even number of cases. For now we’ll just accept the default rules <code>R</code> uses.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Astute readers might ask, why are you talking about samples? We’ll come back to this later in the course when we talk about probability, estimation and statistical inference.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/josephessig-source\.github\.io\/pols1600_site\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>