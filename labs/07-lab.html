<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="P.F. Testa">
<meta name="dcterms.date" content="2024-03-12">

<title>Lab 07 - Replicating Grumbach and Hill (2022): – POLS 1600</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-1cfdd6bcdaa40fc01831c1af7ce94cf5.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">

<script src="../site_libs/datatables-binding-0.32/datatables.js"></script>

<script src="../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">

<link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">

<script src="../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>

<link href="../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>



<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">POLS 1600</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../class/index.html"> 
<span class="menu-text">Class</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../assignments/index.html"> 
<span class="menu-text">Assignments</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul class="collapse">
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#goals" id="toc-goals" class="nav-link" data-scroll-target="#goals">Goals</a></li>
  <li><a href="#workflow" id="toc-workflow" class="nav-link" data-scroll-target="#workflow">Workflow</a>
  <ul class="collapse">
  <li><a href="#please-render-this-.qmd-file" id="toc-please-render-this-.qmd-file" class="nav-link" data-scroll-target="#please-render-this-.qmd-file">Please render this .qmd file</a></li>
  </ul></li>
  <li><a href="#get-set-up-to-work" id="toc-get-set-up-to-work" class="nav-link" data-scroll-target="#get-set-up-to-work">Get set up to work</a>
  <ul class="collapse">
  <li><a href="#load-packages" id="toc-load-packages" class="nav-link" data-scroll-target="#load-packages">Load packages</a></li>
  <li><a href="#important-set-your-working-directory" id="toc-important-set-your-working-directory" class="nav-link" data-scroll-target="#important-set-your-working-directory">IMPORTANT: Set your working directory</a></li>
  </ul></li>
  <li><a href="#summarize-the-study" id="toc-summarize-the-study" class="nav-link" data-scroll-target="#summarize-the-study"><span class="header-section-number">1</span> Summarize the study</a></li>
  <li><a href="#download-the-replication-files" id="toc-download-the-replication-files" class="nav-link" data-scroll-target="#download-the-replication-files"><span class="header-section-number">2</span> Download the replication files</a></li>
  <li><a href="#load-the-data" id="toc-load-the-data" class="nav-link" data-scroll-target="#load-the-data"><span class="header-section-number">3</span> Load the data</a></li>
  <li><a href="#get-a-hlo-of-each-dataset" id="toc-get-a-hlo-of-each-dataset" class="nav-link" data-scroll-target="#get-a-hlo-of-each-dataset"><span class="header-section-number">4</span> Get a HLO of each dataset</a></li>
  <li><a href="#merge-policy_data-into-cps-data" id="toc-merge-policy_data-into-cps-data" class="nav-link" data-scroll-target="#merge-policy_data-into-cps-data"><span class="header-section-number">5</span> Merge <code>policy_data</code> into <code>cps</code> data</a></li>
  <li><a href="#examine-and-recode-the-data" id="toc-examine-and-recode-the-data" class="nav-link" data-scroll-target="#examine-and-recode-the-data"><span class="header-section-number">6</span> Examine and recode the data</a>
  <ul class="collapse">
  <li><a href="#recode-covariates" id="toc-recode-covariates" class="nav-link" data-scroll-target="#recode-covariates"><span class="header-section-number">6.1</span> Recode covariates</a></li>
  <li><a href="#create-age_group-and-age_group_xx_xx-indicators" id="toc-create-age_group-and-age_group_xx_xx-indicators" class="nav-link" data-scroll-target="#create-age_group-and-age_group_xx_xx-indicators"><span class="header-section-number">6.2</span> Create <code>age_group</code> and age_group_XX_XX indicators</a></li>
  <li><a href="#check-age-recodes" id="toc-check-age-recodes" class="nav-link" data-scroll-target="#check-age-recodes"><span class="header-section-number">6.3</span> Check age recodes</a></li>
  <li><a href="#recode-the-outcome" id="toc-recode-the-outcome" class="nav-link" data-scroll-target="#recode-the-outcome"><span class="header-section-number">6.4</span> Recode the outcome</a></li>
  <li><a href="#save-the-recoded-data" id="toc-save-the-recoded-data" class="nav-link" data-scroll-target="#save-the-recoded-data"><span class="header-section-number">6.5</span> Save the recoded data</a></li>
  </ul></li>
  <li><a href="#recreate-figure-1" id="toc-recreate-figure-1" class="nav-link" data-scroll-target="#recreate-figure-1"><span class="header-section-number">7</span> Recreate Figure 1</a>
  <ul class="collapse">
  <li><a href="#write-down-aesthetic-mappings-from-the-figure" id="toc-write-down-aesthetic-mappings-from-the-figure" class="nav-link" data-scroll-target="#write-down-aesthetic-mappings-from-the-figure"><span class="header-section-number">7.1</span> Write down aesthetic mappings from the figure:</a></li>
  <li><a href="#create-a-variable-called-sdr" id="toc-create-a-variable-called-sdr" class="nav-link" data-scroll-target="#create-a-variable-called-sdr"><span class="header-section-number">7.2</span> Create a variable called <code>SDR</code></a></li>
  <li><a href="#recreate-figure-1-1" id="toc-recreate-figure-1-1" class="nav-link" data-scroll-target="#recreate-figure-1-1"><span class="header-section-number">7.3</span> Recreate Figure 1</a></li>
  <li><a href="#interpret-figure-1." id="toc-interpret-figure-1." class="nav-link" data-scroll-target="#interpret-figure-1."><span class="header-section-number">7.4</span> Interpret Figure 1.</a></li>
  </ul></li>
  <li><a href="#recreate-figure-2" id="toc-recreate-figure-2" class="nav-link" data-scroll-target="#recreate-figure-2"><span class="header-section-number">8</span> Recreate Figure 2</a>
  <ul class="collapse">
  <li><a href="#calculate-the-proption-voting-by-age-group-and-sdr" id="toc-calculate-the-proption-voting-by-age-group-and-sdr" class="nav-link" data-scroll-target="#calculate-the-proption-voting-by-age-group-and-sdr"><span class="header-section-number">8.1</span> Calculate the proption voting by age group and SDR</a></li>
  <li><a href="#recreate-figure-2-1" id="toc-recreate-figure-2-1" class="nav-link" data-scroll-target="#recreate-figure-2-1"><span class="header-section-number">8.2</span> Recreate Figure 2</a></li>
  <li><a href="#interpret-figure-2" id="toc-interpret-figure-2" class="nav-link" data-scroll-target="#interpret-figure-2"><span class="header-section-number">8.3</span> Interpret Figure 2</a></li>
  </ul></li>
  <li><a href="#take-the-class-survey" id="toc-take-the-class-survey" class="nav-link" data-scroll-target="#take-the-class-survey">Take the Class Survey</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lab 07 - Replicating Grumbach and Hill (2022):</h1>
<p class="subtitle lead">Understanding the Data and Design</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>P.F. Testa </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 12, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="overview" class="level1 unnumbered">
<h1 class="unnumbered">Overview</h1>
<p>In this lab, we will begin the process of replicating Grumbach and Hill (2021) “Rock the Registration: Same Day Registration Increases Turnout of Young Voters.”</p>
<p>To accomplish this we will:</p>
<ol start="0" type="1">
<li><p>Load packages and set the working directory to <strong>where this file is saved</strong>. (5 minutes)</p></li>
<li><p><strong>Summarize the study</strong> in terms of it’s research question, theory, design, and results. (10 minutes)</p></li>
<li><p>Download the replication files and <strong>save them in the same folder as this lab</strong> (5 minutes)</p></li>
<li><p><strong>Load the data</strong> from your computers into R (5 minutes)</p></li>
<li><p>Get a quick <strong>HLO</strong> of the data (10 minutes)</p></li>
<li><p><strong>Merge</strong> data on election policy into data on voting (5 minutes, together),</p></li>
<li><p><strong>Recode</strong> the covariates, key predictors, and outcome for the study (10 minutes, partly together)</p></li>
<li><p>Recreate <strong>Figure 1</strong> (15 minutes)</p></li>
<li><p>Recreate <strong>Figure 2</strong> (15 minutes)</p></li>
</ol>
<p>Finally, we’ll take the weekly survey which should be a <strong>fun</strong> one</p>
<p>One of these 8 tasks will be randomly selected as the graded question for the lab.</p>
<p>You will work in your assigned groups. Only one member of each group needs to submit the html file of lab.</p>
<p>This lab <strong>must</strong> contain the names of the group members in attendance.</p>
<p>If you are attending remotely, you will submit your labs individually.</p>
<p>Here are your assigned groups for the semester.</p>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-6cf55b72df3386bf8fa6" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-6cf55b72df3386bf8fa6">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8"],["Group 1","Group 2","Group 3","Group 4","Group 5","Group 6","Group 7","Group 8"],["Maia Eng","Andrew Rovinsky","Serafym Rybachkivskyi","Tiffany Eddy","Christopher Maron","Mia Hamilton","Mariana Melzer","Logan Szittai"],["Guadalupe Herrera","Spencer Lorin","Rachel Kim","Daniel Solomon","Daniel Baker","Emily Colon","Kahrie Langham","Keiley Thompson"],["Stephen Robinson","Lucinda Anderson","Kai Blades","Zoe Smith","Neve Diaz-Carr","Davis Kelly","Shannon Feerick-Hillenbrand","Lydell Dyer"],["Jeremiah Harrington","Serenity Hamilton","Emma Coleman","Lorena Calderon","Olivia Hanley","Talia Levine","Jarret Fernandes","Mahir Arora"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Group<\/th>\n      <th>1<\/th>\n      <th>2<\/th>\n      <th>3<\/th>\n      <th>4<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Group","targets":1},{"name":"1","targets":2},{"name":"2","targets":3},{"name":"3","targets":4},{"name":"4","targets":5}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="goals" class="level1 unnumbered">
<h1 class="unnumbered">Goals</h1>
<p>This week’s lab will give you practice:</p>
<ul>
<li><p>Summarizing academic work (Q1)</p></li>
<li><p>Loading data into R from your own computer (rather than just downloading it from the web) (Q2-3)</p></li>
<li><p>Looking at new data and figuring out what you need to do (e.g.&nbsp;merging, recoding) before you can analyze it (Q4-6)</p></li>
<li><p>Creating and interpreting figures that summarize aspects of a study’s design and data (Q7-8)</p></li>
</ul>
<p>Next week, we’ll get into the nuts and bolts of replicating Grumbach and Hill’s main results</p>
</section>
<section id="workflow" class="level1 unnumbered">
<h1 class="unnumbered">Workflow</h1>
<section id="please-render-this-.qmd-file" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="please-render-this-.qmd-file">Please render this .qmd file</h2>
<p>As with every lab, you should:</p>
<ul>
<li>Download the file</li>
<li>Save it in your course folder</li>
<li><strong>Update the <code>author:</code> section of the YAML header to include the names of your group members in attendance.</strong></li>
<li>Render the document</li>
<li>Open the html file in your browser (Easier to read)</li>
<li>Write your code in the <strong>chunks provided under each section</strong></li>
<li>Comment out or delete any test code you do not need</li>
<li><strong>Render the document again after completing a section or chunk</strong> (Error checking)</li>
<li>Upload the final lab to <a href="https://canvas.brown.edu/courses/1094972/assignments" target="_blank">Canvas</a>.</li>
</ul>
</section>
</section>
<section id="get-set-up-to-work" class="level1 unnumbered">
<h1 class="unnumbered">Get set up to work</h1>
<section id="load-packages" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="load-packages">Load packages</h2>
<p>As always, let’s load the packages we’ll need for today</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>the_packages <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">## R Markdown</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"kableExtra"</span>,<span class="st">"DT"</span>,<span class="st">"texreg"</span>,<span class="st">"htmltools"</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Tidyverse</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tidyverse"</span>, <span class="st">"lubridate"</span>, <span class="st">"forcats"</span>, <span class="st">"haven"</span>, <span class="st">"labelled"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Extensions for ggplot</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ggmap"</span>,<span class="st">"ggrepel"</span>, <span class="st">"ggridges"</span>, <span class="st">"ggthemes"</span>, <span class="st">"ggpubr"</span>, </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"GGally"</span>, <span class="st">"scales"</span>, <span class="st">"dagitty"</span>, <span class="st">"ggdag"</span>, <span class="st">"ggforce"</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Data </span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"COVID19"</span>,<span class="st">"maps"</span>,<span class="st">"mapdata"</span>,<span class="st">"qss"</span>,<span class="st">"tidycensus"</span>, <span class="st">"dataverse"</span>,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"janitor"</span>,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Analysis</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"DeclareDesign"</span>, <span class="st">"easystats"</span>, <span class="st">"zoo"</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Define function to load packages</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>ipak <span class="ot">&lt;-</span> <span class="cf">function</span>(pkg){</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    new.pkg <span class="ot">&lt;-</span> pkg[<span class="sc">!</span>(pkg <span class="sc">%in%</span> <span class="fu">installed.packages</span>()[, <span class="st">"Package"</span>])]</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(new.pkg)) </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">install.packages</span>(new.pkg, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sapply</span>(pkg, require, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ipak</span>(the_packages)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   kableExtra            DT        texreg     htmltools     tidyverse 
         TRUE          TRUE          TRUE          TRUE          TRUE 
    lubridate       forcats         haven      labelled         ggmap 
         TRUE          TRUE          TRUE          TRUE          TRUE 
      ggrepel      ggridges      ggthemes        ggpubr        GGally 
         TRUE          TRUE          TRUE          TRUE          TRUE 
       scales       dagitty         ggdag       ggforce       COVID19 
         TRUE          TRUE          TRUE          TRUE          TRUE 
         maps       mapdata           qss    tidycensus     dataverse 
         TRUE          TRUE          TRUE          TRUE          TRUE 
      janitor DeclareDesign     easystats           zoo 
         TRUE          TRUE          TRUE          TRUE </code></pre>
</div>
</div>
<p>We will also want to <strong>set our working directory</strong> to where your lab is saved.</p>
</section>
<section id="important-set-your-working-directory" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="important-set-your-working-directory">IMPORTANT: Set your working directory</h2>
<ol type="1">
<li>On the top panel of R Studio click:</li>
</ol>
<blockquote class="blockquote">
<p>Session Session &gt; Set working directory &gt; Source file location</p>
</blockquote>
<ol start="2" type="1">
<li>Paste the output that shows up in your console into the code chunk below</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set working directory</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Session &gt; Set working directory &gt; Source file location</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># paste output here:</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>All right, now let’s summarize the study</p>
</section>
</section>
<section id="summarize-the-study" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Summarize the study</h1>
<p>In a few sentences please answer the following questions about Grumbach and Hill (2021). I’ll get you started:</p>
<ul>
<li><p><strong>What’s research question?</strong> Broadly, Grumbach and Hill (2021 p.&nbsp;405) are interested in whether “election reform improve turnout among young people?” Specifically, Grumbach and Hill assess whether turnout is higher among younger voters in states with Same-Day-Registration (SDR) laws.</p></li>
<li><p><strong>What’s the theory motivating the research question and expectations?</strong> Grumbach and Hill (henceforth, G&amp;H) contribute to and draw on a broad literature on voting in the field of political behavior. While past work has found …</p></li>
<li><p><strong>What’s the empirical design?</strong> G&amp;H draw on a variety of datasets to test their claim. Their primary data for their main analyses comes from the …</p></li>
<li><p><strong>What’s the core finding?</strong> The main results of their analyses are presented in …</p></li>
</ul>
</section>
<section id="download-the-replication-files" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Download the replication files</h1>
<p>Ok now let’s download the replication files from the paper’s <a href="https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/AW5LU8" target="_blank">replication archive</a></p>
<p>Please see the <a href="https://pols1600.paultesta.org/slides/07-slides#/go-to-the-papers-dataverse" target="_blank">slides</a></p>
<p>Make sure the files are <strong>unzipped and saved</strong> in the <strong>SAME folder as this lab</strong></p>
</section>
<section id="load-the-data" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Load the data</h1>
<p>There should be 11 total files in the dataverse_files folder. We’re only going to use three of the data files for this replication</p>
<p>Please uncomment and run the code below</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load fips_codes</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># fips_codes &lt;- read_csv("dataverse_files/fips_codes_website.csv")%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   janitor::clean_names()</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># # Load policy data</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># policy_data &lt;- readRDS("dataverse_files/policy_data_updated.RDS")%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   janitor::clean_names()</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># # Load CPS data</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># cps &lt;- read_csv("dataverse_files/cps_00021.csv") %&gt;%</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   janitor::clean_names()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="{callout-note}">
<p>The <code>janitor::clean_names()</code> after each <code>read_XXX()</code> function converts column names to snake case</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Backup code if you run into major issues downloading and unzipping the files</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># DONT UNCOMMENT UNLESS YOU NEED TO</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Sys.setenv("DATAVERSE_SERVER" = "dataverse.harvard.edu")</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># # Load fips_codes</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># fips_codes &lt;- get_dataframe_by_name(</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   "fips_codes_website.tab",</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   "doi:10.7910/DVN/AW5LU8"</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ) %&gt;% janitor::clean_names()</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># # Load policy data</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co"># policy_data &lt;- get_dataframe_by_name(</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   "policy_data_updated.RDS",</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   "doi:10.7910/DVN/AW5LU8",</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   .f = readRDS</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co"># ) %&gt;% janitor::clean_names()</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co"># # Load CPS data</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co"># cps &lt;- get_dataframe_by_name(</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="co">#   "cps_00021.csv",</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   "doi:10.7910/DVN/AW5LU8",</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="co">#   .f = read_csv</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="co"># ) %&gt;% janitor::clean_names()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="get-a-hlo-of-each-dataset" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Get a HLO of each dataset</h1>
<p>In the code chunk below, please take a quick look at each dataset and answer the following for about each dataset. I’ll get you started for <code>fips_codes</code></p>
<ul>
<li><code>fips_codes</code>
<ul>
<li><strong>What is the unit of analysis?</strong> Federal Information Processing Standards (FIPS) state and county codes</li>
<li><strong>How many observations</strong> 41,787 observations</li>
<li><strong>How many variables</strong> 33 variables</li>
<li><strong>What variables identify US states</strong> <code>st</code> and <code>statefip</code></li>
</ul></li>
<li><code>data</code>
<ul>
<li><strong>What is the unit of analysis?</strong> State-years</li>
<li><strong>How many observations</strong> 2,450 observations</li>
<li><strong>How many variables</strong> 33 variables</li>
<li><strong>What variable describes whether a state had Same Day Registration (SDR)</strong> <code>sdr</code></li>
</ul></li>
<li><code>cps</code>
<ul>
<li><strong>What is the unit of analysis?</strong> A respondent to the CPS, a US resident</li>
<li><strong>How many observations</strong> 3,039,807 respondents</li>
<li><strong>How many variables</strong> 25 variables</li>
<li><strong>What variables describe whether someone voted and how old they are</strong> <code>voted</code>, and <code>age</code></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># HLO fips_codes</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(fips_codes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3256    5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(fips_codes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "state"       "state_code"  "state_name"  "county_code" "county"     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(fips_codes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 3,256
Columns: 5
$ state       &lt;chr&gt; "AL", "AL", "AL", "AL", "AL", "AL", "AL", "AL", "AL", "AL"…
$ state_code  &lt;chr&gt; "01", "01", "01", "01", "01", "01", "01", "01", "01", "01"…
$ state_name  &lt;chr&gt; "Alabama", "Alabama", "Alabama", "Alabama", "Alabama", "Al…
$ county_code &lt;chr&gt; "001", "003", "005", "007", "009", "011", "013", "015", "0…
$ county      &lt;chr&gt; "Autauga County", "Baldwin County", "Barbour County", "Bib…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># HLO policy_data</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># HLO cps</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="merge-policy_data-into-cps-data" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Merge <code>policy_data</code> into <code>cps</code> data</h1>
<p>To replicate the paper’s main results we need to merge the data on election laws in the <code>policy_data</code> dataframe into the data on voting in the <code>cps</code> data frame.</p>
<p>To merge <code>policy_data</code> into <code>cps</code>, we first need to merge the <code>st</code> column (State postal abbreviations of) from <code>fips_codes</code> into <code>cps</code> by the common <code>statefip</code> variable that is common to both <code>cps</code> and <code>state_fip</code></p>
<p>Then we can merge <code>policy_data</code> into <code>cps</code> by the common variables <code>st</code> and <code>year</code> to match the policies in a given state and year to observations in <code>cps</code> from that state in that year.</p>
<p>To avoid complications that from running merge code multiple times, we will save the output of each merge into temporary dataframes (e.g.&nbsp;<code>tmp1</code>), and then we’re confident we have done this correctly, will save the final merged data back into <code>cps</code>.</p>
<p>Following Grumbach and Hill, we’ll also filter out any observations before 1978 and all observations from DC and North Dakota (why?).</p>
<p>Please uncomment and run the following code</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # Merge state abbreviations (st) into CPS using statefip</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># tmp1 &lt;- cps %&gt;% dplyr::left_join(fips_codes %&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                       select(st, statefip),</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                       by = "statefip",</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                     multiple = "first"</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                     )</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># # tmp1 is cps with the added column "st"</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># dim(tmp1)</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># names(tmp1)[26]</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co"># dim(cps)</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co"># # Merge policy data into tmp1 using common variables `st` and `year`</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co"># tmp2 &lt;- tmp1 %&gt;% dplyr:: left_join(</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   policy_data,</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   by = c("st", "year")</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co"># # Check merges</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co"># dim(tmp2)</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="co"># dim(tmp1)</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="co"># # New variables in tmp2 not in tmp1</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co"># names(tmp2)[!names(tmp2) %in% names(tmp1)]</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="co"># # Filter out DC, ND, and observations before 1978</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="co"># tmp2 %&gt;%</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(!st %in% c("DC","ND"))%&gt;%</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(year&gt;=1978) -&gt; tmp3</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="co"># # Replace cps with merged data</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="co"># cps &lt;- tmp3</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="co"># # Tidy up: remove temporary data frames</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a><span class="co"># rm(list=c("tmp1","tmp2","tmp3"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="examine-and-recode-the-data" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Examine and recode the data</h1>
<p>The <strong>primary outcome</strong> of interest for this paper, is whether someone said they <code>voted</code> in a given year.</p>
<p>The <strong>treatment</strong> is the effect of living in state with <strong>same day registration</strong> which is captured by the <code>sdr</code> variable.</p>
<p>The <strong>key predictor</strong> will be indicators of a respondent’s <strong>age_cohort</strong> which we <strong>need to create</strong> from the <code>age</code> variable.</p>
<p>Next lab we will also look at models that the control for the following covariates:</p>
<ul>
<li><code>education</code> recoded from the original <code>educ</code> variable in the <code>cps</code> collapsing</li>
<li><code>race_f</code> a factor variable recoded from the original <code>race</code> variable in the <code>cps</code>
<ul>
<li>Indicators for respondents who identify as only one race (ie <code>is_white</code>)<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></li>
</ul></li>
<li><code>income</code> recoded from the original <code>faminc</code> variable in the <code>cps</code></li>
<li><code>is_female</code> recoded from the original <code>sex</code> variable in the <code>cps</code></li>
</ul>
<blockquote class="blockquote">
<p>Below we will recode the data for analysis. I will recode the covariates and the key predictors. Then <strong>you will write code to look at and recode the outcome.</strong></p>
</blockquote>
<section id="recode-covariates" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="recode-covariates"><span class="header-section-number">6.1</span> Recode covariates</h2>
<p>The CPS are messy data. Please run the code below to recode the covariates in the spirit of (i.e.&nbsp;with minor changes) what Grumbach and Hill did. <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The file <code>cps_00021.cbk.txt</code> contains the <strong>codebook</strong> for the data, telling us what numeric values of each variable correspond to substantively. So if you’re wondering <strong>how I know</strong> what should be recoded to what specific values, it comes from reading the codebook, looking at Grumbach and Hill’s code, looking at the raw variable with a table, and the using <code>case_when()</code> to judiciously code the data. You’ll get practice doing this in your final projects, but I don’t want to spend too much time on this this lab, which is why you’re only recoding the outcome <code>voted</code></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # Recode covariates</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># cps %&gt;% </span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Useful for plotting figure 2</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     SDR = ifelse(sdr == 1, "SDR", "non-SDR"),</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     education = case_when(</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co">#       educ == 1 ~ NA, #Blank</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co">#       educ &lt; 40 ~ 1, # No high school</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co">#       educ &gt;= 40 &amp; educ &lt; 73 ~ 2, # Some high school</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co">#       educ == 73 ~ 3, # High school degree</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co">#       educ &gt;= 80 &amp; educ &lt;= 110 ~ 4, # Some college</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co">#       educ &gt;= 111 &amp; educ &lt;123 ~ 5, # BA degree (And weirdly people who completed 5, 5+ and 6+ years of college)</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co">#       educ &gt;= 123 &amp; educ &lt;=125 ~ 6, # BA degree (And weirdly people who completed 5, 5+ and 6+ years of college)</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co">#       educ == 999 ~ NA # Missing/unknown</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co">#     ),</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="co">#     race_f = case_when(</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co">#       race == 999 ~ NA,</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co">#       T ~ factor(race)</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="co">#     ),</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co">#     is_white = case_when(</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="co">#       race == 100 ~ 1,</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="co">#       race == 999 ~ NA,</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="co">#       T ~ 0</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="co">#     ),</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="co">#     is_black = case_when(</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="co">#       race == 200 ~ 1,</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="co">#       race == 999 ~ NA,</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="co">#       T ~ 0</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a><span class="co">#     ),</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a><span class="co">#     is_aapi = case_when(</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a><span class="co">#       race == 650 ~ 1,</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a><span class="co">#       race == 651 ~ 1,</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a><span class="co">#       race == 652 ~ 1,</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a><span class="co">#       race == 999 ~ NA,</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a><span class="co">#       T ~ 0</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a><span class="co">#     ),</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a><span class="co">#     is_other = case_when(</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a><span class="co">#       is_white == 1 ~ 0,</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a><span class="co">#       is_black == 1 ~ 0,</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a><span class="co">#       is_aapi ==  1 ~ 0,</span></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a><span class="co">#       race == 999 ~ NA,</span></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a><span class="co">#       T ~ 1</span></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a><span class="co">#     ),</span></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a><span class="co">#     income = case_when(</span></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a><span class="co">#       faminc &gt; 843 ~ NA, # Remove Missing/Refused</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a><span class="co">#       T ~ as.numeric(factor(faminc))</span></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a><span class="co">#     ),</span></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a><span class="co">#     is_female = case_when(</span></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a><span class="co">#       sex == 2 ~ 1,</span></span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a><span class="co">#       sex == 1 ~ 0,</span></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a><span class="co">#       T ~ NA # recode Not in Universe as NA</span></span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a><span class="co">#     </span></span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) -&gt; cps</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="create-age_group-and-age_group_xx_xx-indicators" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="create-age_group-and-age_group_xx_xx-indicators"><span class="header-section-number">6.2</span> Create <code>age_group</code> and age_group_XX_XX indicators</h2>
<p>Next we’ll create an <code>age_group</code> variable and binary indicators for each age cohort of the form <code>age_group_XX_XX</code>.</p>
<p>Please uncomment and run the code below</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # Create age variables</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># cps %&gt;% </span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     age_group = case_when(</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">#       age &gt; 18 &amp; age &lt;= 24 ~ "18-24",</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">#       age &gt; 24 &amp; age &lt;= 34  ~ "25-34",</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co">#       age &gt; 34 &amp; age &lt;= 44  ~ "35-44",</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co">#       age &gt; 44 &amp; age &lt;= 54  ~ "45-54",</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co">#       age &gt; 54 &amp; age &lt;= 64  ~ "55-64",</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co">#       age &gt; 64 ~ "65+",</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co">#       T ~ NA</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     ),</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co">#     age_group_18_24 = ifelse(age_group == "18-24", 1, 0),</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co">#     age_group_25_34 = ifelse(age_group == "25-34", 1, 0),</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="co">#     age_group_35_44 = ifelse(age_group == "35-24", 1, 0),</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="co">#     age_group_45_54 = ifelse(age_group == "45-24", 1, 0),</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="co">#     age_group_55_64 = ifelse(age_group == "55-24", 1, 0),</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="co">#     age_group_65plus = ifelse(age_group == "65+", 1, 0)</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) -&gt; cps</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="check-age-recodes" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="check-age-recodes"><span class="header-section-number">6.3</span> Check age recodes</h2>
<p>It’s good practice when recoding, to check the output. Please use the <code>table()</code> to create a <strong>cross-tab</strong> of <code>age_group</code> and <code>age_group_18_24</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|label: checkage</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare age_group to age_group_18_24 using table()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Explain in words how the variable <code>age_group_18_24</code> relates to the variable <code>age_group</code></strong></p>
</section>
<section id="recode-the-outcome" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="recode-the-outcome"><span class="header-section-number">6.4</span> Recode the outcome</h2>
<p>Now it’s your turn. Please do the following:</p>
<ul>
<li><strong>Look</strong> at the variable <code>voted</code> using the <code>table()</code> function
<ul>
<li><code>1</code> corresponds to <strong>Did not vote</strong></li>
<li>`2 corresponds to <strong>Voted</strong></li>
<li><code>96</code>,<code>97</code>,<code>98</code> to people who didn’t provide and answer, or didn’t remember</li>
<li><code>99</code> corresponds to people <a href="https://cps.ipums.org/cps-action/faq" target="_blank">who shouldn’t be in the sample (“Not in universe”)</a></li>
</ul></li>
<li>Create a new variable called <code>dv_voted</code> using <code>case_when()</code> inside of <code>mutate()</code> that is:
<ul>
<li>1 when <code>voted == 2</code></li>
<li>0 when <code>voted == 1</code>,</li>
<li>0 when <code>voted &gt; 2 &amp; voted &lt;99</code></li>
<li><code>NA</code> when <code>voted == 99</code></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at distribution of voted using table()</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create variable dv_voted using mutate(), case_when(), and voted variable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="save-the-recoded-data" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="save-the-recoded-data"><span class="header-section-number">6.5</span> Save the recoded data</h2>
<p>Finally, let’s save our recoded data to file called <code>cps_clean.rda</code> that we can use for next week’s lab</p>
<p>Uncomment and run the following:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save(cps, file = "cps_clean.rda")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="recreate-figure-1" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Recreate Figure 1</h1>
<p>Phew, all that work, just to get set up to work. Now we can <strong>have some fun.</strong></p>
<p>Let’s recreate a version of Figure 1 using the policy data from the <code>policy_data</code> data frame.</p>
<section id="write-down-aesthetic-mappings-from-the-figure" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="write-down-aesthetic-mappings-from-the-figure"><span class="header-section-number">7.1</span> Write down aesthetic mappings from the figure:</h2>
<p>Before we create this figure, think about the information conveyed by the figure’s aesthetics (the x axis, the y axis, the color of the squares), and the corresponding columns from <code>policy_data</code> that contain this information.</p>
<ul>
<li>x-axis:</li>
<li>y-axis:</li>
<li>col:</li>
</ul>
</section>
<section id="create-a-variable-called-sdr" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="create-a-variable-called-sdr"><span class="header-section-number">7.2</span> Create a variable called <code>SDR</code></h2>
<p>It will be helpful to have a variable called <code>SDR</code> in <code>policy_data</code> that takes the value of “SDR” when <code>sdr == 1</code> and “non-SDR” when <code>sdr == 0</code></p>
<p>Please use <code>case_when()</code> or <code>ifelse()</code> to create <code>SDR</code> in <code>policy_data</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a variable called SDR in policy_data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="recreate-figure-1-1" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="recreate-figure-1-1"><span class="header-section-number">7.3</span> Recreate Figure 1</h2>
<p>Recall, we need three things to make a figure:</p>
<ul>
<li>data</li>
<li>aesthetics</li>
<li>geometries</li>
</ul>
<p>Using data from <code>policy_data</code> starting in 1978 (hint add a <code>filter()</code>) and the aesthetic mappings identified above use <code>ggplot()</code> with the <code>geom_point()</code> geometry to make a version of Figure 1 from paper.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recreate Figure 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="interpret-figure-1." class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="interpret-figure-1."><span class="header-section-number">7.4</span> Interpret Figure 1.</h2>
<p>Please answer the following questions:</p>
<ul>
<li><p><strong>How many states had Same Day Registration at some point in time?</strong> XX states</p></li>
<li><p><strong>How many states had Same Day Registration in 2018?</strong> XX states had SDR in 2018</p></li>
<li><p><strong>Did any states get rid of Same Day Registration? When did they get rid of this policy?</strong></p></li>
<li><p><strong>What’s up with North Dakota?</strong></p></li>
</ul>
<p>Use this code chunk to write any code that might help you answer these questions</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Write code to help you answer the questions above (if needed)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="recreate-figure-2" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Recreate Figure 2</h1>
<p>Figure 2 shows the proportion of people voting by age group in states that did and did not have Same Day Registration.</p>
<p>If we take the average of a binary indicator like <code>dv_voted</code>, we get a proportion, which corresponds to what Grumbach and Hill call the <code>Pr(Voted)</code></p>
<section id="calculate-the-proption-voting-by-age-group-and-sdr" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="calculate-the-proption-voting-by-age-group-and-sdr"><span class="header-section-number">8.1</span> Calculate the proption voting by age group and SDR</h2>
<p>With the <code>cps</code> data, use <code>group_by()</code> and summarize to calculate the proportion of people voting by age group in states that did and did not have same day registration in the code chunk below.</p>
<p>Save the results to a new object called <code>fig2_df</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Calculate the proportion of voting by age group and SDR</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="recreate-figure-2-1" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="recreate-figure-2-1"><span class="header-section-number">8.2</span> Recreate Figure 2</h2>
<p>Using <code>fig2_df</code> recreate a Figure 2 from the paper:</p>
<ul>
<li>filter out values of <code>age_group</code> that are <code>NA</code></li>
<li>set the appropriate aesthetic mappings in <code>ggplot()</code></li>
<li>use <code>geom_bar(stat = "identity", position = "dodge")</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Recreate Figure 2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="interpret-figure-2" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="interpret-figure-2"><span class="header-section-number">8.3</span> Interpret Figure 2</h2>
<p><strong>What does Figure 2 tell us?</strong> Figure 2 provides …</p>
</section>
</section>
<section id="take-the-class-survey" class="level1 unnumbered">
<h1 class="unnumbered">Take the Class Survey</h1>
<p>Please take a few moments to complete the <a href="https://brown.co1.qualtrics.com/jfe/form/SV_dgxOHQDv0xG1HzU" target="_blank">class survey</a> for this week.){target=“_blank”} for this week. This one’s a banger.</p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>The CPS coding on this is not great and there’s no measure of ethnicity in these data. Forgive the crude indicators, but their necessary to recreate some of Grumbach and Hill’s analysis next week. <a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Note the way the recoding is described in the appendix to the paper is not how it is actually implemented in the replication code in <code>rock_the_reg_replication_code.R</code>. For example, the appendix describes income as ranging from 1 (Under $10k) to 16 ($500k and above), when their code, implemented above produces 32 unique values, in part because the way the CPS asked and coded the income question changed overtime. We’re going to roll with it for now…<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>